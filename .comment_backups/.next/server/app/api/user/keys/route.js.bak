"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/user/keys/route";
exports.ids = ["app/api/user/keys/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node-forge":
/*!*****************************!*\
  !*** external "node-forge" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("node-forge");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fuser%2Fkeys%2Froute&page=%2Fapi%2Fuser%2Fkeys%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fuser%2Fkeys%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fuser%2Fkeys%2Froute&page=%2Fapi%2Fuser%2Fkeys%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fuser%2Fkeys%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Coolyeah_semester5_Keamanan_Informasi_Tugas3_app_api_user_keys_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/user/keys/route.ts */ \"(rsc)/./app/api/user/keys/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/user/keys/route\",\n        pathname: \"/api/user/keys\",\n        filename: \"route\",\n        bundlePath: \"app/api/user/keys/route\"\n    },\n    resolvedPagePath: \"D:\\\\Coolyeah\\\\semester5\\\\Keamanan Informasi\\\\Tugas3\\\\app\\\\api\\\\user\\\\keys\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Coolyeah_semester5_Keamanan_Informasi_Tugas3_app_api_user_keys_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/user/keys/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ1c2VyJTJGa2V5cyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGdXNlciUyRmtleXMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ1c2VyJTJGa2V5cyUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ29vbHllYWglNUNzZW1lc3RlcjUlNUNLZWFtYW5hbiUyMEluZm9ybWFzaSU1Q1R1Z2FzMyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q0Nvb2x5ZWFoJTVDc2VtZXN0ZXI1JTVDS2VhbWFuYW4lMjBJbmZvcm1hc2klNUNUdWdhczMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ21DO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vPzdlN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ29vbHllYWhcXFxcc2VtZXN0ZXI1XFxcXEtlYW1hbmFuIEluZm9ybWFzaVxcXFxUdWdhczNcXFxcYXBwXFxcXGFwaVxcXFx1c2VyXFxcXGtleXNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3VzZXIva2V5cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3VzZXIva2V5c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdXNlci9rZXlzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRDpcXFxcQ29vbHllYWhcXFxcc2VtZXN0ZXI1XFxcXEtlYW1hbmFuIEluZm9ybWFzaVxcXFxUdWdhczNcXFxcYXBwXFxcXGFwaVxcXFx1c2VyXFxcXGtleXNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3VzZXIva2V5cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fuser%2Fkeys%2Froute&page=%2Fapi%2Fuser%2Fkeys%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fuser%2Fkeys%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/user/keys/route.ts":
/*!************************************!*\
  !*** ./app/api/user/keys/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/crypto */ \"(rsc)/./lib/crypto.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\n\n\n\n\nconst generateKeysSchema = zod__WEBPACK_IMPORTED_MODULE_4__.object({\n    password: zod__WEBPACK_IMPORTED_MODULE_4__.string().min(8)\n});\nasync function POST(request) {\n    try {\n        // Get user from token\n        const tokenPayload = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getUserFromRequest)(request);\n        if (!tokenPayload) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const validation = generateKeysSchema.safeParse(body);\n        if (!validation.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid input\",\n                details: validation.error.errors\n            }, {\n                status: 400\n            });\n        }\n        const { password } = validation.data;\n        // Get user details\n        const user = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.userDb.findById(tokenPayload.userId);\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Generate key pair and certificate\n        const keyPair = await (0,_lib_crypto__WEBPACK_IMPORTED_MODULE_3__.generateKeyPairAndCertificate)({\n            commonName: user.name,\n            organizationName: user.organizationName,\n            email: user.email\n        });\n        // Encrypt private key\n        const privateKeyEncrypted = (0,_lib_crypto__WEBPACK_IMPORTED_MODULE_3__.encryptPrivateKey)(keyPair.privateKey, password);\n        // Save to database\n        await _lib_db__WEBPACK_IMPORTED_MODULE_2__.userKeysDb.create({\n            userId: user.id,\n            publicKey: keyPair.publicKey,\n            privateKeyEncrypted,\n            certificate: keyPair.certificate\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Keys generated successfully\",\n            publicKey: keyPair.publicKey,\n            certificate: keyPair.certificate\n        });\n    } catch (error) {\n        console.error(\"Generate keys error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate keys: \" + error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(request) {\n    try {\n        // Get user from token\n        const tokenPayload = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getUserFromRequest)(request);\n        if (!tokenPayload) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Get user keys\n        const keys = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.userKeysDb.findByUserId(tokenPayload.userId);\n        if (!keys) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Keys not found. Please generate keys first.\"\n            }, {\n                status: 404\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            publicKey: keys.publicKey,\n            certificate: keys.certificate,\n            createdAt: keys.createdAt\n        });\n    } catch (error) {\n        console.error(\"Get keys error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3VzZXIva2V5cy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXdEO0FBQ1I7QUFDRjtBQUNrQztBQUN4RDtBQUV4QixNQUFNTyxxQkFBcUJELHVDQUFRLENBQUM7SUFDbENHLFVBQVVILHVDQUFRLEdBQUdLLEdBQUcsQ0FBQztBQUMzQjtBQUVPLGVBQWVDLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRixzQkFBc0I7UUFDdEIsTUFBTUMsZUFBZSxNQUFNYiw2REFBa0JBLENBQUNZO1FBQzlDLElBQUksQ0FBQ0MsY0FBYztZQUNqQixPQUFPZCxxREFBWUEsQ0FBQ2UsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWUsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3BFO1FBRUEsTUFBTUMsT0FBTyxNQUFNTCxRQUFRRSxJQUFJO1FBQy9CLE1BQU1JLGFBQWFaLG1CQUFtQmEsU0FBUyxDQUFDRjtRQUNoRCxJQUFJLENBQUNDLFdBQVdFLE9BQU8sRUFBRTtZQUN2QixPQUFPckIscURBQVlBLENBQUNlLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87Z0JBQWlCTSxTQUFTSCxXQUFXSCxLQUFLLENBQUNPLE1BQU07WUFBQyxHQUMzRDtnQkFBRU4sUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTSxFQUFFUixRQUFRLEVBQUUsR0FBR1UsV0FBV0ssSUFBSTtRQUVwQyxtQkFBbUI7UUFDbkIsTUFBTUMsT0FBTyxNQUFNdkIsMkNBQU1BLENBQUN3QixRQUFRLENBQUNaLGFBQWFhLE1BQU07UUFDdEQsSUFBSSxDQUFDRixNQUFNO1lBQ1QsT0FBT3pCLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBaUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3RFO1FBRUEsb0NBQW9DO1FBQ3BDLE1BQU1XLFVBQVUsTUFBTXhCLDBFQUE2QkEsQ0FBQztZQUNsRHlCLFlBQVlKLEtBQUtLLElBQUk7WUFDckJDLGtCQUFrQk4sS0FBS00sZ0JBQWdCO1lBQ3ZDQyxPQUFPUCxLQUFLTyxLQUFLO1FBQ25CO1FBRUEsc0JBQXNCO1FBQ3RCLE1BQU1DLHNCQUFzQjVCLDhEQUFpQkEsQ0FBQ3VCLFFBQVFNLFVBQVUsRUFBRXpCO1FBRWxFLG1CQUFtQjtRQUNuQixNQUFNTiwrQ0FBVUEsQ0FBQ2dDLE1BQU0sQ0FBQztZQUN0QlIsUUFBUUYsS0FBS1csRUFBRTtZQUNmQyxXQUFXVCxRQUFRUyxTQUFTO1lBQzVCSjtZQUNBSyxhQUFhVixRQUFRVSxXQUFXO1FBQ2xDO1FBRUEsT0FBT3RDLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7WUFDdkJ3QixTQUFTO1lBQ1RGLFdBQVdULFFBQVFTLFNBQVM7WUFDNUJDLGFBQWFWLFFBQVFVLFdBQVc7UUFDbEM7SUFDRixFQUFFLE9BQU90QixPQUFPO1FBQ2R3QixRQUFReEIsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsT0FBT2hCLHFEQUFZQSxDQUFDZSxJQUFJLENBQ3RCO1lBQUVDLE9BQU8sOEJBQThCLE1BQWlCdUIsT0FBTztRQUFDLEdBQ2hFO1lBQUV0QixRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVPLGVBQWV3QixJQUFJNUIsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLHNCQUFzQjtRQUN0QixNQUFNQyxlQUFlLE1BQU1iLDZEQUFrQkEsQ0FBQ1k7UUFDOUMsSUFBSSxDQUFDQyxjQUFjO1lBQ2pCLE9BQU9kLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZSxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxnQkFBZ0I7UUFDaEIsTUFBTXlCLE9BQU8sTUFBTXZDLCtDQUFVQSxDQUFDd0MsWUFBWSxDQUFDN0IsYUFBYWEsTUFBTTtRQUM5RCxJQUFJLENBQUNlLE1BQU07WUFDVCxPQUFPMUMscURBQVlBLENBQUNlLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBOEMsR0FDdkQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE9BQU9qQixxREFBWUEsQ0FBQ2UsSUFBSSxDQUFDO1lBQ3ZCc0IsV0FBV0ssS0FBS0wsU0FBUztZQUN6QkMsYUFBYUksS0FBS0osV0FBVztZQUM3Qk0sV0FBV0YsS0FBS0UsU0FBUztRQUMzQjtJQUNGLEVBQUUsT0FBTzVCLE9BQU87UUFDZHdCLFFBQVF4QixLQUFLLENBQUMsbUJBQW1CQTtRQUNqQyxPQUFPaEIscURBQVlBLENBQUNlLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUF3QixHQUNqQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vYXBwL2FwaS91c2VyL2tleXMvcm91dGUudHM/YTcyZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IGdldFVzZXJGcm9tUmVxdWVzdCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XHJcbmltcG9ydCB7IHVzZXJEYiwgdXNlcktleXNEYiB9IGZyb20gXCJAL2xpYi9kYlwiO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZUtleVBhaXJBbmRDZXJ0aWZpY2F0ZSwgZW5jcnlwdFByaXZhdGVLZXkgfSBmcm9tIFwiQC9saWIvY3J5cHRvXCI7XHJcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XHJcblxyXG5jb25zdCBnZW5lcmF0ZUtleXNTY2hlbWEgPSB6Lm9iamVjdCh7XHJcbiAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubWluKDgpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCB1c2VyIGZyb20gdG9rZW5cclxuICAgIGNvbnN0IHRva2VuUGF5bG9hZCA9IGF3YWl0IGdldFVzZXJGcm9tUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIGlmICghdG9rZW5QYXlsb2FkKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGdlbmVyYXRlS2V5c1NjaGVtYS5zYWZlUGFyc2UoYm9keSk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogXCJJbnZhbGlkIGlucHV0XCIsIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuZXJyb3JzIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBwYXNzd29yZCB9ID0gdmFsaWRhdGlvbi5kYXRhO1xyXG5cclxuICAgIC8vIEdldCB1c2VyIGRldGFpbHNcclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2VyRGIuZmluZEJ5SWQodG9rZW5QYXlsb2FkLnVzZXJJZCk7XHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVXNlciBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGtleSBwYWlyIGFuZCBjZXJ0aWZpY2F0ZVxyXG4gICAgY29uc3Qga2V5UGFpciA9IGF3YWl0IGdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlKHtcclxuICAgICAgY29tbW9uTmFtZTogdXNlci5uYW1lLFxyXG4gICAgICBvcmdhbml6YXRpb25OYW1lOiB1c2VyLm9yZ2FuaXphdGlvbk5hbWUsXHJcbiAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRW5jcnlwdCBwcml2YXRlIGtleVxyXG4gICAgY29uc3QgcHJpdmF0ZUtleUVuY3J5cHRlZCA9IGVuY3J5cHRQcml2YXRlS2V5KGtleVBhaXIucHJpdmF0ZUtleSwgcGFzc3dvcmQpO1xyXG5cclxuICAgIC8vIFNhdmUgdG8gZGF0YWJhc2VcclxuICAgIGF3YWl0IHVzZXJLZXlzRGIuY3JlYXRlKHtcclxuICAgICAgdXNlcklkOiB1c2VyLmlkLFxyXG4gICAgICBwdWJsaWNLZXk6IGtleVBhaXIucHVibGljS2V5LFxyXG4gICAgICBwcml2YXRlS2V5RW5jcnlwdGVkLFxyXG4gICAgICBjZXJ0aWZpY2F0ZToga2V5UGFpci5jZXJ0aWZpY2F0ZSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIG1lc3NhZ2U6IFwiS2V5cyBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5XCIsXHJcbiAgICAgIHB1YmxpY0tleToga2V5UGFpci5wdWJsaWNLZXksXHJcbiAgICAgIGNlcnRpZmljYXRlOiBrZXlQYWlyLmNlcnRpZmljYXRlLFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJHZW5lcmF0ZSBrZXlzIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6IFwiRmFpbGVkIHRvIGdlbmVyYXRlIGtleXM6IFwiICsgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IHVzZXIgZnJvbSB0b2tlblxyXG4gICAgY29uc3QgdG9rZW5QYXlsb2FkID0gYXdhaXQgZ2V0VXNlckZyb21SZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgaWYgKCF0b2tlblBheWxvYWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSwgeyBzdGF0dXM6IDQwMSB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdXNlciBrZXlzXHJcbiAgICBjb25zdCBrZXlzID0gYXdhaXQgdXNlcktleXNEYi5maW5kQnlVc2VySWQodG9rZW5QYXlsb2FkLnVzZXJJZCk7XHJcbiAgICBpZiAoIWtleXMpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwiS2V5cyBub3QgZm91bmQuIFBsZWFzZSBnZW5lcmF0ZSBrZXlzIGZpcnN0LlwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgcHVibGljS2V5OiBrZXlzLnB1YmxpY0tleSxcclxuICAgICAgY2VydGlmaWNhdGU6IGtleXMuY2VydGlmaWNhdGUsXHJcbiAgICAgIGNyZWF0ZWRBdDoga2V5cy5jcmVhdGVkQXQsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkdldCBrZXlzIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0VXNlckZyb21SZXF1ZXN0IiwidXNlckRiIiwidXNlcktleXNEYiIsImdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlIiwiZW5jcnlwdFByaXZhdGVLZXkiLCJ6IiwiZ2VuZXJhdGVLZXlzU2NoZW1hIiwib2JqZWN0IiwicGFzc3dvcmQiLCJzdHJpbmciLCJtaW4iLCJQT1NUIiwicmVxdWVzdCIsInRva2VuUGF5bG9hZCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImJvZHkiLCJ2YWxpZGF0aW9uIiwic2FmZVBhcnNlIiwic3VjY2VzcyIsImRldGFpbHMiLCJlcnJvcnMiLCJkYXRhIiwidXNlciIsImZpbmRCeUlkIiwidXNlcklkIiwia2V5UGFpciIsImNvbW1vbk5hbWUiLCJuYW1lIiwib3JnYW5pemF0aW9uTmFtZSIsImVtYWlsIiwicHJpdmF0ZUtleUVuY3J5cHRlZCIsInByaXZhdGVLZXkiLCJjcmVhdGUiLCJpZCIsInB1YmxpY0tleSIsImNlcnRpZmljYXRlIiwibWVzc2FnZSIsImNvbnNvbGUiLCJHRVQiLCJrZXlzIiwiZmluZEJ5VXNlcklkIiwiY3JlYXRlZEF0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/user/keys/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractTokenFromHeader: () => (/* binding */ extractTokenFromHeader),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getUserFromRequest: () => (/* binding */ getUserFromRequest),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\";\nconst JWT_EXPIRES_IN = \"7d\";\n/**\r\n * Generate JWT token for user\r\n */ function generateToken(user) {\n    const payload = {\n        userId: user.id,\n        email: user.email,\n        role: user.role\n    };\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign(payload, JWT_SECRET, {\n        expiresIn: JWT_EXPIRES_IN\n    });\n}\n/**\r\n * Verify and decode JWT token\r\n */ function verifyToken(token) {\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n        return decoded;\n    } catch (error) {\n        return null;\n    }\n}\n/**\r\n * Extract token from Authorization header\r\n */ function extractTokenFromHeader(authHeader) {\n    if (!authHeader) return null;\n    const parts = authHeader.split(\" \");\n    if (parts.length !== 2 || parts[0] !== \"Bearer\") {\n        return null;\n    }\n    return parts[1];\n}\n/**\r\n * Get user from request (Next.js API route)\r\n */ async function getUserFromRequest(request) {\n    const authHeader = request.headers.get(\"Authorization\");\n    const token = extractTokenFromHeader(authHeader);\n    if (!token) return null;\n    return verifyToken(token);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBK0I7QUFHL0IsTUFBTUMsYUFDSkMsUUFBUUMsR0FBRyxDQUFDRixVQUFVLElBQUk7QUFDNUIsTUFBTUcsaUJBQWlCO0FBUXZCOztDQUVDLEdBQ00sU0FBU0MsY0FBY0MsSUFBVTtJQUN0QyxNQUFNQyxVQUFzQjtRQUMxQkMsUUFBUUYsS0FBS0csRUFBRTtRQUNmQyxPQUFPSixLQUFLSSxLQUFLO1FBQ2pCQyxNQUFNTCxLQUFLSyxJQUFJO0lBQ2pCO0lBRUEsT0FBT1gsd0RBQVEsQ0FBQ08sU0FBU04sWUFBWTtRQUNuQ1ksV0FBV1Q7SUFDYjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTVSxZQUFZQyxLQUFhO0lBQ3ZDLElBQUk7UUFDRixNQUFNQyxVQUFVaEIsMERBQVUsQ0FBQ2UsT0FBT2Q7UUFDbEMsT0FBT2U7SUFDVCxFQUFFLE9BQU9FLE9BQU87UUFDZCxPQUFPO0lBQ1Q7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0MsdUJBQ2RDLFVBQXlCO0lBRXpCLElBQUksQ0FBQ0EsWUFBWSxPQUFPO0lBRXhCLE1BQU1DLFFBQVFELFdBQVdFLEtBQUssQ0FBQztJQUMvQixJQUFJRCxNQUFNRSxNQUFNLEtBQUssS0FBS0YsS0FBSyxDQUFDLEVBQUUsS0FBSyxVQUFVO1FBQy9DLE9BQU87SUFDVDtJQUVBLE9BQU9BLEtBQUssQ0FBQyxFQUFFO0FBQ2pCO0FBRUE7O0NBRUMsR0FDTSxlQUFlRyxtQkFDcEJDLE9BQWdCO0lBRWhCLE1BQU1MLGFBQWFLLFFBQVFDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBQ3ZDLE1BQU1aLFFBQVFJLHVCQUF1QkM7SUFFckMsSUFBSSxDQUFDTCxPQUFPLE9BQU87SUFFbkIsT0FBT0QsWUFBWUM7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGYtc2lnbmF0dXJlLXN5c3RlbS8uL2xpYi9hdXRoLnRzP2JmN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiQC90eXBlc1wiO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9XHJcbiAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCBcInlvdXItc2VjcmV0LWtleS1jaGFuZ2UtaW4tcHJvZHVjdGlvblwiO1xyXG5jb25zdCBKV1RfRVhQSVJFU19JTiA9IFwiN2RcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSldUUGF5bG9hZCB7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICByb2xlOiBcIm9yZ2FuaXphdGlvblwiIHwgXCJjb25zdWx0YW50XCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBKV1QgdG9rZW4gZm9yIHVzZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKHVzZXI6IFVzZXIpOiBzdHJpbmcge1xyXG4gIGNvbnN0IHBheWxvYWQ6IEpXVFBheWxvYWQgPSB7XHJcbiAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgIHJvbGU6IHVzZXIucm9sZSxcclxuICB9O1xyXG5cclxuICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgSldUX1NFQ1JFVCwge1xyXG4gICAgZXhwaXJlc0luOiBKV1RfRVhQSVJFU19JTixcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBhbmQgZGVjb2RlIEpXVCB0b2tlblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuOiBzdHJpbmcpOiBKV1RQYXlsb2FkIHwgbnVsbCB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKSBhcyBKV1RQYXlsb2FkO1xyXG4gICAgcmV0dXJuIGRlY29kZWQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgdG9rZW4gZnJvbSBBdXRob3JpemF0aW9uIGhlYWRlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUb2tlbkZyb21IZWFkZXIoXHJcbiAgYXV0aEhlYWRlcjogc3RyaW5nIHwgbnVsbFxyXG4pOiBzdHJpbmcgfCBudWxsIHtcclxuICBpZiAoIWF1dGhIZWFkZXIpIHJldHVybiBudWxsO1xyXG5cclxuICBjb25zdCBwYXJ0cyA9IGF1dGhIZWFkZXIuc3BsaXQoXCIgXCIpO1xyXG4gIGlmIChwYXJ0cy5sZW5ndGggIT09IDIgfHwgcGFydHNbMF0gIT09IFwiQmVhcmVyXCIpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHBhcnRzWzFdO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IHVzZXIgZnJvbSByZXF1ZXN0IChOZXh0LmpzIEFQSSByb3V0ZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyRnJvbVJlcXVlc3QoXHJcbiAgcmVxdWVzdDogUmVxdWVzdFxyXG4pOiBQcm9taXNlPEpXVFBheWxvYWQgfCBudWxsPiB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJBdXRob3JpemF0aW9uXCIpO1xyXG4gIGNvbnN0IHRva2VuID0gZXh0cmFjdFRva2VuRnJvbUhlYWRlcihhdXRoSGVhZGVyKTtcclxuXHJcbiAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XHJcblxyXG4gIHJldHVybiB2ZXJpZnlUb2tlbih0b2tlbik7XHJcbn1cclxuIl0sIm5hbWVzIjpbImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiSldUX0VYUElSRVNfSU4iLCJnZW5lcmF0ZVRva2VuIiwidXNlciIsInBheWxvYWQiLCJ1c2VySWQiLCJpZCIsImVtYWlsIiwicm9sZSIsInNpZ24iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsImVycm9yIiwiZXh0cmFjdFRva2VuRnJvbUhlYWRlciIsImF1dGhIZWFkZXIiLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwiZ2V0VXNlckZyb21SZXF1ZXN0IiwicmVxdWVzdCIsImhlYWRlcnMiLCJnZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/crypto.ts":
/*!***********************!*\
  !*** ./lib/crypto.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decryptPrivateKey: () => (/* binding */ decryptPrivateKey),\n/* harmony export */   encryptPrivateKey: () => (/* binding */ encryptPrivateKey),\n/* harmony export */   generateKeyPairAndCertificate: () => (/* binding */ generateKeyPairAndCertificate),\n/* harmony export */   isCertificateValid: () => (/* binding */ isCertificateValid),\n/* harmony export */   parseCertificate: () => (/* binding */ parseCertificate)\n/* harmony export */ });\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node-forge */ \"node-forge\");\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_forge__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\r\n * Generate RSA 2048-bit key pair and self-signed X.509 certificate\r\n */ async function generateKeyPairAndCertificate(userInfo) {\n    return new Promise((resolve, reject)=>{\n        try {\n            // Generate RSA key pair (2048 bits)\n            const keys = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.rsa.generateKeyPair(2048);\n            // Create certificate\n            const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.createCertificate();\n            cert.publicKey = keys.publicKey;\n            cert.serialNumber = \"01\" + Math.floor(Math.random() * 1000000).toString();\n            // Set validity period (1 year)\n            cert.validity.notBefore = new Date();\n            cert.validity.notAfter = new Date();\n            cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 1);\n            // Set certificate attributes\n            const attrs = [\n                {\n                    name: \"commonName\",\n                    value: userInfo.commonName\n                },\n                {\n                    name: \"countryName\",\n                    value: \"ID\"\n                },\n                {\n                    shortName: \"ST\",\n                    value: \"Indonesia\"\n                },\n                {\n                    name: \"localityName\",\n                    value: \"Jakarta\"\n                },\n                {\n                    name: \"organizationName\",\n                    value: userInfo.organizationName || \"Self-Signed\"\n                },\n                {\n                    shortName: \"OU\",\n                    value: \"Digital Signature\"\n                },\n                {\n                    name: \"emailAddress\",\n                    value: userInfo.email\n                }\n            ];\n            cert.setSubject(attrs);\n            cert.setIssuer(attrs); // Self-signed\n            // Add extensions\n            cert.setExtensions([\n                {\n                    name: \"basicConstraints\",\n                    cA: false\n                },\n                {\n                    name: \"keyUsage\",\n                    digitalSignature: true,\n                    nonRepudiation: true,\n                    keyEncipherment: true\n                },\n                {\n                    name: \"extKeyUsage\",\n                    serverAuth: false,\n                    clientAuth: false,\n                    codeSigning: false,\n                    emailProtection: true\n                }\n            ]);\n            // Self-sign certificate\n            cert.sign(keys.privateKey, node_forge__WEBPACK_IMPORTED_MODULE_0___default().md.sha256.create());\n            // Convert to PEM format\n            const publicKeyPem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.publicKeyToPem(keys.publicKey);\n            const privateKeyPem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.privateKeyToPem(keys.privateKey);\n            const certificatePem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateToPem(cert);\n            resolve({\n                publicKey: publicKeyPem,\n                privateKey: privateKeyPem,\n                certificate: certificatePem\n            });\n        } catch (error) {\n            reject(error);\n        }\n    });\n}\n/**\r\n * Encrypt private key using AES-256-GCM with password\r\n */ function encryptPrivateKey(privateKeyPem, password) {\n    try {\n        // Derive key from password using PBKDF2\n        const salt = node_forge__WEBPACK_IMPORTED_MODULE_0___default().random.getBytesSync(32);\n        const derivedKey = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pkcs5.pbkdf2(password, salt, 100000, 32);\n        // Generate IV for AES-GCM\n        const iv = node_forge__WEBPACK_IMPORTED_MODULE_0___default().random.getBytesSync(12);\n        // Encrypt using AES-256-GCM\n        const cipher = node_forge__WEBPACK_IMPORTED_MODULE_0___default().cipher.createCipher(\"AES-GCM\", derivedKey);\n        cipher.start({\n            iv: iv\n        });\n        cipher.update(node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(privateKeyPem, \"utf8\"));\n        cipher.finish();\n        const encrypted = cipher.output.bytes();\n        const tag = cipher.mode.tag.bytes();\n        // Combine salt + iv + tag + encrypted data\n        const combined = salt + iv + tag + encrypted;\n        // Return as base64\n        return node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.encode64(combined);\n    } catch (error) {\n        throw new Error(\"Failed to encrypt private key: \" + error.message);\n    }\n}\n/**\r\n * Decrypt private key using password\r\n */ function decryptPrivateKey(encryptedData, password) {\n    try {\n        // Decode from base64\n        const combined = node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.decode64(encryptedData);\n        // Extract components\n        const salt = combined.slice(0, 32);\n        const iv = combined.slice(32, 44);\n        const tag = combined.slice(44, 60);\n        const encrypted = combined.slice(60);\n        // Derive key from password\n        const derivedKey = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pkcs5.pbkdf2(password, salt, 100000, 32);\n        // Decrypt using AES-256-GCM\n        const decipher = node_forge__WEBPACK_IMPORTED_MODULE_0___default().cipher.createDecipher(\"AES-GCM\", derivedKey);\n        decipher.start({\n            iv: iv,\n            tag: node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(tag)\n        });\n        decipher.update(node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(encrypted));\n        const success = decipher.finish();\n        if (!success) {\n            throw new Error(\"Authentication failed - incorrect password or corrupted data\");\n        }\n        return decipher.output.toString();\n    } catch (error) {\n        throw new Error(\"Failed to decrypt private key: \" + error.message);\n    }\n}\n/**\r\n * Parse certificate and extract information\r\n */ function parseCertificate(certificatePem) {\n    try {\n        const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        const getAttributeValue = (attrs, name)=>{\n            const attr = attrs.find((a)=>a.name === name || a.shortName === name);\n            return attr ? attr.value : \"\";\n        };\n        return {\n            subject: cert.subject.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            issuer: cert.issuer.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            validFrom: cert.validity.notBefore,\n            validTo: cert.validity.notAfter,\n            serialNumber: cert.serialNumber,\n            algorithm: \"RSA with SHA-256\"\n        };\n    } catch (error) {\n        throw new Error(\"Failed to parse certificate: \" + error.message);\n    }\n}\n/**\r\n * Verify if certificate is still valid\r\n */ function isCertificateValid(certificatePem) {\n    try {\n        const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        const now = new Date();\n        return now >= cert.validity.notBefore && now <= cert.validity.notAfter;\n    } catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S1EsUUFBUSxDQUFDRyxRQUFRO1lBQy9CUixjQUFjSCxLQUFLRyxZQUFZO1lBQy9Cc0YsV0FBVztRQUNiO0lBQ0YsRUFBRSxPQUFPN0MsT0FBTztRQUNkLE1BQU0sSUFBSXVCLE1BQU0sa0NBQWtDLE1BQWlCQyxPQUFPO0lBQzVFO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNzQixtQkFBbUJqRCxjQUFzQjtJQUN2RCxJQUFJO1FBQ0YsTUFBTXpDLE9BQU9WLHFEQUFTLENBQUN1RixrQkFBa0IsQ0FBQ3BDO1FBQzFDLE1BQU1rRCxNQUFNLElBQUlqRjtRQUNoQixPQUFPaUYsT0FBTzNGLEtBQUtRLFFBQVEsQ0FBQ0MsU0FBUyxJQUFJa0YsT0FBTzNGLEtBQUtRLFFBQVEsQ0FBQ0csUUFBUTtJQUN4RSxFQUFFLE9BQU9pQyxPQUFPO1FBQ2QsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGYtc2lnbmF0dXJlLXN5c3RlbS8uL2xpYi9jcnlwdG8udHM/OTI1YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZm9yZ2UgZnJvbSBcIm5vZGUtZm9yZ2VcIjtcclxuaW1wb3J0IHsgS2V5UGFpckluZm8sIENlcnRpZmljYXRlSW5mbyB9IGZyb20gXCJAL3R5cGVzXCI7XHJcblxyXG4vKipcclxuICogR2VuZXJhdGUgUlNBIDIwNDgtYml0IGtleSBwYWlyIGFuZCBzZWxmLXNpZ25lZCBYLjUwOSBjZXJ0aWZpY2F0ZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlKHVzZXJJbmZvOiB7XHJcbiAgY29tbW9uTmFtZTogc3RyaW5nO1xyXG4gIG9yZ2FuaXphdGlvbk5hbWU/OiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxufSk6IFByb21pc2U8S2V5UGFpckluZm8+IHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gR2VuZXJhdGUgUlNBIGtleSBwYWlyICgyMDQ4IGJpdHMpXHJcbiAgICAgIGNvbnN0IGtleXMgPSBmb3JnZS5wa2kucnNhLmdlbmVyYXRlS2V5UGFpcigyMDQ4KTtcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBjZXJ0aWZpY2F0ZVxyXG4gICAgICBjb25zdCBjZXJ0ID0gZm9yZ2UucGtpLmNyZWF0ZUNlcnRpZmljYXRlKCk7XHJcbiAgICAgIGNlcnQucHVibGljS2V5ID0ga2V5cy5wdWJsaWNLZXk7XHJcbiAgICAgIGNlcnQuc2VyaWFsTnVtYmVyID0gXCIwMVwiICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMCkudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgIC8vIFNldCB2YWxpZGl0eSBwZXJpb2QgKDEgeWVhcilcclxuICAgICAgY2VydC52YWxpZGl0eS5ub3RCZWZvcmUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICBjZXJ0LnZhbGlkaXR5Lm5vdEFmdGVyID0gbmV3IERhdGUoKTtcclxuICAgICAgY2VydC52YWxpZGl0eS5ub3RBZnRlci5zZXRGdWxsWWVhcihcclxuICAgICAgICBjZXJ0LnZhbGlkaXR5Lm5vdEJlZm9yZS5nZXRGdWxsWWVhcigpICsgMVxyXG4gICAgICApO1xyXG5cclxuICAgICAgLy8gU2V0IGNlcnRpZmljYXRlIGF0dHJpYnV0ZXNcclxuICAgICAgY29uc3QgYXR0cnMgPSBbXHJcbiAgICAgICAgeyBuYW1lOiBcImNvbW1vbk5hbWVcIiwgdmFsdWU6IHVzZXJJbmZvLmNvbW1vbk5hbWUgfSxcclxuICAgICAgICB7IG5hbWU6IFwiY291bnRyeU5hbWVcIiwgdmFsdWU6IFwiSURcIiB9LFxyXG4gICAgICAgIHsgc2hvcnROYW1lOiBcIlNUXCIsIHZhbHVlOiBcIkluZG9uZXNpYVwiIH0sXHJcbiAgICAgICAgeyBuYW1lOiBcImxvY2FsaXR5TmFtZVwiLCB2YWx1ZTogXCJKYWthcnRhXCIgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBuYW1lOiBcIm9yZ2FuaXphdGlvbk5hbWVcIixcclxuICAgICAgICAgIHZhbHVlOiB1c2VySW5mby5vcmdhbml6YXRpb25OYW1lIHx8IFwiU2VsZi1TaWduZWRcIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgc2hvcnROYW1lOiBcIk9VXCIsIHZhbHVlOiBcIkRpZ2l0YWwgU2lnbmF0dXJlXCIgfSxcclxuICAgICAgICB7IG5hbWU6IFwiZW1haWxBZGRyZXNzXCIsIHZhbHVlOiB1c2VySW5mby5lbWFpbCB9LFxyXG4gICAgICBdO1xyXG5cclxuICAgICAgY2VydC5zZXRTdWJqZWN0KGF0dHJzKTtcclxuICAgICAgY2VydC5zZXRJc3N1ZXIoYXR0cnMpOyAvLyBTZWxmLXNpZ25lZFxyXG5cclxuICAgICAgLy8gQWRkIGV4dGVuc2lvbnNcclxuICAgICAgY2VydC5zZXRFeHRlbnNpb25zKFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBuYW1lOiBcImJhc2ljQ29uc3RyYWludHNcIixcclxuICAgICAgICAgIGNBOiBmYWxzZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IFwia2V5VXNhZ2VcIixcclxuICAgICAgICAgIGRpZ2l0YWxTaWduYXR1cmU6IHRydWUsXHJcbiAgICAgICAgICBub25SZXB1ZGlhdGlvbjogdHJ1ZSxcclxuICAgICAgICAgIGtleUVuY2lwaGVybWVudDogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IFwiZXh0S2V5VXNhZ2VcIixcclxuICAgICAgICAgIHNlcnZlckF1dGg6IGZhbHNlLFxyXG4gICAgICAgICAgY2xpZW50QXV0aDogZmFsc2UsXHJcbiAgICAgICAgICBjb2RlU2lnbmluZzogZmFsc2UsXHJcbiAgICAgICAgICBlbWFpbFByb3RlY3Rpb246IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSk7XHJcblxyXG4gICAgICAvLyBTZWxmLXNpZ24gY2VydGlmaWNhdGVcclxuICAgICAgY2VydC5zaWduKGtleXMucHJpdmF0ZUtleSwgZm9yZ2UubWQuc2hhMjU2LmNyZWF0ZSgpKTtcclxuXHJcbiAgICAgIC8vIENvbnZlcnQgdG8gUEVNIGZvcm1hdFxyXG4gICAgICBjb25zdCBwdWJsaWNLZXlQZW0gPSBmb3JnZS5wa2kucHVibGljS2V5VG9QZW0oa2V5cy5wdWJsaWNLZXkpO1xyXG4gICAgICBjb25zdCBwcml2YXRlS2V5UGVtID0gZm9yZ2UucGtpLnByaXZhdGVLZXlUb1BlbShrZXlzLnByaXZhdGVLZXkpO1xyXG4gICAgICBjb25zdCBjZXJ0aWZpY2F0ZVBlbSA9IGZvcmdlLnBraS5jZXJ0aWZpY2F0ZVRvUGVtKGNlcnQpO1xyXG5cclxuICAgICAgcmVzb2x2ZSh7XHJcbiAgICAgICAgcHVibGljS2V5OiBwdWJsaWNLZXlQZW0sXHJcbiAgICAgICAgcHJpdmF0ZUtleTogcHJpdmF0ZUtleVBlbSxcclxuICAgICAgICBjZXJ0aWZpY2F0ZTogY2VydGlmaWNhdGVQZW0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuY3J5cHQgcHJpdmF0ZSBrZXkgdXNpbmcgQUVTLTI1Ni1HQ00gd2l0aCBwYXNzd29yZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGVuY3J5cHRQcml2YXRlS2V5KFxyXG4gIHByaXZhdGVLZXlQZW06IHN0cmluZyxcclxuICBwYXNzd29yZDogc3RyaW5nXHJcbik6IHN0cmluZyB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIERlcml2ZSBrZXkgZnJvbSBwYXNzd29yZCB1c2luZyBQQktERjJcclxuICAgIGNvbnN0IHNhbHQgPSBmb3JnZS5yYW5kb20uZ2V0Qnl0ZXNTeW5jKDMyKTtcclxuICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBmb3JnZS5wa2NzNS5wYmtkZjIocGFzc3dvcmQsIHNhbHQsIDEwMDAwMCwgMzIpO1xyXG5cclxuICAgIC8vIEdlbmVyYXRlIElWIGZvciBBRVMtR0NNXHJcbiAgICBjb25zdCBpdiA9IGZvcmdlLnJhbmRvbS5nZXRCeXRlc1N5bmMoMTIpO1xyXG5cclxuICAgIC8vIEVuY3J5cHQgdXNpbmcgQUVTLTI1Ni1HQ01cclxuICAgIGNvbnN0IGNpcGhlciA9IGZvcmdlLmNpcGhlci5jcmVhdGVDaXBoZXIoXCJBRVMtR0NNXCIsIGRlcml2ZWRLZXkpO1xyXG4gICAgY2lwaGVyLnN0YXJ0KHsgaXY6IGl2IH0pO1xyXG4gICAgY2lwaGVyLnVwZGF0ZShmb3JnZS51dGlsLmNyZWF0ZUJ1ZmZlcihwcml2YXRlS2V5UGVtLCBcInV0ZjhcIikpO1xyXG4gICAgY2lwaGVyLmZpbmlzaCgpO1xyXG5cclxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGNpcGhlci5vdXRwdXQuYnl0ZXMoKTtcclxuICAgIGNvbnN0IHRhZyA9IChjaXBoZXIubW9kZSBhcyBhbnkpLnRhZy5ieXRlcygpO1xyXG5cclxuICAgIC8vIENvbWJpbmUgc2FsdCArIGl2ICsgdGFnICsgZW5jcnlwdGVkIGRhdGFcclxuICAgIGNvbnN0IGNvbWJpbmVkID0gc2FsdCArIGl2ICsgdGFnICsgZW5jcnlwdGVkO1xyXG5cclxuICAgIC8vIFJldHVybiBhcyBiYXNlNjRcclxuICAgIHJldHVybiBmb3JnZS51dGlsLmVuY29kZTY0KGNvbWJpbmVkKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICBcIkZhaWxlZCB0byBlbmNyeXB0IHByaXZhdGUga2V5OiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWNyeXB0IHByaXZhdGUga2V5IHVzaW5nIHBhc3N3b3JkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGVjcnlwdFByaXZhdGVLZXkoXHJcbiAgZW5jcnlwdGVkRGF0YTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogc3RyaW5nIHtcclxuICB0cnkge1xyXG4gICAgLy8gRGVjb2RlIGZyb20gYmFzZTY0XHJcbiAgICBjb25zdCBjb21iaW5lZCA9IGZvcmdlLnV0aWwuZGVjb2RlNjQoZW5jcnlwdGVkRGF0YSk7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBjb21wb25lbnRzXHJcbiAgICBjb25zdCBzYWx0ID0gY29tYmluZWQuc2xpY2UoMCwgMzIpO1xyXG4gICAgY29uc3QgaXYgPSBjb21iaW5lZC5zbGljZSgzMiwgNDQpO1xyXG4gICAgY29uc3QgdGFnID0gY29tYmluZWQuc2xpY2UoNDQsIDYwKTtcclxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGNvbWJpbmVkLnNsaWNlKDYwKTtcclxuXHJcbiAgICAvLyBEZXJpdmUga2V5IGZyb20gcGFzc3dvcmRcclxuICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBmb3JnZS5wa2NzNS5wYmtkZjIocGFzc3dvcmQsIHNhbHQsIDEwMDAwMCwgMzIpO1xyXG5cclxuICAgIC8vIERlY3J5cHQgdXNpbmcgQUVTLTI1Ni1HQ01cclxuICAgIGNvbnN0IGRlY2lwaGVyID0gZm9yZ2UuY2lwaGVyLmNyZWF0ZURlY2lwaGVyKFwiQUVTLUdDTVwiLCBkZXJpdmVkS2V5KTtcclxuICAgIGRlY2lwaGVyLnN0YXJ0KHtcclxuICAgICAgaXY6IGl2LFxyXG4gICAgICB0YWc6IGZvcmdlLnV0aWwuY3JlYXRlQnVmZmVyKHRhZyksXHJcbiAgICB9KTtcclxuICAgIGRlY2lwaGVyLnVwZGF0ZShmb3JnZS51dGlsLmNyZWF0ZUJ1ZmZlcihlbmNyeXB0ZWQpKTtcclxuXHJcbiAgICBjb25zdCBzdWNjZXNzID0gZGVjaXBoZXIuZmluaXNoKCk7XHJcbiAgICBpZiAoIXN1Y2Nlc3MpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIFwiQXV0aGVudGljYXRpb24gZmFpbGVkIC0gaW5jb3JyZWN0IHBhc3N3b3JkIG9yIGNvcnJ1cHRlZCBkYXRhXCJcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZGVjaXBoZXIub3V0cHV0LnRvU3RyaW5nKCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJGYWlsZWQgdG8gZGVjcnlwdCBwcml2YXRlIGtleTogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgY2VydGlmaWNhdGUgYW5kIGV4dHJhY3QgaW5mb3JtYXRpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNlcnRpZmljYXRlKGNlcnRpZmljYXRlUGVtOiBzdHJpbmcpOiBDZXJ0aWZpY2F0ZUluZm8ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjZXJ0ID0gZm9yZ2UucGtpLmNlcnRpZmljYXRlRnJvbVBlbShjZXJ0aWZpY2F0ZVBlbSk7XHJcblxyXG4gICAgY29uc3QgZ2V0QXR0cmlidXRlVmFsdWUgPSAoYXR0cnM6IGFueVtdLCBuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBjb25zdCBhdHRyID0gYXR0cnMuZmluZCgoYSkgPT4gYS5uYW1lID09PSBuYW1lIHx8IGEuc2hvcnROYW1lID09PSBuYW1lKTtcclxuICAgICAgcmV0dXJuIGF0dHIgPyBhdHRyLnZhbHVlIDogXCJcIjtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3ViamVjdDogY2VydC5zdWJqZWN0LmF0dHJpYnV0ZXNcclxuICAgICAgICAubWFwKChhKSA9PiBgJHthLnNob3J0TmFtZSB8fCBhLm5hbWV9PSR7YS52YWx1ZX1gKVxyXG4gICAgICAgIC5qb2luKFwiLCBcIiksXHJcbiAgICAgIGlzc3VlcjogY2VydC5pc3N1ZXIuYXR0cmlidXRlc1xyXG4gICAgICAgIC5tYXAoKGEpID0+IGAke2Euc2hvcnROYW1lIHx8IGEubmFtZX09JHthLnZhbHVlfWApXHJcbiAgICAgICAgLmpvaW4oXCIsIFwiKSxcclxuICAgICAgdmFsaWRGcm9tOiBjZXJ0LnZhbGlkaXR5Lm5vdEJlZm9yZSxcclxuICAgICAgdmFsaWRUbzogY2VydC52YWxpZGl0eS5ub3RBZnRlcixcclxuICAgICAgc2VyaWFsTnVtYmVyOiBjZXJ0LnNlcmlhbE51bWJlcixcclxuICAgICAgYWxnb3JpdGhtOiBcIlJTQSB3aXRoIFNIQS0yNTZcIixcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBwYXJzZSBjZXJ0aWZpY2F0ZTogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBpZiBjZXJ0aWZpY2F0ZSBpcyBzdGlsbCB2YWxpZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2VydGlmaWNhdGVWYWxpZChjZXJ0aWZpY2F0ZVBlbTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNlcnQgPSBmb3JnZS5wa2kuY2VydGlmaWNhdGVGcm9tUGVtKGNlcnRpZmljYXRlUGVtKTtcclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICByZXR1cm4gbm93ID49IGNlcnQudmFsaWRpdHkubm90QmVmb3JlICYmIG5vdyA8PSBjZXJ0LnZhbGlkaXR5Lm5vdEFmdGVyO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJmb3JnZSIsImdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlIiwidXNlckluZm8iLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImtleXMiLCJwa2kiLCJyc2EiLCJnZW5lcmF0ZUtleVBhaXIiLCJjZXJ0IiwiY3JlYXRlQ2VydGlmaWNhdGUiLCJwdWJsaWNLZXkiLCJzZXJpYWxOdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInZhbGlkaXR5Iiwibm90QmVmb3JlIiwiRGF0ZSIsIm5vdEFmdGVyIiwic2V0RnVsbFllYXIiLCJnZXRGdWxsWWVhciIsImF0dHJzIiwibmFtZSIsInZhbHVlIiwiY29tbW9uTmFtZSIsInNob3J0TmFtZSIsIm9yZ2FuaXphdGlvbk5hbWUiLCJlbWFpbCIsInNldFN1YmplY3QiLCJzZXRJc3N1ZXIiLCJzZXRFeHRlbnNpb25zIiwiY0EiLCJkaWdpdGFsU2lnbmF0dXJlIiwibm9uUmVwdWRpYXRpb24iLCJrZXlFbmNpcGhlcm1lbnQiLCJzZXJ2ZXJBdXRoIiwiY2xpZW50QXV0aCIsImNvZGVTaWduaW5nIiwiZW1haWxQcm90ZWN0aW9uIiwic2lnbiIsInByaXZhdGVLZXkiLCJtZCIsInNoYTI1NiIsImNyZWF0ZSIsInB1YmxpY0tleVBlbSIsInB1YmxpY0tleVRvUGVtIiwicHJpdmF0ZUtleVBlbSIsInByaXZhdGVLZXlUb1BlbSIsImNlcnRpZmljYXRlUGVtIiwiY2VydGlmaWNhdGVUb1BlbSIsImNlcnRpZmljYXRlIiwiZXJyb3IiLCJlbmNyeXB0UHJpdmF0ZUtleSIsInBhc3N3b3JkIiwic2FsdCIsImdldEJ5dGVzU3luYyIsImRlcml2ZWRLZXkiLCJwa2NzNSIsInBia2RmMiIsIml2IiwiY2lwaGVyIiwiY3JlYXRlQ2lwaGVyIiwic3RhcnQiLCJ1cGRhdGUiLCJ1dGlsIiwiY3JlYXRlQnVmZmVyIiwiZmluaXNoIiwiZW5jcnlwdGVkIiwib3V0cHV0IiwiYnl0ZXMiLCJ0YWciLCJtb2RlIiwiY29tYmluZWQiLCJlbmNvZGU2NCIsIkVycm9yIiwibWVzc2FnZSIsImRlY3J5cHRQcml2YXRlS2V5IiwiZW5jcnlwdGVkRGF0YSIsImRlY29kZTY0Iiwic2xpY2UiLCJkZWNpcGhlciIsImNyZWF0ZURlY2lwaGVyIiwic3VjY2VzcyIsInBhcnNlQ2VydGlmaWNhdGUiLCJjZXJ0aWZpY2F0ZUZyb21QZW0iLCJnZXRBdHRyaWJ1dGVWYWx1ZSIsImF0dHIiLCJmaW5kIiwiYSIsInN1YmplY3QiLCJhdHRyaWJ1dGVzIiwibWFwIiwiam9pbiIsImlzc3VlciIsInZhbGlkRnJvbSIsInZhbGlkVG8iLCJhbGdvcml0aG0iLCJpc0NlcnRpZmljYXRlVmFsaWQiLCJub3ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/crypto.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDatabase: () => (/* binding */ getDatabase),\n/* harmony export */   pdfDb: () => (/* binding */ pdfDb),\n/* harmony export */   userDb: () => (/* binding */ userDb),\n/* harmony export */   userKeysDb: () => (/* binding */ userKeysDb)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/models/User */ \"(rsc)/./models/User.ts\");\n/* harmony import */ var _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/models/UserKeys */ \"(rsc)/./models/UserKeys.ts\");\n/* harmony import */ var _models_PDF__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/PDF */ \"(rsc)/./models/PDF.ts\");\n// (fungsi updateProfile dipindahkan ke dalam objek userDb di bawah)\n\n\n\n\n\n// User operations\nconst userDb = {\n    async updateProfile (userId, data) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findByIdAndUpdate(userId, {\n            ...data.name !== undefined ? {\n                name: data.name\n            } : {},\n            ...data.organizationName !== undefined ? {\n                organizationName: data.organizationName\n            } : {},\n            ...data.position !== undefined ? {\n                position: data.position\n            } : {}\n        }, {\n            new: true\n        });\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async create (userData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const passwordHash = await bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().hash(userData.password, 10);\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].create({\n            email: userData.email,\n            passwordHash,\n            name: userData.name,\n            role: userData.role,\n            organizationName: userData.organizationName,\n            position: userData.position,\n            createdAt: new Date(),\n            hasKeys: false\n        });\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async findByEmail (email) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findOne({\n            email\n        });\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async findById (id) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findById(id);\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async updateHasKeys (userId, hasKeys) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findByIdAndUpdate(userId, {\n            hasKeys\n        });\n    },\n    async verifyPassword (email, password) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findOne({\n            email\n        });\n        if (!userDoc) return null;\n        const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().compare(password, userDoc.passwordHash);\n        if (!isValid) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    }\n};\n// User keys operations\nconst userKeysDb = {\n    async create (keysData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const keys = await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].create({\n            ...keysData,\n            createdAt: new Date()\n        });\n        await userDb.updateHasKeys(keysData.userId, true);\n        return keys.toObject();\n    },\n    async findByUserId (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const keys = await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].findOne({\n            userId\n        });\n        return keys ? keys.toObject() : null;\n    },\n    async update (userId, keysData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].findOneAndUpdate({\n            userId\n        }, keysData);\n    },\n    async delete (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].deleteOne({\n            userId\n        });\n        await userDb.updateHasKeys(userId, false);\n    }\n};\n// PDF operations\nconst pdfDb = {\n    async create (pdfData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdf = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].create({\n            ...pdfData,\n            createdAt: new Date()\n        });\n        return pdf.toObject();\n    },\n    async findById (id) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdf = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findById(id);\n        return pdf ? pdf.toObject() : null;\n    },\n    async findByUserId (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdfs = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].find({\n            userId\n        });\n        return pdfs.map((pdf)=>pdf.toObject());\n    },\n    async update (id, data) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findByIdAndUpdate(id, data);\n    }\n};\n// Export for testing/debugging (optional, now returns nothing)\nconst getDatabase = ()=>({});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNRSx3REFBYUEsQ0FBQzJDLFNBQVMsQ0FBQztZQUFFdkM7UUFBTztRQUN2QyxNQUFNRixPQUFPOEIsYUFBYSxDQUFDNUIsUUFBUTtJQUNyQztBQUNGLEVBQUU7QUFFRixpQkFBaUI7QUFDVixNQUFNd0MsUUFBUTtJQUNuQixNQUFNeEIsUUFBT3lCLE9BT1o7UUFDQyxNQUFNL0MsdURBQVNBO1FBQ2YsTUFBTWdELE1BQU0sTUFBTTdDLG1EQUFRQSxDQUFDbUIsTUFBTSxDQUFDO1lBQ2hDLEdBQUd5QixPQUFPO1lBQ1ZuQixXQUFXLElBQUlDO1FBQ2pCO1FBQ0EsT0FBT21CLElBQUk5QixRQUFRO0lBQ3JCO0lBRUEsTUFBTWUsVUFBU2QsRUFBVTtRQUN2QixNQUFNbkIsdURBQVNBO1FBQ2YsTUFBTWdELE1BQU0sTUFBTTdDLG1EQUFRQSxDQUFDOEIsUUFBUSxDQUFDZDtRQUNwQyxPQUFPNkIsTUFBTUEsSUFBSTlCLFFBQVEsS0FBSztJQUNoQztJQUVBLE1BQU11QixjQUFhbkMsTUFBYztRQUMvQixNQUFNTix1REFBU0E7UUFDZixNQUFNaUQsT0FBTyxNQUFNOUMsbURBQVFBLENBQUMrQyxJQUFJLENBQUM7WUFBRTVDO1FBQU87UUFDMUMsT0FBTzJDLEtBQUtFLEdBQUcsQ0FBQyxDQUFDSCxNQUFRQSxJQUFJOUIsUUFBUTtJQUN2QztJQUVBLE1BQU13QixRQUFPdkIsRUFBVSxFQUFFWixJQUFtQjtRQUMxQyxNQUFNUCx1REFBU0E7UUFDZixNQUFNRyxtREFBUUEsQ0FBQ00saUJBQWlCLENBQUNVLElBQUlaO0lBQ3ZDO0FBQ0YsRUFBRTtBQUVGLCtEQUErRDtBQUN4RCxNQUFNNkMsY0FBYyxJQUFPLEVBQUMsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gKGZ1bmdzaSB1cGRhdGVQcm9maWxlIGRpcGluZGFoa2FuIGtlIGRhbGFtIG9iamVrIHVzZXJEYiBkaSBiYXdhaClcclxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcclxuaW1wb3J0IHsgZGJDb25uZWN0IH0gZnJvbSBcIkAvbGliL21vbmdvZGJcIjtcclxuaW1wb3J0IFVzZXJNb2RlbCwgeyBJVXNlciB9IGZyb20gXCJAL21vZGVscy9Vc2VyXCI7XHJcbmltcG9ydCBVc2VyS2V5c01vZGVsLCB7IElVc2VyS2V5cyB9IGZyb20gXCJAL21vZGVscy9Vc2VyS2V5c1wiO1xyXG5pbXBvcnQgUERGTW9kZWwsIHsgSVBERiB9IGZyb20gXCJAL21vZGVscy9QREZcIjtcclxuXHJcbi8vIFVzZXIgb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgdXNlckRiID0ge1xyXG4gIGFzeW5jIHVwZGF0ZVByb2ZpbGUoXHJcbiAgICB1c2VySWQ6IHN0cmluZyxcclxuICAgIGRhdGE6IHsgbmFtZT86IHN0cmluZzsgb3JnYW5pemF0aW9uTmFtZT86IHN0cmluZzsgcG9zaXRpb24/OiBzdHJpbmcgfVxyXG4gICk6IFByb21pc2U8KElVc2VyICYgeyBpZDogc3RyaW5nIH0pIHwgbnVsbD4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkQW5kVXBkYXRlKFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHtcclxuICAgICAgICAuLi4oZGF0YS5uYW1lICE9PSB1bmRlZmluZWQgPyB7IG5hbWU6IGRhdGEubmFtZSB9IDoge30pLFxyXG4gICAgICAgIC4uLihkYXRhLm9yZ2FuaXphdGlvbk5hbWUgIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgPyB7IG9yZ2FuaXphdGlvbk5hbWU6IGRhdGEub3JnYW5pemF0aW9uTmFtZSB9XHJcbiAgICAgICAgICA6IHt9KSxcclxuICAgICAgICAuLi4oZGF0YS5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkID8geyBwb3NpdGlvbjogZGF0YS5wb3NpdGlvbiB9IDoge30pLFxyXG4gICAgICB9LFxyXG4gICAgICB7IG5ldzogdHJ1ZSB9XHJcbiAgICApO1xyXG4gICAgaWYgKCF1c2VyRG9jKSByZXR1cm4gbnVsbDtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcbiAgYXN5bmMgY3JlYXRlKHVzZXJEYXRhOiB7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgcGFzc3dvcmQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHJvbGU6IFwib3JnYW5pemF0aW9uXCIgfCBcImNvbnN1bHRhbnRcIjtcclxuICAgIG9yZ2FuaXphdGlvbk5hbWU/OiBzdHJpbmc7XHJcbiAgICBwb3NpdGlvbj86IHN0cmluZztcclxuICB9KTogUHJvbWlzZTxPbWl0PElVc2VyLCBcInBhc3N3b3JkSGFzaFwiPiAmIHsgaWQ6IHN0cmluZyB9PiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGJjcnlwdC5oYXNoKHVzZXJEYXRhLnBhc3N3b3JkLCAxMCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmNyZWF0ZSh7XHJcbiAgICAgIGVtYWlsOiB1c2VyRGF0YS5lbWFpbCxcclxuICAgICAgcGFzc3dvcmRIYXNoLFxyXG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICByb2xlOiB1c2VyRGF0YS5yb2xlLFxyXG4gICAgICBvcmdhbml6YXRpb25OYW1lOiB1c2VyRGF0YS5vcmdhbml6YXRpb25OYW1lLFxyXG4gICAgICBwb3NpdGlvbjogdXNlckRhdGEucG9zaXRpb24sXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgaGFzS2V5czogZmFsc2UsXHJcbiAgICB9KTtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUVtYWlsKGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPChJVXNlciAmIHsgaWQ6IHN0cmluZyB9KSB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IFVzZXJNb2RlbC5maW5kT25lKHsgZW1haWwgfSk7XHJcbiAgICBpZiAoIXVzZXJEb2MpIHJldHVybiBudWxsO1xyXG4gICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgY29uc3QgeyBwYXNzd29yZEhhc2g6IF8sIC4uLnVzZXIgfSA9IHVzZXJEb2MudG9PYmplY3QoKTtcclxuICAgIHJldHVybiB7IC4uLnVzZXIsIGlkOiB1c2VyRG9jLl9pZC50b1N0cmluZygpIH07XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8KElVc2VyICYgeyBpZDogc3RyaW5nIH0pIHwgbnVsbD4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKGlkKTtcclxuICAgIGlmICghdXNlckRvYykgcmV0dXJuIG51bGw7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICBjb25zdCB7IHBhc3N3b3JkSGFzaDogXywgLi4udXNlciB9ID0gdXNlckRvYy50b09iamVjdCgpO1xyXG4gICAgcmV0dXJuIHsgLi4udXNlciwgaWQ6IHVzZXJEb2MuX2lkLnRvU3RyaW5nKCkgfTtcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGVIYXNLZXlzKHVzZXJJZDogc3RyaW5nLCBoYXNLZXlzOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZEFuZFVwZGF0ZSh1c2VySWQsIHsgaGFzS2V5cyB9KTtcclxuICB9LFxyXG5cclxuICBhc3luYyB2ZXJpZnlQYXNzd29yZChcclxuICAgIGVtYWlsOiBzdHJpbmcsXHJcbiAgICBwYXNzd29yZDogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTwoSVVzZXIgJiB7IGlkOiBzdHJpbmcgfSkgfCBudWxsPiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGNvbnN0IHVzZXJEb2MgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7IGVtYWlsIH0pO1xyXG4gICAgaWYgKCF1c2VyRG9jKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlckRvYy5wYXNzd29yZEhhc2gpO1xyXG4gICAgaWYgKCFpc1ZhbGlkKSByZXR1cm4gbnVsbDtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBVc2VyIGtleXMgb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgdXNlcktleXNEYiA9IHtcclxuICBhc3luYyBjcmVhdGUoa2V5c0RhdGE6IHtcclxuICAgIHVzZXJJZDogc3RyaW5nO1xyXG4gICAgcHVibGljS2V5OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlS2V5RW5jcnlwdGVkOiBzdHJpbmc7XHJcbiAgICBjZXJ0aWZpY2F0ZTogc3RyaW5nO1xyXG4gIH0pOiBQcm9taXNlPElVc2VyS2V5cz4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCBrZXlzID0gYXdhaXQgVXNlcktleXNNb2RlbC5jcmVhdGUoe1xyXG4gICAgICAuLi5rZXlzRGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCB1c2VyRGIudXBkYXRlSGFzS2V5cyhrZXlzRGF0YS51c2VySWQsIHRydWUpO1xyXG4gICAgcmV0dXJuIGtleXMudG9PYmplY3QoKTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPElVc2VyS2V5cyB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3Qga2V5cyA9IGF3YWl0IFVzZXJLZXlzTW9kZWwuZmluZE9uZSh7IHVzZXJJZCB9KTtcclxuICAgIHJldHVybiBrZXlzID8ga2V5cy50b09iamVjdCgpIDogbnVsbDtcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGUodXNlcklkOiBzdHJpbmcsIGtleXNEYXRhOiBQYXJ0aWFsPElVc2VyS2V5cz4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgVXNlcktleXNNb2RlbC5maW5kT25lQW5kVXBkYXRlKHsgdXNlcklkIH0sIGtleXNEYXRhKTtcclxuICB9LFxyXG5cclxuICBhc3luYyBkZWxldGUodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgVXNlcktleXNNb2RlbC5kZWxldGVPbmUoeyB1c2VySWQgfSk7XHJcbiAgICBhd2FpdCB1c2VyRGIudXBkYXRlSGFzS2V5cyh1c2VySWQsIGZhbHNlKTtcclxuICB9LFxyXG59O1xyXG5cclxuLy8gUERGIG9wZXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IHBkZkRiID0ge1xyXG4gIGFzeW5jIGNyZWF0ZShwZGZEYXRhOiB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB1c2VySWQ6IHN0cmluZztcclxuICAgIGNvbnRlbnQ6IEJ1ZmZlcjtcclxuICAgIHNpZ25lZDogYm9vbGVhbjtcclxuICAgIHNpZ25lZEJ5Pzogc3RyaW5nO1xyXG4gICAgc2lnbmVkQXQ/OiBEYXRlO1xyXG4gIH0pOiBQcm9taXNlPElQREY+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgcGRmID0gYXdhaXQgUERGTW9kZWwuY3JlYXRlKHtcclxuICAgICAgLi4ucGRmRGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcGRmLnRvT2JqZWN0KCk7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8SVBERiB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgcGRmID0gYXdhaXQgUERGTW9kZWwuZmluZEJ5SWQoaWQpO1xyXG4gICAgcmV0dXJuIHBkZiA/IHBkZi50b09iamVjdCgpIDogbnVsbDtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPElQREZbXT4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCBwZGZzID0gYXdhaXQgUERGTW9kZWwuZmluZCh7IHVzZXJJZCB9KTtcclxuICAgIHJldHVybiBwZGZzLm1hcCgocGRmKSA9PiBwZGYudG9PYmplY3QoKSk7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFBhcnRpYWw8SVBERj4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgUERGTW9kZWwuZmluZEJ5SWRBbmRVcGRhdGUoaWQsIGRhdGEpO1xyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBFeHBvcnQgZm9yIHRlc3RpbmcvZGVidWdnaW5nIChvcHRpb25hbCwgbm93IHJldHVybnMgbm90aGluZylcclxuZXhwb3J0IGNvbnN0IGdldERhdGFiYXNlID0gKCkgPT4gKHt9KTtcclxuIl0sIm5hbWVzIjpbImJjcnlwdCIsImRiQ29ubmVjdCIsIlVzZXJNb2RlbCIsIlVzZXJLZXlzTW9kZWwiLCJQREZNb2RlbCIsInVzZXJEYiIsInVwZGF0ZVByb2ZpbGUiLCJ1c2VySWQiLCJkYXRhIiwidXNlckRvYyIsImZpbmRCeUlkQW5kVXBkYXRlIiwibmFtZSIsInVuZGVmaW5lZCIsIm9yZ2FuaXphdGlvbk5hbWUiLCJwb3NpdGlvbiIsIm5ldyIsInBhc3N3b3JkSGFzaCIsIl8iLCJ1c2VyIiwidG9PYmplY3QiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwiY3JlYXRlIiwidXNlckRhdGEiLCJoYXNoIiwicGFzc3dvcmQiLCJlbWFpbCIsInJvbGUiLCJjcmVhdGVkQXQiLCJEYXRlIiwiaGFzS2V5cyIsImZpbmRCeUVtYWlsIiwiZmluZE9uZSIsImZpbmRCeUlkIiwidXBkYXRlSGFzS2V5cyIsInZlcmlmeVBhc3N3b3JkIiwiaXNWYWxpZCIsImNvbXBhcmUiLCJ1c2VyS2V5c0RiIiwia2V5c0RhdGEiLCJrZXlzIiwiZmluZEJ5VXNlcklkIiwidXBkYXRlIiwiZmluZE9uZUFuZFVwZGF0ZSIsImRlbGV0ZSIsImRlbGV0ZU9uZSIsInBkZkRiIiwicGRmRGF0YSIsInBkZiIsInBkZnMiLCJmaW5kIiwibWFwIiwiZ2V0RGF0YWJhc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.ts":
/*!************************!*\
  !*** ./lib/mongodb.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   dbConnect: () => (/* binding */ dbConnect)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/pdfsign\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\nlet cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, {\n            bufferCommands: false\n        }).then((mongoose)=>{\n            return mongoose;\n        });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9uZ29kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsY0FDSkMsUUFBUUMsR0FBRyxDQUFDRixXQUFXLElBQUk7QUFFN0IsSUFBSSxDQUFDQSxhQUFhO0lBQ2hCLE1BQU0sSUFBSUcsTUFDUjtBQUVKO0FBRUEsSUFBSUMsU0FBUyxPQUFnQkwsUUFBUTtBQUVyQyxJQUFJLENBQUNLLFFBQVE7SUFDWEEsU0FBUyxPQUFnQkwsUUFBUSxHQUFHO1FBQUVPLE1BQU07UUFBTUMsU0FBUztJQUFLO0FBQ2xFO0FBRU8sZUFBZUM7SUFDcEIsSUFBSUosT0FBT0UsSUFBSSxFQUFFO1FBQ2YsT0FBT0YsT0FBT0UsSUFBSTtJQUNwQjtJQUNBLElBQUksQ0FBQ0YsT0FBT0csT0FBTyxFQUFFO1FBQ25CSCxPQUFPRyxPQUFPLEdBQUdSLHVEQUNQLENBQUNDLGFBQWE7WUFDcEJVLGdCQUFnQjtRQUNsQixHQUNDQyxJQUFJLENBQUMsQ0FBQ1o7WUFDTCxPQUFPQTtRQUNUO0lBQ0o7SUFDQUssT0FBT0UsSUFBSSxHQUFHLE1BQU1GLE9BQU9HLE9BQU87SUFDbEMsT0FBT0gsT0FBT0UsSUFBSTtBQUNwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL21vbmdvZGIudHM/MDViZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG5jb25zdCBNT05HT0RCX1VSSSA9XHJcbiAgcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgXCJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L3BkZnNpZ25cIjtcclxuXHJcbmlmICghTU9OR09EQl9VUkkpIHtcclxuICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICBcIlBsZWFzZSBkZWZpbmUgdGhlIE1PTkdPREJfVVJJIGVudmlyb25tZW50IHZhcmlhYmxlIGluc2lkZSAuZW52LmxvY2FsXCJcclxuICApO1xyXG59XHJcblxyXG5sZXQgY2FjaGVkID0gKGdsb2JhbCBhcyBhbnkpLm1vbmdvb3NlO1xyXG5cclxuaWYgKCFjYWNoZWQpIHtcclxuICBjYWNoZWQgPSAoZ2xvYmFsIGFzIGFueSkubW9uZ29vc2UgPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRiQ29ubmVjdCgpIHtcclxuICBpZiAoY2FjaGVkLmNvbm4pIHtcclxuICAgIHJldHVybiBjYWNoZWQuY29ubjtcclxuICB9XHJcbiAgaWYgKCFjYWNoZWQucHJvbWlzZSkge1xyXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZVxyXG4gICAgICAuY29ubmVjdChNT05HT0RCX1VSSSwge1xyXG4gICAgICAgIGJ1ZmZlckNvbW1hbmRzOiBmYWxzZSxcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKG1vbmdvb3NlKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIG1vbmdvb3NlO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgY2FjaGVkLmNvbm4gPSBhd2FpdCBjYWNoZWQucHJvbWlzZTtcclxuICByZXR1cm4gY2FjaGVkLmNvbm47XHJcbn1cclxuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJjYWNoZWQiLCJnbG9iYWwiLCJjb25uIiwicHJvbWlzZSIsImRiQ29ubmVjdCIsImNvbm5lY3QiLCJidWZmZXJDb21tYW5kcyIsInRoZW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./models/PDF.ts":
/*!***********************!*\
  !*** ./models/PDF.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst PDFSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    name: {\n        type: String,\n        required: true\n    },\n    userId: {\n        type: String,\n        required: true\n    },\n    content: {\n        type: Buffer,\n        required: true\n    },\n    signed: {\n        type: Boolean,\n        default: false\n    },\n    signedBy: {\n        type: String\n    },\n    signedAt: {\n        type: Date\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).PDF || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"PDF\", PDFSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvUERGLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFzRDtBQVl0RCxNQUFNRSxZQUFZLElBQUlELDRDQUFNQSxDQUFPO0lBQ2pDRSxNQUFNO1FBQUVDLE1BQU1DO1FBQVFDLFVBQVU7SUFBSztJQUNyQ0MsUUFBUTtRQUFFSCxNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDdkNFLFNBQVM7UUFBRUosTUFBTUs7UUFBUUgsVUFBVTtJQUFLO0lBQ3hDSSxRQUFRO1FBQUVOLE1BQU1PO1FBQVNDLFNBQVM7SUFBTTtJQUN4Q0MsVUFBVTtRQUFFVCxNQUFNQztJQUFPO0lBQ3pCUyxVQUFVO1FBQUVWLE1BQU1XO0lBQUs7SUFDdkJDLFdBQVc7UUFBRVosTUFBTVc7UUFBTUgsU0FBU0csS0FBS0UsR0FBRztJQUFDO0FBQzdDO0FBRUEsaUVBQWVqQix3REFBZSxDQUFDbUIsR0FBRyxJQUFJbkIscURBQWMsQ0FBTyxPQUFPRSxVQUFVQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vLi9tb2RlbHMvUERGLnRzPzUxNTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IFNjaGVtYSwgRG9jdW1lbnQgfSBmcm9tIFwibW9uZ29vc2VcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVBERiBleHRlbmRzIERvY3VtZW50IHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgY29udGVudDogQnVmZmVyO1xyXG4gIHNpZ25lZDogYm9vbGVhbjtcclxuICBzaWduZWRCeT86IHN0cmluZztcclxuICBzaWduZWRBdD86IERhdGU7XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG59XHJcblxyXG5jb25zdCBQREZTY2hlbWEgPSBuZXcgU2NoZW1hPElQREY+KHtcclxuICBuYW1lOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICB1c2VySWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIGNvbnRlbnQ6IHsgdHlwZTogQnVmZmVyLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHNpZ25lZDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxyXG4gIHNpZ25lZEJ5OiB7IHR5cGU6IFN0cmluZyB9LFxyXG4gIHNpZ25lZEF0OiB7IHR5cGU6IERhdGUgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbHMuUERGIHx8IG1vbmdvb3NlLm1vZGVsPElQREY+KFwiUERGXCIsIFBERlNjaGVtYSk7XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIlNjaGVtYSIsIlBERlNjaGVtYSIsIm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1c2VySWQiLCJjb250ZW50IiwiQnVmZmVyIiwic2lnbmVkIiwiQm9vbGVhbiIsImRlZmF1bHQiLCJzaWduZWRCeSIsInNpZ25lZEF0IiwiRGF0ZSIsImNyZWF0ZWRBdCIsIm5vdyIsIm1vZGVscyIsIlBERiIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/PDF.ts\n");

/***/ }),

/***/ "(rsc)/./models/User.ts":
/*!************************!*\
  !*** ./models/User.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst UserSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    email: {\n        type: String,\n        required: true,\n        unique: true\n    },\n    passwordHash: {\n        type: String,\n        required: true\n    },\n    name: {\n        type: String,\n        required: true\n    },\n    role: {\n        type: String,\n        enum: [\n            \"organization\",\n            \"consultant\"\n        ],\n        required: true\n    },\n    organizationName: {\n        type: String\n    },\n    position: {\n        type: String\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    },\n    hasKeys: {\n        type: Boolean,\n        default: false\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).User || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"User\", UserSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvVXNlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0Q7QUFhdEQsTUFBTUUsYUFBYSxJQUFJRCw0Q0FBTUEsQ0FBUTtJQUNuQ0UsT0FBTztRQUFFQyxNQUFNQztRQUFRQyxVQUFVO1FBQU1DLFFBQVE7SUFBSztJQUNwREMsY0FBYztRQUFFSixNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDN0NHLE1BQU07UUFBRUwsTUFBTUM7UUFBUUMsVUFBVTtJQUFLO0lBQ3JDSSxNQUFNO1FBQUVOLE1BQU1DO1FBQVFNLE1BQU07WUFBQztZQUFnQjtTQUFhO1FBQUVMLFVBQVU7SUFBSztJQUMzRU0sa0JBQWtCO1FBQUVSLE1BQU1DO0lBQU87SUFDakNRLFVBQVU7UUFBRVQsTUFBTUM7SUFBTztJQUN6QlMsV0FBVztRQUFFVixNQUFNVztRQUFNQyxTQUFTRCxLQUFLRSxHQUFHO0lBQUM7SUFDM0NDLFNBQVM7UUFBRWQsTUFBTWU7UUFBU0gsU0FBUztJQUFNO0FBQzNDO0FBRUEsaUVBQWVoQix3REFBZSxDQUFDcUIsSUFBSSxJQUNqQ3JCLHFEQUFjLENBQVEsUUFBUUUsV0FBV0EsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbW9kZWxzL1VzZXIudHM/NmRjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHsgU2NoZW1hLCBEb2N1bWVudCB9IGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJVXNlciBleHRlbmRzIERvY3VtZW50IHtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIHBhc3N3b3JkSGFzaDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICByb2xlOiBcIm9yZ2FuaXphdGlvblwiIHwgXCJjb25zdWx0YW50XCI7XHJcbiAgb3JnYW5pemF0aW9uTmFtZT86IHN0cmluZztcclxuICBwb3NpdGlvbj86IHN0cmluZzsgLy8gamFiYXRhblxyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxuICBoYXNLZXlzOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYTxJVXNlcj4oe1xyXG4gIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxyXG4gIHBhc3N3b3JkSGFzaDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgbmFtZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgcm9sZTogeyB0eXBlOiBTdHJpbmcsIGVudW06IFtcIm9yZ2FuaXphdGlvblwiLCBcImNvbnN1bHRhbnRcIl0sIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgb3JnYW5pemF0aW9uTmFtZTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICBwb3NpdGlvbjogeyB0eXBlOiBTdHJpbmcgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICBoYXNLZXlzOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sXHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlVzZXIgfHxcclxuICBtb25nb29zZS5tb2RlbDxJVXNlcj4oXCJVc2VyXCIsIFVzZXJTY2hlbWEpO1xyXG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwiZW1haWwiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJwYXNzd29yZEhhc2giLCJuYW1lIiwicm9sZSIsImVudW0iLCJvcmdhbml6YXRpb25OYW1lIiwicG9zaXRpb24iLCJjcmVhdGVkQXQiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsImhhc0tleXMiLCJCb29sZWFuIiwibW9kZWxzIiwiVXNlciIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/User.ts\n");

/***/ }),

/***/ "(rsc)/./models/UserKeys.ts":
/*!****************************!*\
  !*** ./models/UserKeys.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst UserKeysSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    userId: {\n        type: String,\n        required: true,\n        unique: true\n    },\n    publicKey: {\n        type: String,\n        required: true\n    },\n    privateKeyEncrypted: {\n        type: String,\n        required: true\n    },\n    certificate: {\n        type: String,\n        required: true\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).UserKeys || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"UserKeys\", UserKeysSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvVXNlcktleXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNEO0FBVXRELE1BQU1FLGlCQUFpQixJQUFJRCw0Q0FBTUEsQ0FBWTtJQUMzQ0UsUUFBUTtRQUFFQyxNQUFNQztRQUFRQyxVQUFVO1FBQU1DLFFBQVE7SUFBSztJQUNyREMsV0FBVztRQUFFSixNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDMUNHLHFCQUFxQjtRQUFFTCxNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDcERJLGFBQWE7UUFBRU4sTUFBTUM7UUFBUUMsVUFBVTtJQUFLO0lBQzVDSyxXQUFXO1FBQUVQLE1BQU1RO1FBQU1DLFNBQVNELEtBQUtFLEdBQUc7SUFBQztBQUM3QztBQUVBLGlFQUFlZCx3REFBZSxDQUFDZ0IsUUFBUSxJQUNyQ2hCLHFEQUFjLENBQVksWUFBWUUsZUFBZUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbW9kZWxzL1VzZXJLZXlzLnRzPzUyOTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IFNjaGVtYSwgRG9jdW1lbnQgfSBmcm9tIFwibW9uZ29vc2VcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVVzZXJLZXlzIGV4dGVuZHMgRG9jdW1lbnQge1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIHB1YmxpY0tleTogc3RyaW5nO1xyXG4gIHByaXZhdGVLZXlFbmNyeXB0ZWQ6IHN0cmluZztcclxuICBjZXJ0aWZpY2F0ZTogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxufVxyXG5cclxuY29uc3QgVXNlcktleXNTY2hlbWEgPSBuZXcgU2NoZW1hPElVc2VyS2V5cz4oe1xyXG4gIHVzZXJJZDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB1bmlxdWU6IHRydWUgfSxcclxuICBwdWJsaWNLZXk6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHByaXZhdGVLZXlFbmNyeXB0ZWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIGNlcnRpZmljYXRlOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbHMuVXNlcktleXMgfHxcclxuICBtb25nb29zZS5tb2RlbDxJVXNlcktleXM+KFwiVXNlcktleXNcIiwgVXNlcktleXNTY2hlbWEpO1xyXG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJTY2hlbWEiLCJVc2VyS2V5c1NjaGVtYSIsInVzZXJJZCIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsInB1YmxpY0tleSIsInByaXZhdGVLZXlFbmNyeXB0ZWQiLCJjZXJ0aWZpY2F0ZSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJkZWZhdWx0Iiwibm93IiwibW9kZWxzIiwiVXNlcktleXMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./models/UserKeys.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/zod","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fuser%2Fkeys%2Froute&page=%2Fapi%2Fuser%2Fkeys%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fuser%2Fkeys%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();