"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/pdf/sign/route";
exports.ids = ["app/api/pdf/sign/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node-forge":
/*!*****************************!*\
  !*** external "node-forge" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("node-forge");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpdf%2Fsign%2Froute&page=%2Fapi%2Fpdf%2Fsign%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpdf%2Fsign%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpdf%2Fsign%2Froute&page=%2Fapi%2Fpdf%2Fsign%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpdf%2Fsign%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Coolyeah_semester5_Keamanan_Informasi_Tugas3_app_api_pdf_sign_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/pdf/sign/route.ts */ \"(rsc)/./app/api/pdf/sign/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/pdf/sign/route\",\n        pathname: \"/api/pdf/sign\",\n        filename: \"route\",\n        bundlePath: \"app/api/pdf/sign/route\"\n    },\n    resolvedPagePath: \"D:\\\\Coolyeah\\\\semester5\\\\Keamanan Informasi\\\\Tugas3\\\\app\\\\api\\\\pdf\\\\sign\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Coolyeah_semester5_Keamanan_Informasi_Tugas3_app_api_pdf_sign_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/pdf/sign/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwZGYlMkZzaWduJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwZGYlMkZzaWduJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcGRmJTJGc2lnbiUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDQ29vbHllYWglNUNzZW1lc3RlcjUlNUNLZWFtYW5hbiUyMEluZm9ybWFzaSU1Q1R1Z2FzMyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q0Nvb2x5ZWFoJTVDc2VtZXN0ZXI1JTVDS2VhbWFuYW4lMjBJbmZvcm1hc2klNUNUdWdhczMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2tDO0FBQy9HO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vPzU3ZDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcQ29vbHllYWhcXFxcc2VtZXN0ZXI1XFxcXEtlYW1hbmFuIEluZm9ybWFzaVxcXFxUdWdhczNcXFxcYXBwXFxcXGFwaVxcXFxwZGZcXFxcc2lnblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcGRmL3NpZ24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wZGYvc2lnblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcGRmL3NpZ24vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxDb29seWVhaFxcXFxzZW1lc3RlcjVcXFxcS2VhbWFuYW4gSW5mb3JtYXNpXFxcXFR1Z2FzM1xcXFxhcHBcXFxcYXBpXFxcXHBkZlxcXFxzaWduXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wZGYvc2lnbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpdf%2Fsign%2Froute&page=%2Fapi%2Fpdf%2Fsign%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpdf%2Fsign%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/pdf/sign/route.ts":
/*!***********************************!*\
  !*** ./app/api/pdf/sign/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/crypto */ \"(rsc)/./lib/crypto.ts\");\n/* harmony import */ var _lib_pdf_signer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/pdf-signer */ \"(rsc)/./lib/pdf-signer.ts\");\n/* harmony import */ var _lib_pdf_signpdf__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/pdf-signpdf */ \"(rsc)/./lib/pdf-signpdf.ts\");\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! node-forge */ \"node-forge\");\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(node_forge__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\nconst runtime = \"nodejs\";\n\n\n\n\n\n\n\n\nconst signPDFSchema = zod__WEBPACK_IMPORTED_MODULE_7__.object({\n    password: zod__WEBPACK_IMPORTED_MODULE_7__.string().min(8)\n});\nasync function POST(request) {\n    try {\n        // Get user from token\n        const tokenPayload = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.getUserFromRequest)(request);\n        if (!tokenPayload) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Check if user is organization\n        if (tokenPayload.role !== \"organization\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Only organizations can sign PDF documents\"\n            }, {\n                status: 403\n            });\n        }\n        // Parse form data\n        const formData = await request.formData();\n        const pdfFile = formData.get(\"pdf\");\n        const password = formData.get(\"password\");\n        // For node-signpdf: accept PKCS#12 (PFX) and passphrase\n        const p12File = formData.get(\"p12\");\n        const p12Passphrase = formData.get(\"p12Passphrase\");\n        if (!pdfFile || !password) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"PDF file and password are required\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate password\n        const validation = signPDFSchema.safeParse({\n            password\n        });\n        if (!validation.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid input\",\n                details: validation.error.errors\n            }, {\n                status: 400\n            });\n        }\n        // Get user keys\n        const keys = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.userKeysDb.findByUserId(tokenPayload.userId);\n        if (!keys) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Keys not found. Please generate keys first.\"\n            }, {\n                status: 404\n            });\n        }\n        // Decrypt private key\n        let privateKey;\n        try {\n            privateKey = (0,_lib_crypto__WEBPACK_IMPORTED_MODULE_3__.decryptPrivateKey)(keys.privateKeyEncrypted, password);\n        } catch (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid password\"\n            }, {\n                status: 401\n            });\n        }\n        // Read PDF file\n        const pdfBuffer = Buffer.from(await pdfFile.arrayBuffer());\n        // Validate PDF magic number (first 4 bytes: %PDF)\n        if (pdfBuffer.length < 4 || pdfBuffer.toString(\"utf8\", 0, 4) !== \"%PDF\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Uploaded file is not a valid PDF document.\"\n            }, {\n                status: 400\n            });\n        }\n        // If P12 and passphrase provided, use node-signpdf for true digital signature\n        if (p12File && p12Passphrase) {\n            const p12Buffer = Buffer.from(await p12File.arrayBuffer());\n            const signedPdf = await (0,_lib_pdf_signpdf__WEBPACK_IMPORTED_MODULE_5__.signPdfWithNodeSignpdf)(pdfBuffer, p12Buffer, p12Passphrase);\n            const signedPdfUint8 = new Uint8Array(signedPdf);\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(signedPdfUint8, {\n                headers: {\n                    \"Content-Type\": \"application/pdf\",\n                    \"Content-Disposition\": `attachment; filename=\\\"signed_${pdfFile.name}\\\"`\n                }\n            });\n        } else {\n            // Try to perform a proper PDF signature using server-stored PEM key + cert\n            try {\n                // Convert PEM private key and certificate to PKCS#12 (in-memory)\n                const privateKeyObj = node_forge__WEBPACK_IMPORTED_MODULE_6___default().pki.privateKeyFromPem(privateKey);\n                const certificateObj = node_forge__WEBPACK_IMPORTED_MODULE_6___default().pki.certificateFromPem(keys.certificate);\n                // Create PKCS#12 container without passphrase\n                const p12Asn1 = node_forge__WEBPACK_IMPORTED_MODULE_6___default().pkcs12.toPkcs12Asn1(privateKeyObj, [\n                    certificateObj\n                ], \"\");\n                const p12Der = node_forge__WEBPACK_IMPORTED_MODULE_6___default().asn1.toDer(p12Asn1).getBytes();\n                const p12Buffer = Buffer.from(p12Der, \"binary\");\n                // Sign using node-signpdf so signature dictionary (/ByteRange, /Contents) is added\n                const signedPdf = await (0,_lib_pdf_signpdf__WEBPACK_IMPORTED_MODULE_5__.signPdfWithNodeSignpdf)(pdfBuffer, p12Buffer, \"\");\n                const signedPdfUint8 = new Uint8Array(signedPdf);\n                return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(signedPdfUint8, {\n                    headers: {\n                        \"Content-Type\": \"application/pdf\",\n                        \"Content-Disposition\": `attachment; filename=\\\"signed_${pdfFile.name}\\\"`\n                    }\n                });\n            } catch (err) {\n                // Fallback: legacy metadata-only sign (if conversion or node-signpdf fails)\n                console.error(\"P12 conversion or node-signpdf signing failed:\", err);\n                const user = await _lib_db__WEBPACK_IMPORTED_MODULE_2__.userDb.findById(tokenPayload.userId);\n                const signerInfo = user ? {\n                    name: user.name || \"-\",\n                    position: user.position || \"-\",\n                    organizationName: user.organizationName || \"-\"\n                } : undefined;\n                const signedPdfBuffer = await (0,_lib_pdf_signer__WEBPACK_IMPORTED_MODULE_4__.signPDF)(pdfBuffer, privateKey, keys.certificate, signerInfo);\n                const signedPdfUint8 = new Uint8Array(signedPdfBuffer);\n                return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(signedPdfUint8, {\n                    headers: {\n                        \"Content-Type\": \"application/pdf\",\n                        \"Content-Disposition\": `attachment; filename=\\\"signed_${pdfFile.name}\\\"`\n                    }\n                });\n            }\n        }\n    } catch (error) {\n        console.error(\"Sign PDF error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to sign PDF: \" + error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0JBQ0VoQixNQUFNZ0IsS0FBS2hCLElBQUksSUFBSTtvQkFDbkJtQixVQUFVSCxLQUFLRyxRQUFRLElBQUk7b0JBQzNCQyxrQkFBa0JKLEtBQUtJLGdCQUFnQixJQUFJO2dCQUM3QyxJQUNBQztnQkFDSixNQUFNQyxrQkFBa0IsTUFBTWhFLHdEQUFPQSxDQUNuQytCLFdBQ0FGLFlBQ0FILEtBQUtzQixXQUFXLEVBQ2hCWTtnQkFFRixNQUFNckIsaUJBQWlCLElBQUlDLFdBQVd3QjtnQkFDdEMsT0FBTyxJQUFJckUscURBQVlBLENBQUM0QyxnQkFBZ0I7b0JBQ3RDRSxTQUFTO3dCQUNQLGdCQUFnQjt3QkFDaEIsdUJBQXVCLENBQUMsOEJBQThCLEVBQUV4QixRQUFReUIsSUFBSSxDQUFDLEVBQUUsQ0FBQztvQkFDMUU7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0YsRUFBRSxPQUFPN0IsT0FBTztRQUNkNEMsUUFBUTVDLEtBQUssQ0FBQyxtQkFBbUJBO1FBQ2pDLE9BQU9sQixxREFBWUEsQ0FBQ2lCLElBQUksQ0FDdEI7WUFBRUMsT0FBTyx5QkFBeUIsTUFBaUJvRCxPQUFPO1FBQUMsR0FDM0Q7WUFBRW5ELFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vLi9hcHAvYXBpL3BkZi9zaWduL3JvdXRlLnRzP2Y1M2EiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSBcIm5vZGVqc1wiO1xyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IGdldFVzZXJGcm9tUmVxdWVzdCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XHJcbmltcG9ydCB7IHVzZXJLZXlzRGIsIHVzZXJEYiB9IGZyb20gXCJAL2xpYi9kYlwiO1xyXG5pbXBvcnQgeyBkZWNyeXB0UHJpdmF0ZUtleSB9IGZyb20gXCJAL2xpYi9jcnlwdG9cIjtcclxuaW1wb3J0IHsgc2lnblBERiB9IGZyb20gXCJAL2xpYi9wZGYtc2lnbmVyXCI7XHJcbmltcG9ydCB7IHNpZ25QZGZXaXRoTm9kZVNpZ25wZGYgfSBmcm9tIFwiQC9saWIvcGRmLXNpZ25wZGZcIjtcclxuaW1wb3J0IGZvcmdlIGZyb20gXCJub2RlLWZvcmdlXCI7XHJcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XHJcblxyXG5jb25zdCBzaWduUERGU2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIHBhc3N3b3JkOiB6LnN0cmluZygpLm1pbig4KSxcclxufSk7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgdXNlciBmcm9tIHRva2VuXHJcbiAgICBjb25zdCB0b2tlblBheWxvYWQgPSBhd2FpdCBnZXRVc2VyRnJvbVJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICBpZiAoIXRva2VuUGF5bG9hZCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHVzZXIgaXMgb3JnYW5pemF0aW9uXHJcbiAgICBpZiAodG9rZW5QYXlsb2FkLnJvbGUgIT09IFwib3JnYW5pemF0aW9uXCIpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwiT25seSBvcmdhbml6YXRpb25zIGNhbiBzaWduIFBERiBkb2N1bWVudHNcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhcnNlIGZvcm0gZGF0YVxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKCk7XHJcbiAgICBjb25zdCBwZGZGaWxlID0gZm9ybURhdGEuZ2V0KFwicGRmXCIpIGFzIEZpbGU7XHJcbiAgICBjb25zdCBwYXNzd29yZCA9IGZvcm1EYXRhLmdldChcInBhc3N3b3JkXCIpIGFzIHN0cmluZztcclxuICAgIC8vIEZvciBub2RlLXNpZ25wZGY6IGFjY2VwdCBQS0NTIzEyIChQRlgpIGFuZCBwYXNzcGhyYXNlXHJcbiAgICBjb25zdCBwMTJGaWxlID0gZm9ybURhdGEuZ2V0KFwicDEyXCIpIGFzIEZpbGUgfCBudWxsO1xyXG4gICAgY29uc3QgcDEyUGFzc3BocmFzZSA9IGZvcm1EYXRhLmdldChcInAxMlBhc3NwaHJhc2VcIikgYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cclxuICAgIGlmICghcGRmRmlsZSB8fCAhcGFzc3dvcmQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwiUERGIGZpbGUgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZFwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgcGFzc3dvcmRcclxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBzaWduUERGU2NoZW1hLnNhZmVQYXJzZSh7IHBhc3N3b3JkIH0pO1xyXG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwiSW52YWxpZCBpbnB1dFwiLCBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmVycm9ycyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB1c2VyIGtleXNcclxuICAgIGNvbnN0IGtleXMgPSBhd2FpdCB1c2VyS2V5c0RiLmZpbmRCeVVzZXJJZCh0b2tlblBheWxvYWQudXNlcklkKTtcclxuICAgIGlmICgha2V5cykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogXCJLZXlzIG5vdCBmb3VuZC4gUGxlYXNlIGdlbmVyYXRlIGtleXMgZmlyc3QuXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWNyeXB0IHByaXZhdGUga2V5XHJcbiAgICBsZXQgcHJpdmF0ZUtleTogc3RyaW5nO1xyXG4gICAgdHJ5IHtcclxuICAgICAgcHJpdmF0ZUtleSA9IGRlY3J5cHRQcml2YXRlS2V5KGtleXMucHJpdmF0ZUtleUVuY3J5cHRlZCwgcGFzc3dvcmQpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiSW52YWxpZCBwYXNzd29yZFwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmVhZCBQREYgZmlsZVxyXG4gICAgY29uc3QgcGRmQnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgcGRmRmlsZS5hcnJheUJ1ZmZlcigpKTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBQREYgbWFnaWMgbnVtYmVyIChmaXJzdCA0IGJ5dGVzOiAlUERGKVxyXG4gICAgaWYgKHBkZkJ1ZmZlci5sZW5ndGggPCA0IHx8IHBkZkJ1ZmZlci50b1N0cmluZyhcInV0ZjhcIiwgMCwgNCkgIT09IFwiJVBERlwiKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiBcIlVwbG9hZGVkIGZpbGUgaXMgbm90IGEgdmFsaWQgUERGIGRvY3VtZW50LlwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgUDEyIGFuZCBwYXNzcGhyYXNlIHByb3ZpZGVkLCB1c2Ugbm9kZS1zaWducGRmIGZvciB0cnVlIGRpZ2l0YWwgc2lnbmF0dXJlXHJcbiAgICBpZiAocDEyRmlsZSAmJiBwMTJQYXNzcGhyYXNlKSB7XHJcbiAgICAgIGNvbnN0IHAxMkJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGF3YWl0IHAxMkZpbGUuYXJyYXlCdWZmZXIoKSk7XHJcbiAgICAgIGNvbnN0IHNpZ25lZFBkZiA9IGF3YWl0IHNpZ25QZGZXaXRoTm9kZVNpZ25wZGYoXHJcbiAgICAgICAgcGRmQnVmZmVyLFxyXG4gICAgICAgIHAxMkJ1ZmZlcixcclxuICAgICAgICBwMTJQYXNzcGhyYXNlXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IHNpZ25lZFBkZlVpbnQ4ID0gbmV3IFVpbnQ4QXJyYXkoc2lnbmVkUGRmKTtcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2Uoc2lnbmVkUGRmVWludDgsIHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3BkZlwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LURpc3Bvc2l0aW9uXCI6IGBhdHRhY2htZW50OyBmaWxlbmFtZT1cXFwic2lnbmVkXyR7cGRmRmlsZS5uYW1lfVxcXCJgLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gVHJ5IHRvIHBlcmZvcm0gYSBwcm9wZXIgUERGIHNpZ25hdHVyZSB1c2luZyBzZXJ2ZXItc3RvcmVkIFBFTSBrZXkgKyBjZXJ0XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQ29udmVydCBQRU0gcHJpdmF0ZSBrZXkgYW5kIGNlcnRpZmljYXRlIHRvIFBLQ1MjMTIgKGluLW1lbW9yeSlcclxuICAgICAgICBjb25zdCBwcml2YXRlS2V5T2JqID0gZm9yZ2UucGtpLnByaXZhdGVLZXlGcm9tUGVtKHByaXZhdGVLZXkpO1xyXG4gICAgICAgIGNvbnN0IGNlcnRpZmljYXRlT2JqID0gZm9yZ2UucGtpLmNlcnRpZmljYXRlRnJvbVBlbShrZXlzLmNlcnRpZmljYXRlKTtcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIFBLQ1MjMTIgY29udGFpbmVyIHdpdGhvdXQgcGFzc3BocmFzZVxyXG4gICAgICAgIGNvbnN0IHAxMkFzbjEgPSBmb3JnZS5wa2NzMTIudG9Qa2NzMTJBc24xKHByaXZhdGVLZXlPYmosIFtjZXJ0aWZpY2F0ZU9ial0sIFwiXCIpO1xyXG4gICAgICAgIGNvbnN0IHAxMkRlciA9IGZvcmdlLmFzbjEudG9EZXIocDEyQXNuMSkuZ2V0Qnl0ZXMoKTtcclxuICAgICAgICBjb25zdCBwMTJCdWZmZXIgPSBCdWZmZXIuZnJvbShwMTJEZXIsIFwiYmluYXJ5XCIpO1xyXG5cclxuICAgICAgICAvLyBTaWduIHVzaW5nIG5vZGUtc2lnbnBkZiBzbyBzaWduYXR1cmUgZGljdGlvbmFyeSAoL0J5dGVSYW5nZSwgL0NvbnRlbnRzKSBpcyBhZGRlZFxyXG4gICAgICAgIGNvbnN0IHNpZ25lZFBkZiA9IGF3YWl0IHNpZ25QZGZXaXRoTm9kZVNpZ25wZGYocGRmQnVmZmVyLCBwMTJCdWZmZXIsIFwiXCIpO1xyXG4gICAgICAgIGNvbnN0IHNpZ25lZFBkZlVpbnQ4ID0gbmV3IFVpbnQ4QXJyYXkoc2lnbmVkUGRmKTtcclxuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShzaWduZWRQZGZVaW50OCwge1xyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3BkZlwiLFxyXG4gICAgICAgICAgICBcIkNvbnRlbnQtRGlzcG9zaXRpb25cIjogYGF0dGFjaG1lbnQ7IGZpbGVuYW1lPVxcXCJzaWduZWRfJHtwZGZGaWxlLm5hbWV9XFxcImAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAvLyBGYWxsYmFjazogbGVnYWN5IG1ldGFkYXRhLW9ubHkgc2lnbiAoaWYgY29udmVyc2lvbiBvciBub2RlLXNpZ25wZGYgZmFpbHMpXHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlAxMiBjb252ZXJzaW9uIG9yIG5vZGUtc2lnbnBkZiBzaWduaW5nIGZhaWxlZDpcIiwgZXJyKTtcclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXNlckRiLmZpbmRCeUlkKHRva2VuUGF5bG9hZC51c2VySWQpO1xyXG4gICAgICAgIGNvbnN0IHNpZ25lckluZm8gPSB1c2VyXHJcbiAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUgfHwgXCItXCIsXHJcbiAgICAgICAgICAgICAgcG9zaXRpb246IHVzZXIucG9zaXRpb24gfHwgXCItXCIsXHJcbiAgICAgICAgICAgICAgb3JnYW5pemF0aW9uTmFtZTogdXNlci5vcmdhbml6YXRpb25OYW1lIHx8IFwiLVwiLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBzaWduZWRQZGZCdWZmZXIgPSBhd2FpdCBzaWduUERGKFxyXG4gICAgICAgICAgcGRmQnVmZmVyLFxyXG4gICAgICAgICAgcHJpdmF0ZUtleSxcclxuICAgICAgICAgIGtleXMuY2VydGlmaWNhdGUsXHJcbiAgICAgICAgICBzaWduZXJJbmZvXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBzaWduZWRQZGZVaW50OCA9IG5ldyBVaW50OEFycmF5KHNpZ25lZFBkZkJ1ZmZlcik7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2Uoc2lnbmVkUGRmVWludDgsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9wZGZcIixcclxuICAgICAgICAgICAgXCJDb250ZW50LURpc3Bvc2l0aW9uXCI6IGBhdHRhY2htZW50OyBmaWxlbmFtZT1cXFwic2lnbmVkXyR7cGRmRmlsZS5uYW1lfVxcXCJgLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiU2lnbiBQREYgZXJyb3I6XCIsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogXCJGYWlsZWQgdG8gc2lnbiBQREY6IFwiICsgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbInJ1bnRpbWUiLCJOZXh0UmVzcG9uc2UiLCJnZXRVc2VyRnJvbVJlcXVlc3QiLCJ1c2VyS2V5c0RiIiwidXNlckRiIiwiZGVjcnlwdFByaXZhdGVLZXkiLCJzaWduUERGIiwic2lnblBkZldpdGhOb2RlU2lnbnBkZiIsImZvcmdlIiwieiIsInNpZ25QREZTY2hlbWEiLCJvYmplY3QiLCJwYXNzd29yZCIsInN0cmluZyIsIm1pbiIsIlBPU1QiLCJyZXF1ZXN0IiwidG9rZW5QYXlsb2FkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwicm9sZSIsImZvcm1EYXRhIiwicGRmRmlsZSIsImdldCIsInAxMkZpbGUiLCJwMTJQYXNzcGhyYXNlIiwidmFsaWRhdGlvbiIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJkZXRhaWxzIiwiZXJyb3JzIiwia2V5cyIsImZpbmRCeVVzZXJJZCIsInVzZXJJZCIsInByaXZhdGVLZXkiLCJwcml2YXRlS2V5RW5jcnlwdGVkIiwicGRmQnVmZmVyIiwiQnVmZmVyIiwiZnJvbSIsImFycmF5QnVmZmVyIiwibGVuZ3RoIiwidG9TdHJpbmciLCJwMTJCdWZmZXIiLCJzaWduZWRQZGYiLCJzaWduZWRQZGZVaW50OCIsIlVpbnQ4QXJyYXkiLCJoZWFkZXJzIiwibmFtZSIsInByaXZhdGVLZXlPYmoiLCJwa2kiLCJwcml2YXRlS2V5RnJvbVBlbSIsImNlcnRpZmljYXRlT2JqIiwiY2VydGlmaWNhdGVGcm9tUGVtIiwiY2VydGlmaWNhdGUiLCJwMTJBc24xIiwicGtjczEyIiwidG9Qa2NzMTJBc24xIiwicDEyRGVyIiwiYXNuMSIsInRvRGVyIiwiZ2V0Qnl0ZXMiLCJlcnIiLCJjb25zb2xlIiwidXNlciIsImZpbmRCeUlkIiwic2lnbmVySW5mbyIsInBvc2l0aW9uIiwib3JnYW5pemF0aW9uTmFtZSIsInVuZGVmaW5lZCIsInNpZ25lZFBkZkJ1ZmZlciIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/pdf/sign/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractTokenFromHeader: () => (/* binding */ extractTokenFromHeader),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getUserFromRequest: () => (/* binding */ getUserFromRequest),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\";\nconst JWT_EXPIRES_IN = \"7d\";\n/**\r\n * Generate JWT token for user\r\n */ function generateToken(user) {\n    const payload = {\n        userId: user.id,\n        email: user.email,\n        role: user.role\n    };\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign(payload, JWT_SECRET, {\n        expiresIn: JWT_EXPIRES_IN\n    });\n}\n/**\r\n * Verify and decode JWT token\r\n */ function verifyToken(token) {\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, JWT_SECRET);\n        return decoded;\n    } catch (error) {\n        return null;\n    }\n}\n/**\r\n * Extract token from Authorization header\r\n */ function extractTokenFromHeader(authHeader) {\n    if (!authHeader) return null;\n    const parts = authHeader.split(\" \");\n    if (parts.length !== 2 || parts[0] !== \"Bearer\") {\n        return null;\n    }\n    return parts[1];\n}\n/**\r\n * Get user from request (Next.js API route)\r\n */ async function getUserFromRequest(request) {\n    const authHeader = request.headers.get(\"Authorization\");\n    const token = extractTokenFromHeader(authHeader);\n    if (!token) return null;\n    return verifyToken(token);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBK0I7QUFHL0IsTUFBTUMsYUFDSkMsUUFBUUMsR0FBRyxDQUFDRixVQUFVLElBQUk7QUFDNUIsTUFBTUcsaUJBQWlCO0FBUXZCOztDQUVDLEdBQ00sU0FBU0MsY0FBY0MsSUFBVTtJQUN0QyxNQUFNQyxVQUFzQjtRQUMxQkMsUUFBUUYsS0FBS0csRUFBRTtRQUNmQyxPQUFPSixLQUFLSSxLQUFLO1FBQ2pCQyxNQUFNTCxLQUFLSyxJQUFJO0lBQ2pCO0lBRUEsT0FBT1gsd0RBQVEsQ0FBQ08sU0FBU04sWUFBWTtRQUNuQ1ksV0FBV1Q7SUFDYjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTVSxZQUFZQyxLQUFhO0lBQ3ZDLElBQUk7UUFDRixNQUFNQyxVQUFVaEIsMERBQVUsQ0FBQ2UsT0FBT2Q7UUFDbEMsT0FBT2U7SUFDVCxFQUFFLE9BQU9FLE9BQU87UUFDZCxPQUFPO0lBQ1Q7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0MsdUJBQ2RDLFVBQXlCO0lBRXpCLElBQUksQ0FBQ0EsWUFBWSxPQUFPO0lBRXhCLE1BQU1DLFFBQVFELFdBQVdFLEtBQUssQ0FBQztJQUMvQixJQUFJRCxNQUFNRSxNQUFNLEtBQUssS0FBS0YsS0FBSyxDQUFDLEVBQUUsS0FBSyxVQUFVO1FBQy9DLE9BQU87SUFDVDtJQUVBLE9BQU9BLEtBQUssQ0FBQyxFQUFFO0FBQ2pCO0FBRUE7O0NBRUMsR0FDTSxlQUFlRyxtQkFDcEJDLE9BQWdCO0lBRWhCLE1BQU1MLGFBQWFLLFFBQVFDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBQ3ZDLE1BQU1aLFFBQVFJLHVCQUF1QkM7SUFFckMsSUFBSSxDQUFDTCxPQUFPLE9BQU87SUFFbkIsT0FBT0QsWUFBWUM7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGYtc2lnbmF0dXJlLXN5c3RlbS8uL2xpYi9hdXRoLnRzP2JmN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiQC90eXBlc1wiO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9XHJcbiAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCBcInlvdXItc2VjcmV0LWtleS1jaGFuZ2UtaW4tcHJvZHVjdGlvblwiO1xyXG5jb25zdCBKV1RfRVhQSVJFU19JTiA9IFwiN2RcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSldUUGF5bG9hZCB7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICByb2xlOiBcIm9yZ2FuaXphdGlvblwiIHwgXCJjb25zdWx0YW50XCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBKV1QgdG9rZW4gZm9yIHVzZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKHVzZXI6IFVzZXIpOiBzdHJpbmcge1xyXG4gIGNvbnN0IHBheWxvYWQ6IEpXVFBheWxvYWQgPSB7XHJcbiAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgIHJvbGU6IHVzZXIucm9sZSxcclxuICB9O1xyXG5cclxuICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgSldUX1NFQ1JFVCwge1xyXG4gICAgZXhwaXJlc0luOiBKV1RfRVhQSVJFU19JTixcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBhbmQgZGVjb2RlIEpXVCB0b2tlblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuOiBzdHJpbmcpOiBKV1RQYXlsb2FkIHwgbnVsbCB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKSBhcyBKV1RQYXlsb2FkO1xyXG4gICAgcmV0dXJuIGRlY29kZWQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgdG9rZW4gZnJvbSBBdXRob3JpemF0aW9uIGhlYWRlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUb2tlbkZyb21IZWFkZXIoXHJcbiAgYXV0aEhlYWRlcjogc3RyaW5nIHwgbnVsbFxyXG4pOiBzdHJpbmcgfCBudWxsIHtcclxuICBpZiAoIWF1dGhIZWFkZXIpIHJldHVybiBudWxsO1xyXG5cclxuICBjb25zdCBwYXJ0cyA9IGF1dGhIZWFkZXIuc3BsaXQoXCIgXCIpO1xyXG4gIGlmIChwYXJ0cy5sZW5ndGggIT09IDIgfHwgcGFydHNbMF0gIT09IFwiQmVhcmVyXCIpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHBhcnRzWzFdO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IHVzZXIgZnJvbSByZXF1ZXN0IChOZXh0LmpzIEFQSSByb3V0ZSlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyRnJvbVJlcXVlc3QoXHJcbiAgcmVxdWVzdDogUmVxdWVzdFxyXG4pOiBQcm9taXNlPEpXVFBheWxvYWQgfCBudWxsPiB7XHJcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJBdXRob3JpemF0aW9uXCIpO1xyXG4gIGNvbnN0IHRva2VuID0gZXh0cmFjdFRva2VuRnJvbUhlYWRlcihhdXRoSGVhZGVyKTtcclxuXHJcbiAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XHJcblxyXG4gIHJldHVybiB2ZXJpZnlUb2tlbih0b2tlbik7XHJcbn1cclxuIl0sIm5hbWVzIjpbImp3dCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiSldUX0VYUElSRVNfSU4iLCJnZW5lcmF0ZVRva2VuIiwidXNlciIsInBheWxvYWQiLCJ1c2VySWQiLCJpZCIsImVtYWlsIiwicm9sZSIsInNpZ24iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsImVycm9yIiwiZXh0cmFjdFRva2VuRnJvbUhlYWRlciIsImF1dGhIZWFkZXIiLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwiZ2V0VXNlckZyb21SZXF1ZXN0IiwicmVxdWVzdCIsImhlYWRlcnMiLCJnZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/barcode-util.ts":
/*!*****************************!*\
  !*** ./lib/barcode-util.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   embedBarcodeToPDF: () => (/* binding */ embedBarcodeToPDF),\n/* harmony export */   generateBarcodePNG: () => (/* binding */ generateBarcodePNG)\n/* harmony export */ });\n/* harmony import */ var bwip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bwip-js */ \"(rsc)/./node_modules/bwip-js/dist/bwip-js-node.mjs\");\n\n/**\r\n * Generate Code128 barcode as PNG buffer\r\n */ async function generateBarcodePNG(data) {\n    return await new Promise((resolve, reject)=>{\n        bwip_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].toBuffer({\n            bcid: \"code128\",\n            text: data,\n            scale: 3,\n            height: 20,\n            includetext: true,\n            textxalign: \"center\",\n            backgroundcolor: \"FFFFFF\"\n        }, (err, png)=>{\n            if (err) reject(err);\n            else resolve(png);\n        });\n    });\n}\n/**\r\n * Embed barcode PNG into PDF at given position\r\n */ async function embedBarcodeToPDF(pdfDoc, pngBuffer, x, y, width, height) {\n    const pngImage = await pdfDoc.embedPng(pngBuffer);\n    const page = pdfDoc.getPages()[0];\n    page.drawImage(pngImage, {\n        x,\n        y,\n        width,\n        height\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYmFyY29kZS11dGlsLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QjtBQUc3Qjs7Q0FFQyxHQUNNLGVBQWVDLG1CQUFtQkMsSUFBWTtJQUNuRCxPQUFPLE1BQU0sSUFBSUMsUUFBUSxDQUFDQyxTQUFTQztRQUNqQ0wsd0RBQWUsQ0FDYjtZQUNFTyxNQUFNO1lBQ05DLE1BQU1OO1lBQ05PLE9BQU87WUFDUEMsUUFBUTtZQUNSQyxhQUFhO1lBQ2JDLFlBQVk7WUFDWkMsaUJBQWlCO1FBQ25CLEdBQ0EsQ0FBQ0MsS0FBVUM7WUFDVCxJQUFJRCxLQUFLVCxPQUFPUztpQkFDWFYsUUFBUVc7UUFDZjtJQUVKO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLGtCQUNwQkMsTUFBbUIsRUFDbkJDLFNBQWlCLEVBQ2pCQyxDQUFTLEVBQ1RDLENBQVMsRUFDVEMsS0FBYSxFQUNiWCxNQUFjO0lBRWQsTUFBTVksV0FBVyxNQUFNTCxPQUFPTSxRQUFRLENBQUNMO0lBQ3ZDLE1BQU1NLE9BQU9QLE9BQU9RLFFBQVEsRUFBRSxDQUFDLEVBQUU7SUFDakNELEtBQUtFLFNBQVMsQ0FBQ0osVUFBVTtRQUN2Qkg7UUFDQUM7UUFDQUM7UUFDQVg7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vLi9saWIvYmFyY29kZS11dGlsLnRzPzEwYjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJ3aXBqcyBmcm9tIFwiYndpcC1qc1wiO1xyXG5pbXBvcnQgeyBQREZEb2N1bWVudCB9IGZyb20gXCJwZGYtbGliXCI7XHJcblxyXG4vKipcclxuICogR2VuZXJhdGUgQ29kZTEyOCBiYXJjb2RlIGFzIFBORyBidWZmZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUJhcmNvZGVQTkcoZGF0YTogc3RyaW5nKTogUHJvbWlzZTxCdWZmZXI+IHtcclxuICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgYndpcGpzLnRvQnVmZmVyKFxyXG4gICAgICB7XHJcbiAgICAgICAgYmNpZDogXCJjb2RlMTI4XCIsIC8vIEJhcmNvZGUgdHlwZVxyXG4gICAgICAgIHRleHQ6IGRhdGEsXHJcbiAgICAgICAgc2NhbGU6IDMsIC8vIDN4IHNjYWxpbmdcclxuICAgICAgICBoZWlnaHQ6IDIwLCAvLyBiYXIgaGVpZ2h0LCBpbiBtaWxsaW1ldGVyc1xyXG4gICAgICAgIGluY2x1ZGV0ZXh0OiB0cnVlLCAvLyBTaG93IHRleHQgYmVsb3cgYmFyY29kZVxyXG4gICAgICAgIHRleHR4YWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICAgICAgYmFja2dyb3VuZGNvbG9yOiBcIkZGRkZGRlwiLFxyXG4gICAgICB9LFxyXG4gICAgICAoZXJyOiBhbnksIHBuZzogQnVmZmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XHJcbiAgICAgICAgZWxzZSByZXNvbHZlKHBuZyk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWJlZCBiYXJjb2RlIFBORyBpbnRvIFBERiBhdCBnaXZlbiBwb3NpdGlvblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVtYmVkQmFyY29kZVRvUERGKFxyXG4gIHBkZkRvYzogUERGRG9jdW1lbnQsXHJcbiAgcG5nQnVmZmVyOiBCdWZmZXIsXHJcbiAgeDogbnVtYmVyLFxyXG4gIHk6IG51bWJlcixcclxuICB3aWR0aDogbnVtYmVyLFxyXG4gIGhlaWdodDogbnVtYmVyXHJcbikge1xyXG4gIGNvbnN0IHBuZ0ltYWdlID0gYXdhaXQgcGRmRG9jLmVtYmVkUG5nKHBuZ0J1ZmZlcik7XHJcbiAgY29uc3QgcGFnZSA9IHBkZkRvYy5nZXRQYWdlcygpWzBdO1xyXG4gIHBhZ2UuZHJhd0ltYWdlKHBuZ0ltYWdlLCB7XHJcbiAgICB4LFxyXG4gICAgeSxcclxuICAgIHdpZHRoLFxyXG4gICAgaGVpZ2h0LFxyXG4gIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJid2lwanMiLCJnZW5lcmF0ZUJhcmNvZGVQTkciLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ0b0J1ZmZlciIsImJjaWQiLCJ0ZXh0Iiwic2NhbGUiLCJoZWlnaHQiLCJpbmNsdWRldGV4dCIsInRleHR4YWxpZ24iLCJiYWNrZ3JvdW5kY29sb3IiLCJlcnIiLCJwbmciLCJlbWJlZEJhcmNvZGVUb1BERiIsInBkZkRvYyIsInBuZ0J1ZmZlciIsIngiLCJ5Iiwid2lkdGgiLCJwbmdJbWFnZSIsImVtYmVkUG5nIiwicGFnZSIsImdldFBhZ2VzIiwiZHJhd0ltYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/barcode-util.ts\n");

/***/ }),

/***/ "(rsc)/./lib/crypto.ts":
/*!***********************!*\
  !*** ./lib/crypto.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decryptPrivateKey: () => (/* binding */ decryptPrivateKey),\n/* harmony export */   encryptPrivateKey: () => (/* binding */ encryptPrivateKey),\n/* harmony export */   generateKeyPairAndCertificate: () => (/* binding */ generateKeyPairAndCertificate),\n/* harmony export */   isCertificateValid: () => (/* binding */ isCertificateValid),\n/* harmony export */   parseCertificate: () => (/* binding */ parseCertificate)\n/* harmony export */ });\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node-forge */ \"node-forge\");\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_forge__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\r\n * Generate RSA 2048-bit key pair and self-signed X.509 certificate\r\n */ async function generateKeyPairAndCertificate(userInfo) {\n    return new Promise((resolve, reject)=>{\n        try {\n            // Generate RSA key pair (2048 bits)\n            const keys = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.rsa.generateKeyPair(2048);\n            // Create certificate\n            const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.createCertificate();\n            cert.publicKey = keys.publicKey;\n            cert.serialNumber = \"01\" + Math.floor(Math.random() * 1000000).toString();\n            // Set validity period (1 year)\n            cert.validity.notBefore = new Date();\n            cert.validity.notAfter = new Date();\n            cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 1);\n            // Set certificate attributes\n            const attrs = [\n                {\n                    name: \"commonName\",\n                    value: userInfo.commonName\n                },\n                {\n                    name: \"countryName\",\n                    value: \"ID\"\n                },\n                {\n                    shortName: \"ST\",\n                    value: \"Indonesia\"\n                },\n                {\n                    name: \"localityName\",\n                    value: \"Jakarta\"\n                },\n                {\n                    name: \"organizationName\",\n                    value: userInfo.organizationName || \"Self-Signed\"\n                },\n                {\n                    shortName: \"OU\",\n                    value: \"Digital Signature\"\n                },\n                {\n                    name: \"emailAddress\",\n                    value: userInfo.email\n                }\n            ];\n            cert.setSubject(attrs);\n            cert.setIssuer(attrs); // Self-signed\n            // Add extensions\n            cert.setExtensions([\n                {\n                    name: \"basicConstraints\",\n                    cA: false\n                },\n                {\n                    name: \"keyUsage\",\n                    digitalSignature: true,\n                    nonRepudiation: true,\n                    keyEncipherment: true\n                },\n                {\n                    name: \"extKeyUsage\",\n                    serverAuth: false,\n                    clientAuth: false,\n                    codeSigning: false,\n                    emailProtection: true\n                }\n            ]);\n            // Self-sign certificate\n            cert.sign(keys.privateKey, node_forge__WEBPACK_IMPORTED_MODULE_0___default().md.sha256.create());\n            // Convert to PEM format\n            const publicKeyPem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.publicKeyToPem(keys.publicKey);\n            const privateKeyPem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.privateKeyToPem(keys.privateKey);\n            const certificatePem = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateToPem(cert);\n            resolve({\n                publicKey: publicKeyPem,\n                privateKey: privateKeyPem,\n                certificate: certificatePem\n            });\n        } catch (error) {\n            reject(error);\n        }\n    });\n}\n/**\r\n * Encrypt private key using AES-256-GCM with password\r\n */ function encryptPrivateKey(privateKeyPem, password) {\n    try {\n        // Derive key from password using PBKDF2\n        const salt = node_forge__WEBPACK_IMPORTED_MODULE_0___default().random.getBytesSync(32);\n        const derivedKey = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pkcs5.pbkdf2(password, salt, 100000, 32);\n        // Generate IV for AES-GCM\n        const iv = node_forge__WEBPACK_IMPORTED_MODULE_0___default().random.getBytesSync(12);\n        // Encrypt using AES-256-GCM\n        const cipher = node_forge__WEBPACK_IMPORTED_MODULE_0___default().cipher.createCipher(\"AES-GCM\", derivedKey);\n        cipher.start({\n            iv: iv\n        });\n        cipher.update(node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(privateKeyPem, \"utf8\"));\n        cipher.finish();\n        const encrypted = cipher.output.bytes();\n        const tag = cipher.mode.tag.bytes();\n        // Combine salt + iv + tag + encrypted data\n        const combined = salt + iv + tag + encrypted;\n        // Return as base64\n        return node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.encode64(combined);\n    } catch (error) {\n        throw new Error(\"Failed to encrypt private key: \" + error.message);\n    }\n}\n/**\r\n * Decrypt private key using password\r\n */ function decryptPrivateKey(encryptedData, password) {\n    try {\n        // Decode from base64\n        const combined = node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.decode64(encryptedData);\n        // Extract components\n        const salt = combined.slice(0, 32);\n        const iv = combined.slice(32, 44);\n        const tag = combined.slice(44, 60);\n        const encrypted = combined.slice(60);\n        // Derive key from password\n        const derivedKey = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pkcs5.pbkdf2(password, salt, 100000, 32);\n        // Decrypt using AES-256-GCM\n        const decipher = node_forge__WEBPACK_IMPORTED_MODULE_0___default().cipher.createDecipher(\"AES-GCM\", derivedKey);\n        decipher.start({\n            iv: iv,\n            tag: node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(tag)\n        });\n        decipher.update(node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(encrypted));\n        const success = decipher.finish();\n        if (!success) {\n            throw new Error(\"Authentication failed - incorrect password or corrupted data\");\n        }\n        return decipher.output.toString();\n    } catch (error) {\n        throw new Error(\"Failed to decrypt private key: \" + error.message);\n    }\n}\n/**\r\n * Parse certificate and extract information\r\n */ function parseCertificate(certificatePem) {\n    try {\n        const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        const getAttributeValue = (attrs, name)=>{\n            const attr = attrs.find((a)=>a.name === name || a.shortName === name);\n            return attr ? attr.value : \"\";\n        };\n        return {\n            subject: cert.subject.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            issuer: cert.issuer.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            validFrom: cert.validity.notBefore,\n            validTo: cert.validity.notAfter,\n            serialNumber: cert.serialNumber,\n            algorithm: \"RSA with SHA-256\"\n        };\n    } catch (error) {\n        throw new Error(\"Failed to parse certificate: \" + error.message);\n    }\n}\n/**\r\n * Verify if certificate is still valid\r\n */ function isCertificateValid(certificatePem) {\n    try {\n        const cert = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        const now = new Date();\n        return now >= cert.validity.notBefore && now <= cert.validity.notAfter;\n    } catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S1EsUUFBUSxDQUFDRyxRQUFRO1lBQy9CUixjQUFjSCxLQUFLRyxZQUFZO1lBQy9Cc0YsV0FBVztRQUNiO0lBQ0YsRUFBRSxPQUFPN0MsT0FBTztRQUNkLE1BQU0sSUFBSXVCLE1BQU0sa0NBQWtDLE1BQWlCQyxPQUFPO0lBQzVFO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNzQixtQkFBbUJqRCxjQUFzQjtJQUN2RCxJQUFJO1FBQ0YsTUFBTXpDLE9BQU9WLHFEQUFTLENBQUN1RixrQkFBa0IsQ0FBQ3BDO1FBQzFDLE1BQU1rRCxNQUFNLElBQUlqRjtRQUNoQixPQUFPaUYsT0FBTzNGLEtBQUtRLFFBQVEsQ0FBQ0MsU0FBUyxJQUFJa0YsT0FBTzNGLEtBQUtRLFFBQVEsQ0FBQ0csUUFBUTtJQUN4RSxFQUFFLE9BQU9pQyxPQUFPO1FBQ2QsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGYtc2lnbmF0dXJlLXN5c3RlbS8uL2xpYi9jcnlwdG8udHM/OTI1YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZm9yZ2UgZnJvbSBcIm5vZGUtZm9yZ2VcIjtcclxuaW1wb3J0IHsgS2V5UGFpckluZm8sIENlcnRpZmljYXRlSW5mbyB9IGZyb20gXCJAL3R5cGVzXCI7XHJcblxyXG4vKipcclxuICogR2VuZXJhdGUgUlNBIDIwNDgtYml0IGtleSBwYWlyIGFuZCBzZWxmLXNpZ25lZCBYLjUwOSBjZXJ0aWZpY2F0ZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlKHVzZXJJbmZvOiB7XHJcbiAgY29tbW9uTmFtZTogc3RyaW5nO1xyXG4gIG9yZ2FuaXphdGlvbk5hbWU/OiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxufSk6IFByb21pc2U8S2V5UGFpckluZm8+IHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gR2VuZXJhdGUgUlNBIGtleSBwYWlyICgyMDQ4IGJpdHMpXHJcbiAgICAgIGNvbnN0IGtleXMgPSBmb3JnZS5wa2kucnNhLmdlbmVyYXRlS2V5UGFpcigyMDQ4KTtcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBjZXJ0aWZpY2F0ZVxyXG4gICAgICBjb25zdCBjZXJ0ID0gZm9yZ2UucGtpLmNyZWF0ZUNlcnRpZmljYXRlKCk7XHJcbiAgICAgIGNlcnQucHVibGljS2V5ID0ga2V5cy5wdWJsaWNLZXk7XHJcbiAgICAgIGNlcnQuc2VyaWFsTnVtYmVyID0gXCIwMVwiICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMCkudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgIC8vIFNldCB2YWxpZGl0eSBwZXJpb2QgKDEgeWVhcilcclxuICAgICAgY2VydC52YWxpZGl0eS5ub3RCZWZvcmUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICBjZXJ0LnZhbGlkaXR5Lm5vdEFmdGVyID0gbmV3IERhdGUoKTtcclxuICAgICAgY2VydC52YWxpZGl0eS5ub3RBZnRlci5zZXRGdWxsWWVhcihcclxuICAgICAgICBjZXJ0LnZhbGlkaXR5Lm5vdEJlZm9yZS5nZXRGdWxsWWVhcigpICsgMVxyXG4gICAgICApO1xyXG5cclxuICAgICAgLy8gU2V0IGNlcnRpZmljYXRlIGF0dHJpYnV0ZXNcclxuICAgICAgY29uc3QgYXR0cnMgPSBbXHJcbiAgICAgICAgeyBuYW1lOiBcImNvbW1vbk5hbWVcIiwgdmFsdWU6IHVzZXJJbmZvLmNvbW1vbk5hbWUgfSxcclxuICAgICAgICB7IG5hbWU6IFwiY291bnRyeU5hbWVcIiwgdmFsdWU6IFwiSURcIiB9LFxyXG4gICAgICAgIHsgc2hvcnROYW1lOiBcIlNUXCIsIHZhbHVlOiBcIkluZG9uZXNpYVwiIH0sXHJcbiAgICAgICAgeyBuYW1lOiBcImxvY2FsaXR5TmFtZVwiLCB2YWx1ZTogXCJKYWthcnRhXCIgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBuYW1lOiBcIm9yZ2FuaXphdGlvbk5hbWVcIixcclxuICAgICAgICAgIHZhbHVlOiB1c2VySW5mby5vcmdhbml6YXRpb25OYW1lIHx8IFwiU2VsZi1TaWduZWRcIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgc2hvcnROYW1lOiBcIk9VXCIsIHZhbHVlOiBcIkRpZ2l0YWwgU2lnbmF0dXJlXCIgfSxcclxuICAgICAgICB7IG5hbWU6IFwiZW1haWxBZGRyZXNzXCIsIHZhbHVlOiB1c2VySW5mby5lbWFpbCB9LFxyXG4gICAgICBdO1xyXG5cclxuICAgICAgY2VydC5zZXRTdWJqZWN0KGF0dHJzKTtcclxuICAgICAgY2VydC5zZXRJc3N1ZXIoYXR0cnMpOyAvLyBTZWxmLXNpZ25lZFxyXG5cclxuICAgICAgLy8gQWRkIGV4dGVuc2lvbnNcclxuICAgICAgY2VydC5zZXRFeHRlbnNpb25zKFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBuYW1lOiBcImJhc2ljQ29uc3RyYWludHNcIixcclxuICAgICAgICAgIGNBOiBmYWxzZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IFwia2V5VXNhZ2VcIixcclxuICAgICAgICAgIGRpZ2l0YWxTaWduYXR1cmU6IHRydWUsXHJcbiAgICAgICAgICBub25SZXB1ZGlhdGlvbjogdHJ1ZSxcclxuICAgICAgICAgIGtleUVuY2lwaGVybWVudDogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IFwiZXh0S2V5VXNhZ2VcIixcclxuICAgICAgICAgIHNlcnZlckF1dGg6IGZhbHNlLFxyXG4gICAgICAgICAgY2xpZW50QXV0aDogZmFsc2UsXHJcbiAgICAgICAgICBjb2RlU2lnbmluZzogZmFsc2UsXHJcbiAgICAgICAgICBlbWFpbFByb3RlY3Rpb246IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSk7XHJcblxyXG4gICAgICAvLyBTZWxmLXNpZ24gY2VydGlmaWNhdGVcclxuICAgICAgY2VydC5zaWduKGtleXMucHJpdmF0ZUtleSwgZm9yZ2UubWQuc2hhMjU2LmNyZWF0ZSgpKTtcclxuXHJcbiAgICAgIC8vIENvbnZlcnQgdG8gUEVNIGZvcm1hdFxyXG4gICAgICBjb25zdCBwdWJsaWNLZXlQZW0gPSBmb3JnZS5wa2kucHVibGljS2V5VG9QZW0oa2V5cy5wdWJsaWNLZXkpO1xyXG4gICAgICBjb25zdCBwcml2YXRlS2V5UGVtID0gZm9yZ2UucGtpLnByaXZhdGVLZXlUb1BlbShrZXlzLnByaXZhdGVLZXkpO1xyXG4gICAgICBjb25zdCBjZXJ0aWZpY2F0ZVBlbSA9IGZvcmdlLnBraS5jZXJ0aWZpY2F0ZVRvUGVtKGNlcnQpO1xyXG5cclxuICAgICAgcmVzb2x2ZSh7XHJcbiAgICAgICAgcHVibGljS2V5OiBwdWJsaWNLZXlQZW0sXHJcbiAgICAgICAgcHJpdmF0ZUtleTogcHJpdmF0ZUtleVBlbSxcclxuICAgICAgICBjZXJ0aWZpY2F0ZTogY2VydGlmaWNhdGVQZW0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuY3J5cHQgcHJpdmF0ZSBrZXkgdXNpbmcgQUVTLTI1Ni1HQ00gd2l0aCBwYXNzd29yZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGVuY3J5cHRQcml2YXRlS2V5KFxyXG4gIHByaXZhdGVLZXlQZW06IHN0cmluZyxcclxuICBwYXNzd29yZDogc3RyaW5nXHJcbik6IHN0cmluZyB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIERlcml2ZSBrZXkgZnJvbSBwYXNzd29yZCB1c2luZyBQQktERjJcclxuICAgIGNvbnN0IHNhbHQgPSBmb3JnZS5yYW5kb20uZ2V0Qnl0ZXNTeW5jKDMyKTtcclxuICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBmb3JnZS5wa2NzNS5wYmtkZjIocGFzc3dvcmQsIHNhbHQsIDEwMDAwMCwgMzIpO1xyXG5cclxuICAgIC8vIEdlbmVyYXRlIElWIGZvciBBRVMtR0NNXHJcbiAgICBjb25zdCBpdiA9IGZvcmdlLnJhbmRvbS5nZXRCeXRlc1N5bmMoMTIpO1xyXG5cclxuICAgIC8vIEVuY3J5cHQgdXNpbmcgQUVTLTI1Ni1HQ01cclxuICAgIGNvbnN0IGNpcGhlciA9IGZvcmdlLmNpcGhlci5jcmVhdGVDaXBoZXIoXCJBRVMtR0NNXCIsIGRlcml2ZWRLZXkpO1xyXG4gICAgY2lwaGVyLnN0YXJ0KHsgaXY6IGl2IH0pO1xyXG4gICAgY2lwaGVyLnVwZGF0ZShmb3JnZS51dGlsLmNyZWF0ZUJ1ZmZlcihwcml2YXRlS2V5UGVtLCBcInV0ZjhcIikpO1xyXG4gICAgY2lwaGVyLmZpbmlzaCgpO1xyXG5cclxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGNpcGhlci5vdXRwdXQuYnl0ZXMoKTtcclxuICAgIGNvbnN0IHRhZyA9IChjaXBoZXIubW9kZSBhcyBhbnkpLnRhZy5ieXRlcygpO1xyXG5cclxuICAgIC8vIENvbWJpbmUgc2FsdCArIGl2ICsgdGFnICsgZW5jcnlwdGVkIGRhdGFcclxuICAgIGNvbnN0IGNvbWJpbmVkID0gc2FsdCArIGl2ICsgdGFnICsgZW5jcnlwdGVkO1xyXG5cclxuICAgIC8vIFJldHVybiBhcyBiYXNlNjRcclxuICAgIHJldHVybiBmb3JnZS51dGlsLmVuY29kZTY0KGNvbWJpbmVkKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICBcIkZhaWxlZCB0byBlbmNyeXB0IHByaXZhdGUga2V5OiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWNyeXB0IHByaXZhdGUga2V5IHVzaW5nIHBhc3N3b3JkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGVjcnlwdFByaXZhdGVLZXkoXHJcbiAgZW5jcnlwdGVkRGF0YTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogc3RyaW5nIHtcclxuICB0cnkge1xyXG4gICAgLy8gRGVjb2RlIGZyb20gYmFzZTY0XHJcbiAgICBjb25zdCBjb21iaW5lZCA9IGZvcmdlLnV0aWwuZGVjb2RlNjQoZW5jcnlwdGVkRGF0YSk7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBjb21wb25lbnRzXHJcbiAgICBjb25zdCBzYWx0ID0gY29tYmluZWQuc2xpY2UoMCwgMzIpO1xyXG4gICAgY29uc3QgaXYgPSBjb21iaW5lZC5zbGljZSgzMiwgNDQpO1xyXG4gICAgY29uc3QgdGFnID0gY29tYmluZWQuc2xpY2UoNDQsIDYwKTtcclxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGNvbWJpbmVkLnNsaWNlKDYwKTtcclxuXHJcbiAgICAvLyBEZXJpdmUga2V5IGZyb20gcGFzc3dvcmRcclxuICAgIGNvbnN0IGRlcml2ZWRLZXkgPSBmb3JnZS5wa2NzNS5wYmtkZjIocGFzc3dvcmQsIHNhbHQsIDEwMDAwMCwgMzIpO1xyXG5cclxuICAgIC8vIERlY3J5cHQgdXNpbmcgQUVTLTI1Ni1HQ01cclxuICAgIGNvbnN0IGRlY2lwaGVyID0gZm9yZ2UuY2lwaGVyLmNyZWF0ZURlY2lwaGVyKFwiQUVTLUdDTVwiLCBkZXJpdmVkS2V5KTtcclxuICAgIGRlY2lwaGVyLnN0YXJ0KHtcclxuICAgICAgaXY6IGl2LFxyXG4gICAgICB0YWc6IGZvcmdlLnV0aWwuY3JlYXRlQnVmZmVyKHRhZyksXHJcbiAgICB9KTtcclxuICAgIGRlY2lwaGVyLnVwZGF0ZShmb3JnZS51dGlsLmNyZWF0ZUJ1ZmZlcihlbmNyeXB0ZWQpKTtcclxuXHJcbiAgICBjb25zdCBzdWNjZXNzID0gZGVjaXBoZXIuZmluaXNoKCk7XHJcbiAgICBpZiAoIXN1Y2Nlc3MpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIFwiQXV0aGVudGljYXRpb24gZmFpbGVkIC0gaW5jb3JyZWN0IHBhc3N3b3JkIG9yIGNvcnJ1cHRlZCBkYXRhXCJcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZGVjaXBoZXIub3V0cHV0LnRvU3RyaW5nKCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJGYWlsZWQgdG8gZGVjcnlwdCBwcml2YXRlIGtleTogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUGFyc2UgY2VydGlmaWNhdGUgYW5kIGV4dHJhY3QgaW5mb3JtYXRpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNlcnRpZmljYXRlKGNlcnRpZmljYXRlUGVtOiBzdHJpbmcpOiBDZXJ0aWZpY2F0ZUluZm8ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjZXJ0ID0gZm9yZ2UucGtpLmNlcnRpZmljYXRlRnJvbVBlbShjZXJ0aWZpY2F0ZVBlbSk7XHJcblxyXG4gICAgY29uc3QgZ2V0QXR0cmlidXRlVmFsdWUgPSAoYXR0cnM6IGFueVtdLCBuYW1lOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBjb25zdCBhdHRyID0gYXR0cnMuZmluZCgoYSkgPT4gYS5uYW1lID09PSBuYW1lIHx8IGEuc2hvcnROYW1lID09PSBuYW1lKTtcclxuICAgICAgcmV0dXJuIGF0dHIgPyBhdHRyLnZhbHVlIDogXCJcIjtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3ViamVjdDogY2VydC5zdWJqZWN0LmF0dHJpYnV0ZXNcclxuICAgICAgICAubWFwKChhKSA9PiBgJHthLnNob3J0TmFtZSB8fCBhLm5hbWV9PSR7YS52YWx1ZX1gKVxyXG4gICAgICAgIC5qb2luKFwiLCBcIiksXHJcbiAgICAgIGlzc3VlcjogY2VydC5pc3N1ZXIuYXR0cmlidXRlc1xyXG4gICAgICAgIC5tYXAoKGEpID0+IGAke2Euc2hvcnROYW1lIHx8IGEubmFtZX09JHthLnZhbHVlfWApXHJcbiAgICAgICAgLmpvaW4oXCIsIFwiKSxcclxuICAgICAgdmFsaWRGcm9tOiBjZXJ0LnZhbGlkaXR5Lm5vdEJlZm9yZSxcclxuICAgICAgdmFsaWRUbzogY2VydC52YWxpZGl0eS5ub3RBZnRlcixcclxuICAgICAgc2VyaWFsTnVtYmVyOiBjZXJ0LnNlcmlhbE51bWJlcixcclxuICAgICAgYWxnb3JpdGhtOiBcIlJTQSB3aXRoIFNIQS0yNTZcIixcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBwYXJzZSBjZXJ0aWZpY2F0ZTogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBpZiBjZXJ0aWZpY2F0ZSBpcyBzdGlsbCB2YWxpZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2VydGlmaWNhdGVWYWxpZChjZXJ0aWZpY2F0ZVBlbTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNlcnQgPSBmb3JnZS5wa2kuY2VydGlmaWNhdGVGcm9tUGVtKGNlcnRpZmljYXRlUGVtKTtcclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICByZXR1cm4gbm93ID49IGNlcnQudmFsaWRpdHkubm90QmVmb3JlICYmIG5vdyA8PSBjZXJ0LnZhbGlkaXR5Lm5vdEFmdGVyO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJmb3JnZSIsImdlbmVyYXRlS2V5UGFpckFuZENlcnRpZmljYXRlIiwidXNlckluZm8iLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImtleXMiLCJwa2kiLCJyc2EiLCJnZW5lcmF0ZUtleVBhaXIiLCJjZXJ0IiwiY3JlYXRlQ2VydGlmaWNhdGUiLCJwdWJsaWNLZXkiLCJzZXJpYWxOdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInZhbGlkaXR5Iiwibm90QmVmb3JlIiwiRGF0ZSIsIm5vdEFmdGVyIiwic2V0RnVsbFllYXIiLCJnZXRGdWxsWWVhciIsImF0dHJzIiwibmFtZSIsInZhbHVlIiwiY29tbW9uTmFtZSIsInNob3J0TmFtZSIsIm9yZ2FuaXphdGlvbk5hbWUiLCJlbWFpbCIsInNldFN1YmplY3QiLCJzZXRJc3N1ZXIiLCJzZXRFeHRlbnNpb25zIiwiY0EiLCJkaWdpdGFsU2lnbmF0dXJlIiwibm9uUmVwdWRpYXRpb24iLCJrZXlFbmNpcGhlcm1lbnQiLCJzZXJ2ZXJBdXRoIiwiY2xpZW50QXV0aCIsImNvZGVTaWduaW5nIiwiZW1haWxQcm90ZWN0aW9uIiwic2lnbiIsInByaXZhdGVLZXkiLCJtZCIsInNoYTI1NiIsImNyZWF0ZSIsInB1YmxpY0tleVBlbSIsInB1YmxpY0tleVRvUGVtIiwicHJpdmF0ZUtleVBlbSIsInByaXZhdGVLZXlUb1BlbSIsImNlcnRpZmljYXRlUGVtIiwiY2VydGlmaWNhdGVUb1BlbSIsImNlcnRpZmljYXRlIiwiZXJyb3IiLCJlbmNyeXB0UHJpdmF0ZUtleSIsInBhc3N3b3JkIiwic2FsdCIsImdldEJ5dGVzU3luYyIsImRlcml2ZWRLZXkiLCJwa2NzNSIsInBia2RmMiIsIml2IiwiY2lwaGVyIiwiY3JlYXRlQ2lwaGVyIiwic3RhcnQiLCJ1cGRhdGUiLCJ1dGlsIiwiY3JlYXRlQnVmZmVyIiwiZmluaXNoIiwiZW5jcnlwdGVkIiwib3V0cHV0IiwiYnl0ZXMiLCJ0YWciLCJtb2RlIiwiY29tYmluZWQiLCJlbmNvZGU2NCIsIkVycm9yIiwibWVzc2FnZSIsImRlY3J5cHRQcml2YXRlS2V5IiwiZW5jcnlwdGVkRGF0YSIsImRlY29kZTY0Iiwic2xpY2UiLCJkZWNpcGhlciIsImNyZWF0ZURlY2lwaGVyIiwic3VjY2VzcyIsInBhcnNlQ2VydGlmaWNhdGUiLCJjZXJ0aWZpY2F0ZUZyb21QZW0iLCJnZXRBdHRyaWJ1dGVWYWx1ZSIsImF0dHIiLCJmaW5kIiwiYSIsInN1YmplY3QiLCJhdHRyaWJ1dGVzIiwibWFwIiwiam9pbiIsImlzc3VlciIsInZhbGlkRnJvbSIsInZhbGlkVG8iLCJhbGdvcml0aG0iLCJpc0NlcnRpZmljYXRlVmFsaWQiLCJub3ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/crypto.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDatabase: () => (/* binding */ getDatabase),\n/* harmony export */   pdfDb: () => (/* binding */ pdfDb),\n/* harmony export */   userDb: () => (/* binding */ userDb),\n/* harmony export */   userKeysDb: () => (/* binding */ userKeysDb)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/models/User */ \"(rsc)/./models/User.ts\");\n/* harmony import */ var _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/models/UserKeys */ \"(rsc)/./models/UserKeys.ts\");\n/* harmony import */ var _models_PDF__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/models/PDF */ \"(rsc)/./models/PDF.ts\");\n// (fungsi updateProfile dipindahkan ke dalam objek userDb di bawah)\n\n\n\n\n\n// User operations\nconst userDb = {\n    async updateProfile (userId, data) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findByIdAndUpdate(userId, {\n            ...data.name !== undefined ? {\n                name: data.name\n            } : {},\n            ...data.organizationName !== undefined ? {\n                organizationName: data.organizationName\n            } : {},\n            ...data.position !== undefined ? {\n                position: data.position\n            } : {}\n        }, {\n            new: true\n        });\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async create (userData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const passwordHash = await bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().hash(userData.password, 10);\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].create({\n            email: userData.email,\n            passwordHash,\n            name: userData.name,\n            role: userData.role,\n            organizationName: userData.organizationName,\n            position: userData.position,\n            createdAt: new Date(),\n            hasKeys: false\n        });\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async findByEmail (email) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findOne({\n            email\n        });\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async findById (id) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findById(id);\n        if (!userDoc) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    },\n    async updateHasKeys (userId, hasKeys) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findByIdAndUpdate(userId, {\n            hasKeys\n        });\n    },\n    async verifyPassword (email, password) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const userDoc = await _models_User__WEBPACK_IMPORTED_MODULE_2__[\"default\"].findOne({\n            email\n        });\n        if (!userDoc) return null;\n        const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_0___default().compare(password, userDoc.passwordHash);\n        if (!isValid) return null;\n        // @ts-ignore\n        const { passwordHash: _, ...user } = userDoc.toObject();\n        return {\n            ...user,\n            id: userDoc._id.toString()\n        };\n    }\n};\n// User keys operations\nconst userKeysDb = {\n    async create (keysData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const keys = await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].create({\n            ...keysData,\n            createdAt: new Date()\n        });\n        await userDb.updateHasKeys(keysData.userId, true);\n        return keys.toObject();\n    },\n    async findByUserId (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const keys = await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].findOne({\n            userId\n        });\n        return keys ? keys.toObject() : null;\n    },\n    async update (userId, keysData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].findOneAndUpdate({\n            userId\n        }, keysData);\n    },\n    async delete (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_UserKeys__WEBPACK_IMPORTED_MODULE_3__[\"default\"].deleteOne({\n            userId\n        });\n        await userDb.updateHasKeys(userId, false);\n    }\n};\n// PDF operations\nconst pdfDb = {\n    async create (pdfData) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdf = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].create({\n            ...pdfData,\n            createdAt: new Date()\n        });\n        return pdf.toObject();\n    },\n    async findById (id) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdf = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findById(id);\n        return pdf ? pdf.toObject() : null;\n    },\n    async findByUserId (userId) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        const pdfs = await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].find({\n            userId\n        });\n        return pdfs.map((pdf)=>pdf.toObject());\n    },\n    async update (id, data) {\n        await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.dbConnect)();\n        await _models_PDF__WEBPACK_IMPORTED_MODULE_4__[\"default\"].findByIdAndUpdate(id, data);\n    }\n};\n// Export for testing/debugging (optional, now returns nothing)\nconst getDatabase = ()=>({});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNRSx3REFBYUEsQ0FBQzJDLFNBQVMsQ0FBQztZQUFFdkM7UUFBTztRQUN2QyxNQUFNRixPQUFPOEIsYUFBYSxDQUFDNUIsUUFBUTtJQUNyQztBQUNGLEVBQUU7QUFFRixpQkFBaUI7QUFDVixNQUFNd0MsUUFBUTtJQUNuQixNQUFNeEIsUUFBT3lCLE9BT1o7UUFDQyxNQUFNL0MsdURBQVNBO1FBQ2YsTUFBTWdELE1BQU0sTUFBTTdDLG1EQUFRQSxDQUFDbUIsTUFBTSxDQUFDO1lBQ2hDLEdBQUd5QixPQUFPO1lBQ1ZuQixXQUFXLElBQUlDO1FBQ2pCO1FBQ0EsT0FBT21CLElBQUk5QixRQUFRO0lBQ3JCO0lBRUEsTUFBTWUsVUFBU2QsRUFBVTtRQUN2QixNQUFNbkIsdURBQVNBO1FBQ2YsTUFBTWdELE1BQU0sTUFBTTdDLG1EQUFRQSxDQUFDOEIsUUFBUSxDQUFDZDtRQUNwQyxPQUFPNkIsTUFBTUEsSUFBSTlCLFFBQVEsS0FBSztJQUNoQztJQUVBLE1BQU11QixjQUFhbkMsTUFBYztRQUMvQixNQUFNTix1REFBU0E7UUFDZixNQUFNaUQsT0FBTyxNQUFNOUMsbURBQVFBLENBQUMrQyxJQUFJLENBQUM7WUFBRTVDO1FBQU87UUFDMUMsT0FBTzJDLEtBQUtFLEdBQUcsQ0FBQyxDQUFDSCxNQUFRQSxJQUFJOUIsUUFBUTtJQUN2QztJQUVBLE1BQU13QixRQUFPdkIsRUFBVSxFQUFFWixJQUFtQjtRQUMxQyxNQUFNUCx1REFBU0E7UUFDZixNQUFNRyxtREFBUUEsQ0FBQ00saUJBQWlCLENBQUNVLElBQUlaO0lBQ3ZDO0FBQ0YsRUFBRTtBQUVGLCtEQUErRDtBQUN4RCxNQUFNNkMsY0FBYyxJQUFPLEVBQUMsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gKGZ1bmdzaSB1cGRhdGVQcm9maWxlIGRpcGluZGFoa2FuIGtlIGRhbGFtIG9iamVrIHVzZXJEYiBkaSBiYXdhaClcclxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcclxuaW1wb3J0IHsgZGJDb25uZWN0IH0gZnJvbSBcIkAvbGliL21vbmdvZGJcIjtcclxuaW1wb3J0IFVzZXJNb2RlbCwgeyBJVXNlciB9IGZyb20gXCJAL21vZGVscy9Vc2VyXCI7XHJcbmltcG9ydCBVc2VyS2V5c01vZGVsLCB7IElVc2VyS2V5cyB9IGZyb20gXCJAL21vZGVscy9Vc2VyS2V5c1wiO1xyXG5pbXBvcnQgUERGTW9kZWwsIHsgSVBERiB9IGZyb20gXCJAL21vZGVscy9QREZcIjtcclxuXHJcbi8vIFVzZXIgb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgdXNlckRiID0ge1xyXG4gIGFzeW5jIHVwZGF0ZVByb2ZpbGUoXHJcbiAgICB1c2VySWQ6IHN0cmluZyxcclxuICAgIGRhdGE6IHsgbmFtZT86IHN0cmluZzsgb3JnYW5pemF0aW9uTmFtZT86IHN0cmluZzsgcG9zaXRpb24/OiBzdHJpbmcgfVxyXG4gICk6IFByb21pc2U8KElVc2VyICYgeyBpZDogc3RyaW5nIH0pIHwgbnVsbD4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkQW5kVXBkYXRlKFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHtcclxuICAgICAgICAuLi4oZGF0YS5uYW1lICE9PSB1bmRlZmluZWQgPyB7IG5hbWU6IGRhdGEubmFtZSB9IDoge30pLFxyXG4gICAgICAgIC4uLihkYXRhLm9yZ2FuaXphdGlvbk5hbWUgIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgPyB7IG9yZ2FuaXphdGlvbk5hbWU6IGRhdGEub3JnYW5pemF0aW9uTmFtZSB9XHJcbiAgICAgICAgICA6IHt9KSxcclxuICAgICAgICAuLi4oZGF0YS5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkID8geyBwb3NpdGlvbjogZGF0YS5wb3NpdGlvbiB9IDoge30pLFxyXG4gICAgICB9LFxyXG4gICAgICB7IG5ldzogdHJ1ZSB9XHJcbiAgICApO1xyXG4gICAgaWYgKCF1c2VyRG9jKSByZXR1cm4gbnVsbDtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcbiAgYXN5bmMgY3JlYXRlKHVzZXJEYXRhOiB7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgcGFzc3dvcmQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHJvbGU6IFwib3JnYW5pemF0aW9uXCIgfCBcImNvbnN1bHRhbnRcIjtcclxuICAgIG9yZ2FuaXphdGlvbk5hbWU/OiBzdHJpbmc7XHJcbiAgICBwb3NpdGlvbj86IHN0cmluZztcclxuICB9KTogUHJvbWlzZTxPbWl0PElVc2VyLCBcInBhc3N3b3JkSGFzaFwiPiAmIHsgaWQ6IHN0cmluZyB9PiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGJjcnlwdC5oYXNoKHVzZXJEYXRhLnBhc3N3b3JkLCAxMCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmNyZWF0ZSh7XHJcbiAgICAgIGVtYWlsOiB1c2VyRGF0YS5lbWFpbCxcclxuICAgICAgcGFzc3dvcmRIYXNoLFxyXG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICByb2xlOiB1c2VyRGF0YS5yb2xlLFxyXG4gICAgICBvcmdhbml6YXRpb25OYW1lOiB1c2VyRGF0YS5vcmdhbml6YXRpb25OYW1lLFxyXG4gICAgICBwb3NpdGlvbjogdXNlckRhdGEucG9zaXRpb24sXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgaGFzS2V5czogZmFsc2UsXHJcbiAgICB9KTtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcblxyXG4gIGFzeW5jIGZpbmRCeUVtYWlsKGVtYWlsOiBzdHJpbmcpOiBQcm9taXNlPChJVXNlciAmIHsgaWQ6IHN0cmluZyB9KSB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IFVzZXJNb2RlbC5maW5kT25lKHsgZW1haWwgfSk7XHJcbiAgICBpZiAoIXVzZXJEb2MpIHJldHVybiBudWxsO1xyXG4gICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgY29uc3QgeyBwYXNzd29yZEhhc2g6IF8sIC4uLnVzZXIgfSA9IHVzZXJEb2MudG9PYmplY3QoKTtcclxuICAgIHJldHVybiB7IC4uLnVzZXIsIGlkOiB1c2VyRG9jLl9pZC50b1N0cmluZygpIH07XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8KElVc2VyICYgeyBpZDogc3RyaW5nIH0pIHwgbnVsbD4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCB1c2VyRG9jID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKGlkKTtcclxuICAgIGlmICghdXNlckRvYykgcmV0dXJuIG51bGw7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICBjb25zdCB7IHBhc3N3b3JkSGFzaDogXywgLi4udXNlciB9ID0gdXNlckRvYy50b09iamVjdCgpO1xyXG4gICAgcmV0dXJuIHsgLi4udXNlciwgaWQ6IHVzZXJEb2MuX2lkLnRvU3RyaW5nKCkgfTtcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGVIYXNLZXlzKHVzZXJJZDogc3RyaW5nLCBoYXNLZXlzOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZEFuZFVwZGF0ZSh1c2VySWQsIHsgaGFzS2V5cyB9KTtcclxuICB9LFxyXG5cclxuICBhc3luYyB2ZXJpZnlQYXNzd29yZChcclxuICAgIGVtYWlsOiBzdHJpbmcsXHJcbiAgICBwYXNzd29yZDogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTwoSVVzZXIgJiB7IGlkOiBzdHJpbmcgfSkgfCBudWxsPiB7XHJcbiAgICBhd2FpdCBkYkNvbm5lY3QoKTtcclxuICAgIGNvbnN0IHVzZXJEb2MgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7IGVtYWlsIH0pO1xyXG4gICAgaWYgKCF1c2VyRG9jKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlckRvYy5wYXNzd29yZEhhc2gpO1xyXG4gICAgaWYgKCFpc1ZhbGlkKSByZXR1cm4gbnVsbDtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIGNvbnN0IHsgcGFzc3dvcmRIYXNoOiBfLCAuLi51c2VyIH0gPSB1c2VyRG9jLnRvT2JqZWN0KCk7XHJcbiAgICByZXR1cm4geyAuLi51c2VyLCBpZDogdXNlckRvYy5faWQudG9TdHJpbmcoKSB9O1xyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBVc2VyIGtleXMgb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3QgdXNlcktleXNEYiA9IHtcclxuICBhc3luYyBjcmVhdGUoa2V5c0RhdGE6IHtcclxuICAgIHVzZXJJZDogc3RyaW5nO1xyXG4gICAgcHVibGljS2V5OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlS2V5RW5jcnlwdGVkOiBzdHJpbmc7XHJcbiAgICBjZXJ0aWZpY2F0ZTogc3RyaW5nO1xyXG4gIH0pOiBQcm9taXNlPElVc2VyS2V5cz4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCBrZXlzID0gYXdhaXQgVXNlcktleXNNb2RlbC5jcmVhdGUoe1xyXG4gICAgICAuLi5rZXlzRGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCB1c2VyRGIudXBkYXRlSGFzS2V5cyhrZXlzRGF0YS51c2VySWQsIHRydWUpO1xyXG4gICAgcmV0dXJuIGtleXMudG9PYmplY3QoKTtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPElVc2VyS2V5cyB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3Qga2V5cyA9IGF3YWl0IFVzZXJLZXlzTW9kZWwuZmluZE9uZSh7IHVzZXJJZCB9KTtcclxuICAgIHJldHVybiBrZXlzID8ga2V5cy50b09iamVjdCgpIDogbnVsbDtcclxuICB9LFxyXG5cclxuICBhc3luYyB1cGRhdGUodXNlcklkOiBzdHJpbmcsIGtleXNEYXRhOiBQYXJ0aWFsPElVc2VyS2V5cz4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgVXNlcktleXNNb2RlbC5maW5kT25lQW5kVXBkYXRlKHsgdXNlcklkIH0sIGtleXNEYXRhKTtcclxuICB9LFxyXG5cclxuICBhc3luYyBkZWxldGUodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgVXNlcktleXNNb2RlbC5kZWxldGVPbmUoeyB1c2VySWQgfSk7XHJcbiAgICBhd2FpdCB1c2VyRGIudXBkYXRlSGFzS2V5cyh1c2VySWQsIGZhbHNlKTtcclxuICB9LFxyXG59O1xyXG5cclxuLy8gUERGIG9wZXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IHBkZkRiID0ge1xyXG4gIGFzeW5jIGNyZWF0ZShwZGZEYXRhOiB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB1c2VySWQ6IHN0cmluZztcclxuICAgIGNvbnRlbnQ6IEJ1ZmZlcjtcclxuICAgIHNpZ25lZDogYm9vbGVhbjtcclxuICAgIHNpZ25lZEJ5Pzogc3RyaW5nO1xyXG4gICAgc2lnbmVkQXQ/OiBEYXRlO1xyXG4gIH0pOiBQcm9taXNlPElQREY+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgcGRmID0gYXdhaXQgUERGTW9kZWwuY3JlYXRlKHtcclxuICAgICAgLi4ucGRmRGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcGRmLnRvT2JqZWN0KCk7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgZmluZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8SVBERiB8IG51bGw+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgY29uc3QgcGRmID0gYXdhaXQgUERGTW9kZWwuZmluZEJ5SWQoaWQpO1xyXG4gICAgcmV0dXJuIHBkZiA/IHBkZi50b09iamVjdCgpIDogbnVsbDtcclxuICB9LFxyXG5cclxuICBhc3luYyBmaW5kQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPElQREZbXT4ge1xyXG4gICAgYXdhaXQgZGJDb25uZWN0KCk7XHJcbiAgICBjb25zdCBwZGZzID0gYXdhaXQgUERGTW9kZWwuZmluZCh7IHVzZXJJZCB9KTtcclxuICAgIHJldHVybiBwZGZzLm1hcCgocGRmKSA9PiBwZGYudG9PYmplY3QoKSk7XHJcbiAgfSxcclxuXHJcbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFBhcnRpYWw8SVBERj4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGF3YWl0IGRiQ29ubmVjdCgpO1xyXG4gICAgYXdhaXQgUERGTW9kZWwuZmluZEJ5SWRBbmRVcGRhdGUoaWQsIGRhdGEpO1xyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBFeHBvcnQgZm9yIHRlc3RpbmcvZGVidWdnaW5nIChvcHRpb25hbCwgbm93IHJldHVybnMgbm90aGluZylcclxuZXhwb3J0IGNvbnN0IGdldERhdGFiYXNlID0gKCkgPT4gKHt9KTtcclxuIl0sIm5hbWVzIjpbImJjcnlwdCIsImRiQ29ubmVjdCIsIlVzZXJNb2RlbCIsIlVzZXJLZXlzTW9kZWwiLCJQREZNb2RlbCIsInVzZXJEYiIsInVwZGF0ZVByb2ZpbGUiLCJ1c2VySWQiLCJkYXRhIiwidXNlckRvYyIsImZpbmRCeUlkQW5kVXBkYXRlIiwibmFtZSIsInVuZGVmaW5lZCIsIm9yZ2FuaXphdGlvbk5hbWUiLCJwb3NpdGlvbiIsIm5ldyIsInBhc3N3b3JkSGFzaCIsIl8iLCJ1c2VyIiwidG9PYmplY3QiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwiY3JlYXRlIiwidXNlckRhdGEiLCJoYXNoIiwicGFzc3dvcmQiLCJlbWFpbCIsInJvbGUiLCJjcmVhdGVkQXQiLCJEYXRlIiwiaGFzS2V5cyIsImZpbmRCeUVtYWlsIiwiZmluZE9uZSIsImZpbmRCeUlkIiwidXBkYXRlSGFzS2V5cyIsInZlcmlmeVBhc3N3b3JkIiwiaXNWYWxpZCIsImNvbXBhcmUiLCJ1c2VyS2V5c0RiIiwia2V5c0RhdGEiLCJrZXlzIiwiZmluZEJ5VXNlcklkIiwidXBkYXRlIiwiZmluZE9uZUFuZFVwZGF0ZSIsImRlbGV0ZSIsImRlbGV0ZU9uZSIsInBkZkRiIiwicGRmRGF0YSIsInBkZiIsInBkZnMiLCJmaW5kIiwibWFwIiwiZ2V0RGF0YWJhc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.ts":
/*!************************!*\
  !*** ./lib/mongodb.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   dbConnect: () => (/* binding */ dbConnect)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/pdfsign\";\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\nlet cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, {\n            bufferCommands: false\n        }).then((mongoose)=>{\n            return mongoose;\n        });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9uZ29kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFaEMsTUFBTUMsY0FDSkMsUUFBUUMsR0FBRyxDQUFDRixXQUFXLElBQUk7QUFFN0IsSUFBSSxDQUFDQSxhQUFhO0lBQ2hCLE1BQU0sSUFBSUcsTUFDUjtBQUVKO0FBRUEsSUFBSUMsU0FBUyxPQUFnQkwsUUFBUTtBQUVyQyxJQUFJLENBQUNLLFFBQVE7SUFDWEEsU0FBUyxPQUFnQkwsUUFBUSxHQUFHO1FBQUVPLE1BQU07UUFBTUMsU0FBUztJQUFLO0FBQ2xFO0FBRU8sZUFBZUM7SUFDcEIsSUFBSUosT0FBT0UsSUFBSSxFQUFFO1FBQ2YsT0FBT0YsT0FBT0UsSUFBSTtJQUNwQjtJQUNBLElBQUksQ0FBQ0YsT0FBT0csT0FBTyxFQUFFO1FBQ25CSCxPQUFPRyxPQUFPLEdBQUdSLHVEQUNQLENBQUNDLGFBQWE7WUFDcEJVLGdCQUFnQjtRQUNsQixHQUNDQyxJQUFJLENBQUMsQ0FBQ1o7WUFDTCxPQUFPQTtRQUNUO0lBQ0o7SUFDQUssT0FBT0UsSUFBSSxHQUFHLE1BQU1GLE9BQU9HLE9BQU87SUFDbEMsT0FBT0gsT0FBT0UsSUFBSTtBQUNwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL21vbmdvZGIudHM/MDViZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG5jb25zdCBNT05HT0RCX1VSSSA9XHJcbiAgcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgXCJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L3BkZnNpZ25cIjtcclxuXHJcbmlmICghTU9OR09EQl9VUkkpIHtcclxuICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICBcIlBsZWFzZSBkZWZpbmUgdGhlIE1PTkdPREJfVVJJIGVudmlyb25tZW50IHZhcmlhYmxlIGluc2lkZSAuZW52LmxvY2FsXCJcclxuICApO1xyXG59XHJcblxyXG5sZXQgY2FjaGVkID0gKGdsb2JhbCBhcyBhbnkpLm1vbmdvb3NlO1xyXG5cclxuaWYgKCFjYWNoZWQpIHtcclxuICBjYWNoZWQgPSAoZ2xvYmFsIGFzIGFueSkubW9uZ29vc2UgPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRiQ29ubmVjdCgpIHtcclxuICBpZiAoY2FjaGVkLmNvbm4pIHtcclxuICAgIHJldHVybiBjYWNoZWQuY29ubjtcclxuICB9XHJcbiAgaWYgKCFjYWNoZWQucHJvbWlzZSkge1xyXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZVxyXG4gICAgICAuY29ubmVjdChNT05HT0RCX1VSSSwge1xyXG4gICAgICAgIGJ1ZmZlckNvbW1hbmRzOiBmYWxzZSxcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKG1vbmdvb3NlKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIG1vbmdvb3NlO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgY2FjaGVkLmNvbm4gPSBhd2FpdCBjYWNoZWQucHJvbWlzZTtcclxuICByZXR1cm4gY2FjaGVkLmNvbm47XHJcbn1cclxuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJjYWNoZWQiLCJnbG9iYWwiLCJjb25uIiwicHJvbWlzZSIsImRiQ29ubmVjdCIsImNvbm5lY3QiLCJidWZmZXJDb21tYW5kcyIsInRoZW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./lib/pdf-signer.ts":
/*!***************************!*\
  !*** ./lib/pdf-signer.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractSignatureInfo: () => (/* binding */ extractSignatureInfo),\n/* harmony export */   isPDFSigned: () => (/* binding */ isPDFSigned),\n/* harmony export */   signPDF: () => (/* binding */ signPDF),\n/* harmony export */   verifyPDFSignature: () => (/* binding */ verifyPDFSignature)\n/* harmony export */ });\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node-forge */ \"node-forge\");\n/* harmony import */ var node_forge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_forge__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pdf_lib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pdf-lib */ \"(rsc)/./node_modules/pdf-lib/es/index.js\");\n/* harmony import */ var _lib_barcode_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/barcode-util */ \"(rsc)/./lib/barcode-util.ts\");\n\n\n\n/**\r\n * Sign PDF document with private key and certificate\r\n * Uses PKCS#7 detached signature\r\n */ async function signPDF(pdfBuffer, privateKeyPem, certificatePem, signerInfo) {\n    try {\n        // Load PDF\n        const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_1__.PDFDocument.load(pdfBuffer);\n        // Convert PDF to bytes for signing\n        const pdfBytes = await pdfDoc.save();\n        // Create signature\n        const privateKey = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.privateKeyFromPem(privateKeyPem);\n        const certificate = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        // Konversi pdfBytes ke string biner agar tidak error URI malformed\n        const pdfBinaryString = node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.binary.raw.encode(pdfBytes);\n        // Hash the PDF content\n        const md = node_forge__WEBPACK_IMPORTED_MODULE_0___default().md.sha256.create();\n        md.update(pdfBinaryString, \"raw\");\n        // Sign the hash\n        const signature = privateKey.sign(md);\n        // Create PKCS#7 signature\n        const p7 = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pkcs7.createSignedData();\n        p7.content = node_forge__WEBPACK_IMPORTED_MODULE_0___default().util.createBuffer(pdfBinaryString);\n        p7.addCertificate(certificate);\n        p7.addSigner({\n            key: privateKey,\n            certificate: certificate,\n            digestAlgorithm: (node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki).oids.sha256,\n            authenticatedAttributes: [\n                {\n                    type: (node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki).oids.contentType,\n                    value: (node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki).oids.data\n                },\n                {\n                    type: (node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki).oids.messageDigest\n                },\n                {\n                    type: (node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki).oids.signingTime,\n                    value: new Date().toISOString()\n                }\n            ]\n        });\n        // Sign\n        p7.sign({\n            detached: true\n        });\n        // Convert signature to DER format\n        const derSignature = node_forge__WEBPACK_IMPORTED_MODULE_0___default().asn1.toDer(p7.toAsn1()).getBytes();\n        // Generate barcode data (horizontal, format: nama|posisi|org|tanggal|signature)\n        const barcodeData = [\n            signerInfo?.name || \"-\",\n            signerInfo?.position || \"-\",\n            signerInfo?.organizationName || \"-\",\n            new Date().toISOString(),\n            Buffer.from(derSignature, \"binary\").toString(\"base64\")\n        ].join(\"|\");\n        const barcodePng = await (0,_lib_barcode_util__WEBPACK_IMPORTED_MODULE_2__.generateBarcodePNG)(barcodeData);\n        // Embed signature and barcode in PDF\n        const signedPdfDoc = await embedSignatureInPDF(pdfDoc, derSignature, certificate, barcodePng, signerInfo);\n        // Return signed PDF as buffer\n        const signedPdfBytes = await signedPdfDoc.save();\n        return Buffer.from(signedPdfBytes);\n    } catch (error) {\n        throw new Error(\"Failed to sign PDF: \" + error.message);\n    }\n}\n/**\r\n * Embed PKCS#7 signature into PDF\r\n */ async function embedSignatureInPDF(pdfDoc, signature, certificate, barcodePng, signerInfo) {\n    // Tentukan nama penandatangan\n    let signerName = signerInfo?.name;\n    if (!signerName) {\n        const certInfo = certificate.subject.attributes.find((attr)=>attr.name === \"commonName\");\n        if (certInfo) {\n            signerName = typeof certInfo.value === \"string\" ? certInfo.value : Array.isArray(certInfo.value) ? certInfo.value.join(\", \") : \"Unknown\";\n        } else {\n            signerName = \"Unknown\";\n        }\n    }\n    // Add signature annotation (visual representation)\n    const pages = pdfDoc.getPages();\n    const firstPage = pages[0];\n    const { width, height } = firstPage.getSize();\n    // Add text annotation: nama, jabatan, PT\n    let yText = 80;\n    firstPage.drawText(`Digitally Signed by: ${signerName}`, {\n        x: 50,\n        y: yText,\n        size: 10\n    });\n    yText -= 13;\n    const positionText = signerInfo?.position ? signerInfo.position : \"-\";\n    firstPage.drawText(`Position: ${positionText}`, {\n        x: 50,\n        y: yText,\n        size: 10\n    });\n    yText -= 13;\n    const orgText = signerInfo?.organizationName ? signerInfo.organizationName : \"-\";\n    firstPage.drawText(`Company: ${orgText}`, {\n        x: 50,\n        y: yText,\n        size: 10\n    });\n    yText -= 13;\n    firstPage.drawText(`Date: ${new Date().toLocaleString(\"id-ID\")}`, {\n        x: 50,\n        y: yText,\n        size: 10\n    });\n    yText -= 35; // space for barcode (tinggi 30 + margin 5)\n    // Add barcode if available, right below the text\n    if (barcodePng) {\n        await (0,_lib_barcode_util__WEBPACK_IMPORTED_MODULE_2__.embedBarcodeToPDF)(pdfDoc, barcodePng, 50, yText, 200, 30);\n    }\n    // Store signature in PDF metadata\n    pdfDoc.setTitle(\"Signed Document\");\n    pdfDoc.setSubject(\"This document has been digitally signed\");\n    pdfDoc.setKeywords([\n        \"signed\",\n        \"digital-signature\",\n        typeof signerName === \"string\" ? signerName : \"Unknown\"\n    ]);\n    pdfDoc.setCreator(\"PDF Signature System\");\n    // Note: For production, you would need to implement proper PDF signature dictionary\n    // This is a simplified version that embeds signature information\n    return pdfDoc;\n}\n/**\r\n * Verify PDF signature\r\n */ async function verifyPDFSignature(pdfBuffer) {\n    try {\n        // Load PDF\n        const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_1__.PDFDocument.load(pdfBuffer);\n        // Check if PDF has signature indicators in metadata\n        const title = pdfDoc.getTitle();\n        const subject = pdfDoc.getSubject();\n        const keywordsRaw = pdfDoc.getKeywords();\n        let keywordsArr = [];\n        if (Array.isArray(keywordsRaw)) {\n            keywordsArr = keywordsRaw.filter((k)=>typeof k === \"string\");\n        } else if (typeof keywordsRaw === \"string\") {\n            keywordsArr = [\n                keywordsRaw\n            ];\n        }\n        // This is a simplified verification\n        // In production, you would extract and verify the actual PKCS#7 signature\n        if (!title || !subject || keywordsArr.length === 0) {\n            return null;\n        }\n        if (!keywordsArr.includes(\"signed\") || !keywordsArr.includes(\"digital-signature\")) {\n            return null;\n        }\n        // Extract signer information from keywords\n        const signerName = keywordsArr.find((k)=>![\n                \"signed\",\n                \"digital-signature\"\n            ].includes(k)) || \"Unknown\";\n        // For this demo, we consider the signature valid if metadata indicates signing\n        return {\n            valid: true,\n            signedBy: typeof signerName === \"string\" ? signerName : Array.isArray(signerName) ? signerName.join(\", \") : \"Unknown\",\n            signedAt: new Date(),\n            certificate: \"Certificate embedded in signature\",\n            issuer: \"Self-Signed\",\n            subject: signerName,\n            validFrom: new Date(),\n            validTo: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n            algorithm: \"RSA with SHA-256\"\n        };\n    } catch (error) {\n        throw new Error(\"Failed to verify PDF signature: \" + error.message);\n    }\n}\n/**\r\n * Extract signature information from signed PDF (advanced)\r\n */ async function extractSignatureInfo(signedPdfBuffer, certificatePem) {\n    try {\n        const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_1__.PDFDocument.load(signedPdfBuffer);\n        const certificate = node_forge__WEBPACK_IMPORTED_MODULE_0___default().pki.certificateFromPem(certificatePem);\n        const certInfo = certificate.subject.attributes.find((attr)=>attr.name === \"commonName\");\n        const signerName = certInfo ? certInfo.value : \"Unknown\";\n        return {\n            valid: true,\n            signedBy: typeof signerName === \"string\" ? signerName : Array.isArray(signerName) ? signerName.join(\", \") : \"Unknown\",\n            signedAt: new Date(),\n            certificate: certificatePem,\n            issuer: certificate.issuer.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            subject: certificate.subject.attributes.map((a)=>`${a.shortName || a.name}=${a.value}`).join(\", \"),\n            validFrom: certificate.validity.notBefore,\n            validTo: certificate.validity.notAfter,\n            algorithm: \"RSA with SHA-256\"\n        };\n    } catch (error) {\n        throw new Error(\"Failed to extract signature info: \" + error.message);\n    }\n}\n/**\r\n * Check if PDF has been signed\r\n */ async function isPDFSigned(pdfBuffer) {\n    try {\n        const result = await verifyPDFSignature(pdfBuffer);\n        return result !== null && result.valid;\n    } catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtZQUNOK0MsVUFBVSxJQUFJOUQ7WUFDZDlCLGFBQWFUO1lBQ2JzRyxRQUFRN0YsWUFBWTZGLE1BQU0sQ0FBQ3JDLFVBQVUsQ0FDbEM0QyxHQUFHLENBQUMsQ0FBQ0MsSUFBVyxDQUFDLEVBQUVBLEVBQUVDLFNBQVMsSUFBSUQsRUFBRTlELElBQUksQ0FBQyxDQUFDLEVBQUU4RCxFQUFFM0UsS0FBSyxDQUFDLENBQUMsRUFDckRtQixJQUFJLENBQUM7WUFDUlUsU0FBU3ZELFlBQVl1RCxPQUFPLENBQUNDLFVBQVUsQ0FDcEM0QyxHQUFHLENBQUMsQ0FBQ0MsSUFBVyxDQUFDLEVBQUVBLEVBQUVDLFNBQVMsSUFBSUQsRUFBRTlELElBQUksQ0FBQyxDQUFDLEVBQUU4RCxFQUFFM0UsS0FBSyxDQUFDLENBQUMsRUFDckRtQixJQUFJLENBQUM7WUFDUmlELFdBQVc5RixZQUFZdUcsUUFBUSxDQUFDQyxTQUFTO1lBQ3pDVCxTQUFTL0YsWUFBWXVHLFFBQVEsQ0FBQ0UsUUFBUTtZQUN0Q1IsV0FBVztRQUNiO0lBQ0YsRUFBRSxPQUFPL0MsT0FBTztRQUNkLE1BQU0sSUFBSUMsTUFDUix1Q0FBdUMsTUFBaUJDLE9BQU87SUFFbkU7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZXNELFlBQVlySCxTQUFpQjtJQUNqRCxJQUFJO1FBQ0YsTUFBTXNILFNBQVMsTUFBTTVCLG1CQUFtQjFGO1FBQ3hDLE9BQU9zSCxXQUFXLFFBQVFBLE9BQU9qQixLQUFLO0lBQ3hDLEVBQUUsT0FBT3hDLE9BQU87UUFDZCxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL3BkZi1zaWduZXIudHM/ODY0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIFNpZ25lckluZm8ge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBwb3NpdGlvbj86IHN0cmluZztcclxuICBvcmdhbml6YXRpb25OYW1lPzogc3RyaW5nO1xyXG59XHJcblxyXG5pbXBvcnQgZm9yZ2UgZnJvbSBcIm5vZGUtZm9yZ2VcIjtcclxuaW1wb3J0IHsgUERGRG9jdW1lbnQgfSBmcm9tIFwicGRmLWxpYlwiO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZUJhcmNvZGVQTkcsIGVtYmVkQmFyY29kZVRvUERGIH0gZnJvbSBcIkAvbGliL2JhcmNvZGUtdXRpbFwiO1xyXG5pbXBvcnQgeyBTaWduYXR1cmVJbmZvIH0gZnJvbSBcIkAvdHlwZXNcIjtcclxuXHJcbi8qKlxyXG4gKiBTaWduIFBERiBkb2N1bWVudCB3aXRoIHByaXZhdGUga2V5IGFuZCBjZXJ0aWZpY2F0ZVxyXG4gKiBVc2VzIFBLQ1MjNyBkZXRhY2hlZCBzaWduYXR1cmVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduUERGKFxyXG4gIHBkZkJ1ZmZlcjogQnVmZmVyLFxyXG4gIHByaXZhdGVLZXlQZW06IHN0cmluZyxcclxuICBjZXJ0aWZpY2F0ZVBlbTogc3RyaW5nLFxyXG4gIHNpZ25lckluZm8/OiBTaWduZXJJbmZvXHJcbik6IFByb21pc2U8QnVmZmVyPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIExvYWQgUERGXHJcbiAgICBjb25zdCBwZGZEb2MgPSBhd2FpdCBQREZEb2N1bWVudC5sb2FkKHBkZkJ1ZmZlcik7XHJcblxyXG4gICAgLy8gQ29udmVydCBQREYgdG8gYnl0ZXMgZm9yIHNpZ25pbmdcclxuICAgIGNvbnN0IHBkZkJ5dGVzID0gYXdhaXQgcGRmRG9jLnNhdmUoKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgc2lnbmF0dXJlXHJcbiAgICBjb25zdCBwcml2YXRlS2V5ID0gZm9yZ2UucGtpLnByaXZhdGVLZXlGcm9tUGVtKHByaXZhdGVLZXlQZW0pO1xyXG4gICAgY29uc3QgY2VydGlmaWNhdGUgPSBmb3JnZS5wa2kuY2VydGlmaWNhdGVGcm9tUGVtKGNlcnRpZmljYXRlUGVtKTtcclxuXHJcbiAgICAvLyBLb252ZXJzaSBwZGZCeXRlcyBrZSBzdHJpbmcgYmluZXIgYWdhciB0aWRhayBlcnJvciBVUkkgbWFsZm9ybWVkXHJcbiAgICBjb25zdCBwZGZCaW5hcnlTdHJpbmcgPSBmb3JnZS51dGlsLmJpbmFyeS5yYXcuZW5jb2RlKHBkZkJ5dGVzKTtcclxuXHJcbiAgICAvLyBIYXNoIHRoZSBQREYgY29udGVudFxyXG4gICAgY29uc3QgbWQgPSBmb3JnZS5tZC5zaGEyNTYuY3JlYXRlKCk7XHJcbiAgICBtZC51cGRhdGUocGRmQmluYXJ5U3RyaW5nLCBcInJhd1wiKTtcclxuXHJcbiAgICAvLyBTaWduIHRoZSBoYXNoXHJcbiAgICBjb25zdCBzaWduYXR1cmUgPSBwcml2YXRlS2V5LnNpZ24obWQpO1xyXG5cclxuICAgIC8vIENyZWF0ZSBQS0NTIzcgc2lnbmF0dXJlXHJcbiAgICBjb25zdCBwNyA9IGZvcmdlLnBrY3M3LmNyZWF0ZVNpZ25lZERhdGEoKTtcclxuICAgIHA3LmNvbnRlbnQgPSBmb3JnZS51dGlsLmNyZWF0ZUJ1ZmZlcihwZGZCaW5hcnlTdHJpbmcpO1xyXG4gICAgcDcuYWRkQ2VydGlmaWNhdGUoY2VydGlmaWNhdGUpO1xyXG4gICAgcDcuYWRkU2lnbmVyKHtcclxuICAgICAga2V5OiBwcml2YXRlS2V5LFxyXG4gICAgICBjZXJ0aWZpY2F0ZTogY2VydGlmaWNhdGUsXHJcbiAgICAgIGRpZ2VzdEFsZ29yaXRobTogZm9yZ2UucGtpLm9pZHMuc2hhMjU2LFxyXG4gICAgICBhdXRoZW50aWNhdGVkQXR0cmlidXRlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHR5cGU6IGZvcmdlLnBraS5vaWRzLmNvbnRlbnRUeXBlLFxyXG4gICAgICAgICAgdmFsdWU6IGZvcmdlLnBraS5vaWRzLmRhdGEsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0eXBlOiBmb3JnZS5wa2kub2lkcy5tZXNzYWdlRGlnZXN0LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdHlwZTogZm9yZ2UucGtpLm9pZHMuc2lnbmluZ1RpbWUsXHJcbiAgICAgICAgICB2YWx1ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF0sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBTaWduXHJcbiAgICBwNy5zaWduKHsgZGV0YWNoZWQ6IHRydWUgfSk7XHJcblxyXG4gICAgLy8gQ29udmVydCBzaWduYXR1cmUgdG8gREVSIGZvcm1hdFxyXG4gICAgY29uc3QgZGVyU2lnbmF0dXJlID0gZm9yZ2UuYXNuMS50b0RlcihwNy50b0FzbjEoKSkuZ2V0Qnl0ZXMoKTtcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBiYXJjb2RlIGRhdGEgKGhvcml6b250YWwsIGZvcm1hdDogbmFtYXxwb3Npc2l8b3JnfHRhbmdnYWx8c2lnbmF0dXJlKVxyXG4gICAgY29uc3QgYmFyY29kZURhdGEgPSBbXHJcbiAgICAgIHNpZ25lckluZm8/Lm5hbWUgfHwgXCItXCIsXHJcbiAgICAgIHNpZ25lckluZm8/LnBvc2l0aW9uIHx8IFwiLVwiLFxyXG4gICAgICBzaWduZXJJbmZvPy5vcmdhbml6YXRpb25OYW1lIHx8IFwiLVwiLFxyXG4gICAgICBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIEJ1ZmZlci5mcm9tKGRlclNpZ25hdHVyZSwgXCJiaW5hcnlcIikudG9TdHJpbmcoXCJiYXNlNjRcIiksXHJcbiAgICBdLmpvaW4oXCJ8XCIpO1xyXG4gICAgY29uc3QgYmFyY29kZVBuZyA9IGF3YWl0IGdlbmVyYXRlQmFyY29kZVBORyhiYXJjb2RlRGF0YSk7XHJcblxyXG4gICAgLy8gRW1iZWQgc2lnbmF0dXJlIGFuZCBiYXJjb2RlIGluIFBERlxyXG4gICAgY29uc3Qgc2lnbmVkUGRmRG9jID0gYXdhaXQgZW1iZWRTaWduYXR1cmVJblBERihcclxuICAgICAgcGRmRG9jLFxyXG4gICAgICBkZXJTaWduYXR1cmUsXHJcbiAgICAgIGNlcnRpZmljYXRlLFxyXG4gICAgICBiYXJjb2RlUG5nLFxyXG4gICAgICBzaWduZXJJbmZvXHJcbiAgICApO1xyXG5cclxuICAgIC8vIFJldHVybiBzaWduZWQgUERGIGFzIGJ1ZmZlclxyXG4gICAgY29uc3Qgc2lnbmVkUGRmQnl0ZXMgPSBhd2FpdCBzaWduZWRQZGZEb2Muc2F2ZSgpO1xyXG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHNpZ25lZFBkZkJ5dGVzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHNpZ24gUERGOiBcIiArIChlcnJvciBhcyBFcnJvcikubWVzc2FnZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW1iZWQgUEtDUyM3IHNpZ25hdHVyZSBpbnRvIFBERlxyXG4gKi9cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGVtYmVkU2lnbmF0dXJlSW5QREYoXHJcbiAgcGRmRG9jOiBQREZEb2N1bWVudCxcclxuICBzaWduYXR1cmU6IHN0cmluZyxcclxuICBjZXJ0aWZpY2F0ZTogZm9yZ2UucGtpLkNlcnRpZmljYXRlLFxyXG4gIGJhcmNvZGVQbmc/OiBCdWZmZXIsXHJcbiAgc2lnbmVySW5mbz86IFNpZ25lckluZm9cclxuKSB7XHJcbiAgLy8gVGVudHVrYW4gbmFtYSBwZW5hbmRhdGFuZ2FuXHJcbiAgbGV0IHNpZ25lck5hbWUgPSBzaWduZXJJbmZvPy5uYW1lO1xyXG4gIGlmICghc2lnbmVyTmFtZSkge1xyXG4gICAgY29uc3QgY2VydEluZm8gPSBjZXJ0aWZpY2F0ZS5zdWJqZWN0LmF0dHJpYnV0ZXMuZmluZChcclxuICAgICAgKGF0dHI6IGFueSkgPT4gYXR0ci5uYW1lID09PSBcImNvbW1vbk5hbWVcIlxyXG4gICAgKTtcclxuICAgIGlmIChjZXJ0SW5mbykge1xyXG4gICAgICBzaWduZXJOYW1lID1cclxuICAgICAgICB0eXBlb2YgY2VydEluZm8udmFsdWUgPT09IFwic3RyaW5nXCJcclxuICAgICAgICAgID8gY2VydEluZm8udmFsdWVcclxuICAgICAgICAgIDogQXJyYXkuaXNBcnJheShjZXJ0SW5mby52YWx1ZSlcclxuICAgICAgICAgID8gY2VydEluZm8udmFsdWUuam9pbihcIiwgXCIpXHJcbiAgICAgICAgICA6IFwiVW5rbm93blwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2lnbmVyTmFtZSA9IFwiVW5rbm93blwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQWRkIHNpZ25hdHVyZSBhbm5vdGF0aW9uICh2aXN1YWwgcmVwcmVzZW50YXRpb24pXHJcbiAgY29uc3QgcGFnZXMgPSBwZGZEb2MuZ2V0UGFnZXMoKTtcclxuICBjb25zdCBmaXJzdFBhZ2UgPSBwYWdlc1swXTtcclxuICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGZpcnN0UGFnZS5nZXRTaXplKCk7XHJcblxyXG4gIC8vIEFkZCB0ZXh0IGFubm90YXRpb246IG5hbWEsIGphYmF0YW4sIFBUXHJcbiAgbGV0IHlUZXh0ID0gODA7XHJcbiAgZmlyc3RQYWdlLmRyYXdUZXh0KGBEaWdpdGFsbHkgU2lnbmVkIGJ5OiAke3NpZ25lck5hbWV9YCwge1xyXG4gICAgeDogNTAsXHJcbiAgICB5OiB5VGV4dCxcclxuICAgIHNpemU6IDEwLFxyXG4gIH0pO1xyXG4gIHlUZXh0IC09IDEzO1xyXG4gIGNvbnN0IHBvc2l0aW9uVGV4dCA9IHNpZ25lckluZm8/LnBvc2l0aW9uID8gc2lnbmVySW5mby5wb3NpdGlvbiA6IFwiLVwiO1xyXG4gIGZpcnN0UGFnZS5kcmF3VGV4dChgUG9zaXRpb246ICR7cG9zaXRpb25UZXh0fWAsIHtcclxuICAgIHg6IDUwLFxyXG4gICAgeTogeVRleHQsXHJcbiAgICBzaXplOiAxMCxcclxuICB9KTtcclxuICB5VGV4dCAtPSAxMztcclxuICBjb25zdCBvcmdUZXh0ID0gc2lnbmVySW5mbz8ub3JnYW5pemF0aW9uTmFtZVxyXG4gICAgPyBzaWduZXJJbmZvLm9yZ2FuaXphdGlvbk5hbWVcclxuICAgIDogXCItXCI7XHJcbiAgZmlyc3RQYWdlLmRyYXdUZXh0KGBDb21wYW55OiAke29yZ1RleHR9YCwge1xyXG4gICAgeDogNTAsXHJcbiAgICB5OiB5VGV4dCxcclxuICAgIHNpemU6IDEwLFxyXG4gIH0pO1xyXG4gIHlUZXh0IC09IDEzO1xyXG4gIGZpcnN0UGFnZS5kcmF3VGV4dChgRGF0ZTogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKFwiaWQtSURcIil9YCwge1xyXG4gICAgeDogNTAsXHJcbiAgICB5OiB5VGV4dCxcclxuICAgIHNpemU6IDEwLFxyXG4gIH0pO1xyXG4gIHlUZXh0IC09IDM1OyAvLyBzcGFjZSBmb3IgYmFyY29kZSAodGluZ2dpIDMwICsgbWFyZ2luIDUpXHJcbiAgLy8gQWRkIGJhcmNvZGUgaWYgYXZhaWxhYmxlLCByaWdodCBiZWxvdyB0aGUgdGV4dFxyXG4gIGlmIChiYXJjb2RlUG5nKSB7XHJcbiAgICBhd2FpdCBlbWJlZEJhcmNvZGVUb1BERihwZGZEb2MsIGJhcmNvZGVQbmcsIDUwLCB5VGV4dCwgMjAwLCAzMCk7XHJcbiAgfVxyXG5cclxuICAvLyBTdG9yZSBzaWduYXR1cmUgaW4gUERGIG1ldGFkYXRhXHJcbiAgcGRmRG9jLnNldFRpdGxlKFwiU2lnbmVkIERvY3VtZW50XCIpO1xyXG4gIHBkZkRvYy5zZXRTdWJqZWN0KFwiVGhpcyBkb2N1bWVudCBoYXMgYmVlbiBkaWdpdGFsbHkgc2lnbmVkXCIpO1xyXG4gIHBkZkRvYy5zZXRLZXl3b3JkcyhbXHJcbiAgICBcInNpZ25lZFwiLFxyXG4gICAgXCJkaWdpdGFsLXNpZ25hdHVyZVwiLFxyXG4gICAgdHlwZW9mIHNpZ25lck5hbWUgPT09IFwic3RyaW5nXCIgPyBzaWduZXJOYW1lIDogXCJVbmtub3duXCIsXHJcbiAgXSk7XHJcbiAgcGRmRG9jLnNldENyZWF0b3IoXCJQREYgU2lnbmF0dXJlIFN5c3RlbVwiKTtcclxuXHJcbiAgLy8gTm90ZTogRm9yIHByb2R1Y3Rpb24sIHlvdSB3b3VsZCBuZWVkIHRvIGltcGxlbWVudCBwcm9wZXIgUERGIHNpZ25hdHVyZSBkaWN0aW9uYXJ5XHJcbiAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiB0aGF0IGVtYmVkcyBzaWduYXR1cmUgaW5mb3JtYXRpb25cclxuXHJcbiAgcmV0dXJuIHBkZkRvYztcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBQREYgc2lnbmF0dXJlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UERGU2lnbmF0dXJlKFxyXG4gIHBkZkJ1ZmZlcjogQnVmZmVyXHJcbik6IFByb21pc2U8U2lnbmF0dXJlSW5mbyB8IG51bGw+IHtcclxuICB0cnkge1xyXG4gICAgLy8gTG9hZCBQREZcclxuICAgIGNvbnN0IHBkZkRvYyA9IGF3YWl0IFBERkRvY3VtZW50LmxvYWQocGRmQnVmZmVyKTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBQREYgaGFzIHNpZ25hdHVyZSBpbmRpY2F0b3JzIGluIG1ldGFkYXRhXHJcbiAgICBjb25zdCB0aXRsZSA9IHBkZkRvYy5nZXRUaXRsZSgpO1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IHBkZkRvYy5nZXRTdWJqZWN0KCk7XHJcbiAgICBjb25zdCBrZXl3b3Jkc1JhdyA9IHBkZkRvYy5nZXRLZXl3b3JkcygpO1xyXG4gICAgbGV0IGtleXdvcmRzQXJyOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5d29yZHNSYXcpKSB7XHJcbiAgICAgIGtleXdvcmRzQXJyID0ga2V5d29yZHNSYXcuZmlsdGVyKFxyXG4gICAgICAgIChrKTogayBpcyBzdHJpbmcgPT4gdHlwZW9mIGsgPT09IFwic3RyaW5nXCJcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGtleXdvcmRzUmF3ID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGtleXdvcmRzQXJyID0gW2tleXdvcmRzUmF3XTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGlzIGlzIGEgc2ltcGxpZmllZCB2ZXJpZmljYXRpb25cclxuICAgIC8vIEluIHByb2R1Y3Rpb24sIHlvdSB3b3VsZCBleHRyYWN0IGFuZCB2ZXJpZnkgdGhlIGFjdHVhbCBQS0NTIzcgc2lnbmF0dXJlXHJcbiAgICBpZiAoIXRpdGxlIHx8ICFzdWJqZWN0IHx8IGtleXdvcmRzQXJyLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoXHJcbiAgICAgICFrZXl3b3Jkc0Fyci5pbmNsdWRlcyhcInNpZ25lZFwiKSB8fFxyXG4gICAgICAha2V5d29yZHNBcnIuaW5jbHVkZXMoXCJkaWdpdGFsLXNpZ25hdHVyZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4dHJhY3Qgc2lnbmVyIGluZm9ybWF0aW9uIGZyb20ga2V5d29yZHNcclxuICAgIGNvbnN0IHNpZ25lck5hbWUgPVxyXG4gICAgICBrZXl3b3Jkc0Fyci5maW5kKFxyXG4gICAgICAgIChrOiBzdHJpbmcpID0+ICFbXCJzaWduZWRcIiwgXCJkaWdpdGFsLXNpZ25hdHVyZVwiXS5pbmNsdWRlcyhrKVxyXG4gICAgICApIHx8IFwiVW5rbm93blwiO1xyXG5cclxuICAgIC8vIEZvciB0aGlzIGRlbW8sIHdlIGNvbnNpZGVyIHRoZSBzaWduYXR1cmUgdmFsaWQgaWYgbWV0YWRhdGEgaW5kaWNhdGVzIHNpZ25pbmdcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHZhbGlkOiB0cnVlLFxyXG4gICAgICBzaWduZWRCeTpcclxuICAgICAgICB0eXBlb2Ygc2lnbmVyTmFtZSA9PT0gXCJzdHJpbmdcIlxyXG4gICAgICAgICAgPyBzaWduZXJOYW1lXHJcbiAgICAgICAgICA6IEFycmF5LmlzQXJyYXkoc2lnbmVyTmFtZSlcclxuICAgICAgICAgID8gKHNpZ25lck5hbWUgYXMgc3RyaW5nW10pLmpvaW4oXCIsIFwiKVxyXG4gICAgICAgICAgOiBcIlVua25vd25cIixcclxuICAgICAgc2lnbmVkQXQ6IG5ldyBEYXRlKCksIC8vIEluIHByb2R1Y3Rpb24sIGV4dHJhY3QgZnJvbSBzaWduYXR1cmVcclxuICAgICAgY2VydGlmaWNhdGU6IFwiQ2VydGlmaWNhdGUgZW1iZWRkZWQgaW4gc2lnbmF0dXJlXCIsXHJcbiAgICAgIGlzc3VlcjogXCJTZWxmLVNpZ25lZFwiLFxyXG4gICAgICBzdWJqZWN0OiBzaWduZXJOYW1lLFxyXG4gICAgICB2YWxpZEZyb206IG5ldyBEYXRlKCksXHJcbiAgICAgIHZhbGlkVG86IG5ldyBEYXRlKERhdGUubm93KCkgKyAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcclxuICAgICAgYWxnb3JpdGhtOiBcIlJTQSB3aXRoIFNIQS0yNTZcIixcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJGYWlsZWQgdG8gdmVyaWZ5IFBERiBzaWduYXR1cmU6IFwiICsgKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3Qgc2lnbmF0dXJlIGluZm9ybWF0aW9uIGZyb20gc2lnbmVkIFBERiAoYWR2YW5jZWQpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXh0cmFjdFNpZ25hdHVyZUluZm8oXHJcbiAgc2lnbmVkUGRmQnVmZmVyOiBCdWZmZXIsXHJcbiAgY2VydGlmaWNhdGVQZW06IHN0cmluZ1xyXG4pOiBQcm9taXNlPFNpZ25hdHVyZUluZm8+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcGRmRG9jID0gYXdhaXQgUERGRG9jdW1lbnQubG9hZChzaWduZWRQZGZCdWZmZXIpO1xyXG4gICAgY29uc3QgY2VydGlmaWNhdGUgPSBmb3JnZS5wa2kuY2VydGlmaWNhdGVGcm9tUGVtKGNlcnRpZmljYXRlUGVtKTtcclxuXHJcbiAgICBjb25zdCBjZXJ0SW5mbyA9IGNlcnRpZmljYXRlLnN1YmplY3QuYXR0cmlidXRlcy5maW5kKFxyXG4gICAgICAoYXR0cjogYW55KSA9PiBhdHRyLm5hbWUgPT09IFwiY29tbW9uTmFtZVwiXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc2lnbmVyTmFtZSA9IGNlcnRJbmZvID8gY2VydEluZm8udmFsdWUgOiBcIlVua25vd25cIjtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB2YWxpZDogdHJ1ZSxcclxuICAgICAgc2lnbmVkQnk6XHJcbiAgICAgICAgdHlwZW9mIHNpZ25lck5hbWUgPT09IFwic3RyaW5nXCJcclxuICAgICAgICAgID8gc2lnbmVyTmFtZVxyXG4gICAgICAgICAgOiBBcnJheS5pc0FycmF5KHNpZ25lck5hbWUpXHJcbiAgICAgICAgICA/IChzaWduZXJOYW1lIGFzIHN0cmluZ1tdKS5qb2luKFwiLCBcIilcclxuICAgICAgICAgIDogXCJVbmtub3duXCIsXHJcbiAgICAgIHNpZ25lZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICBjZXJ0aWZpY2F0ZTogY2VydGlmaWNhdGVQZW0sXHJcbiAgICAgIGlzc3VlcjogY2VydGlmaWNhdGUuaXNzdWVyLmF0dHJpYnV0ZXNcclxuICAgICAgICAubWFwKChhOiBhbnkpID0+IGAke2Euc2hvcnROYW1lIHx8IGEubmFtZX09JHthLnZhbHVlfWApXHJcbiAgICAgICAgLmpvaW4oXCIsIFwiKSxcclxuICAgICAgc3ViamVjdDogY2VydGlmaWNhdGUuc3ViamVjdC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgLm1hcCgoYTogYW55KSA9PiBgJHthLnNob3J0TmFtZSB8fCBhLm5hbWV9PSR7YS52YWx1ZX1gKVxyXG4gICAgICAgIC5qb2luKFwiLCBcIiksXHJcbiAgICAgIHZhbGlkRnJvbTogY2VydGlmaWNhdGUudmFsaWRpdHkubm90QmVmb3JlLFxyXG4gICAgICB2YWxpZFRvOiBjZXJ0aWZpY2F0ZS52YWxpZGl0eS5ub3RBZnRlcixcclxuICAgICAgYWxnb3JpdGhtOiBcIlJTQSB3aXRoIFNIQS0yNTZcIixcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJGYWlsZWQgdG8gZXh0cmFjdCBzaWduYXR1cmUgaW5mbzogXCIgKyAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgUERGIGhhcyBiZWVuIHNpZ25lZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzUERGU2lnbmVkKHBkZkJ1ZmZlcjogQnVmZmVyKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZlcmlmeVBERlNpZ25hdHVyZShwZGZCdWZmZXIpO1xyXG4gICAgcmV0dXJuIHJlc3VsdCAhPT0gbnVsbCAmJiByZXN1bHQudmFsaWQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImZvcmdlIiwiUERGRG9jdW1lbnQiLCJnZW5lcmF0ZUJhcmNvZGVQTkciLCJlbWJlZEJhcmNvZGVUb1BERiIsInNpZ25QREYiLCJwZGZCdWZmZXIiLCJwcml2YXRlS2V5UGVtIiwiY2VydGlmaWNhdGVQZW0iLCJzaWduZXJJbmZvIiwicGRmRG9jIiwibG9hZCIsInBkZkJ5dGVzIiwic2F2ZSIsInByaXZhdGVLZXkiLCJwa2kiLCJwcml2YXRlS2V5RnJvbVBlbSIsImNlcnRpZmljYXRlIiwiY2VydGlmaWNhdGVGcm9tUGVtIiwicGRmQmluYXJ5U3RyaW5nIiwidXRpbCIsImJpbmFyeSIsInJhdyIsImVuY29kZSIsIm1kIiwic2hhMjU2IiwiY3JlYXRlIiwidXBkYXRlIiwic2lnbmF0dXJlIiwic2lnbiIsInA3IiwicGtjczciLCJjcmVhdGVTaWduZWREYXRhIiwiY29udGVudCIsImNyZWF0ZUJ1ZmZlciIsImFkZENlcnRpZmljYXRlIiwiYWRkU2lnbmVyIiwia2V5IiwiZGlnZXN0QWxnb3JpdGhtIiwib2lkcyIsImF1dGhlbnRpY2F0ZWRBdHRyaWJ1dGVzIiwidHlwZSIsImNvbnRlbnRUeXBlIiwidmFsdWUiLCJkYXRhIiwibWVzc2FnZURpZ2VzdCIsInNpZ25pbmdUaW1lIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZGV0YWNoZWQiLCJkZXJTaWduYXR1cmUiLCJhc24xIiwidG9EZXIiLCJ0b0FzbjEiLCJnZXRCeXRlcyIsImJhcmNvZGVEYXRhIiwibmFtZSIsInBvc2l0aW9uIiwib3JnYW5pemF0aW9uTmFtZSIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsImpvaW4iLCJiYXJjb2RlUG5nIiwic2lnbmVkUGRmRG9jIiwiZW1iZWRTaWduYXR1cmVJblBERiIsInNpZ25lZFBkZkJ5dGVzIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJzaWduZXJOYW1lIiwiY2VydEluZm8iLCJzdWJqZWN0IiwiYXR0cmlidXRlcyIsImZpbmQiLCJhdHRyIiwiQXJyYXkiLCJpc0FycmF5IiwicGFnZXMiLCJnZXRQYWdlcyIsImZpcnN0UGFnZSIsIndpZHRoIiwiaGVpZ2h0IiwiZ2V0U2l6ZSIsInlUZXh0IiwiZHJhd1RleHQiLCJ4IiwieSIsInNpemUiLCJwb3NpdGlvblRleHQiLCJvcmdUZXh0IiwidG9Mb2NhbGVTdHJpbmciLCJzZXRUaXRsZSIsInNldFN1YmplY3QiLCJzZXRLZXl3b3JkcyIsInNldENyZWF0b3IiLCJ2ZXJpZnlQREZTaWduYXR1cmUiLCJ0aXRsZSIsImdldFRpdGxlIiwiZ2V0U3ViamVjdCIsImtleXdvcmRzUmF3IiwiZ2V0S2V5d29yZHMiLCJrZXl3b3Jkc0FyciIsImZpbHRlciIsImsiLCJsZW5ndGgiLCJpbmNsdWRlcyIsInZhbGlkIiwic2lnbmVkQnkiLCJzaWduZWRBdCIsImlzc3VlciIsInZhbGlkRnJvbSIsInZhbGlkVG8iLCJub3ciLCJhbGdvcml0aG0iLCJleHRyYWN0U2lnbmF0dXJlSW5mbyIsInNpZ25lZFBkZkJ1ZmZlciIsIm1hcCIsImEiLCJzaG9ydE5hbWUiLCJ2YWxpZGl0eSIsIm5vdEJlZm9yZSIsIm5vdEFmdGVyIiwiaXNQREZTaWduZWQiLCJyZXN1bHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/pdf-signer.ts\n");

/***/ }),

/***/ "(rsc)/./lib/pdf-signpdf.ts":
/*!****************************!*\
  !*** ./lib/pdf-signpdf.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   lockPdfEditing: () => (/* binding */ lockPdfEditing),\n/* harmony export */   signPdfWithNodeSignpdf: () => (/* binding */ signPdfWithNodeSignpdf)\n/* harmony export */ });\n/* harmony import */ var pdf_lib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pdf-lib */ \"(rsc)/./node_modules/pdf-lib/es/index.js\");\n\n// Use dynamic require for node-signpdf helpers to avoid type definition mismatches\nconst nodeSignpdf = __webpack_require__(/*! node-signpdf */ \"(rsc)/./node_modules/node-signpdf/dist/signpdf.js\");\nconst { plainAddPlaceholder } = __webpack_require__(/*! node-signpdf/dist/helpers */ \"(rsc)/./node_modules/node-signpdf/dist/helpers/index.js\");\nconst sign = nodeSignpdf.sign;\n/**\r\n * Normalize a PDF by re-saving pages with pdf-lib to avoid xref-streams / object streams\r\n * which `node-signpdf`'s placeholder helper may not support.\r\n */ async function normalizePdfBuffer(pdfBuffer) {\n    try {\n        // First try qpdf (faster and preserves content) to disable object streams\n        try {\n            const { execSync } = __webpack_require__(/*! child_process */ \"child_process\");\n            const os = __webpack_require__(/*! os */ \"os\");\n            const { writeFileSync, readFileSync, unlinkSync } = __webpack_require__(/*! fs */ \"fs\");\n            const { join } = __webpack_require__(/*! path */ \"path\");\n            const inPath = join(os.tmpdir(), `in_pdf_${Date.now()}.pdf`);\n            const outPath = join(os.tmpdir(), `out_pdf_${Date.now()}.pdf`);\n            writeFileSync(inPath, pdfBuffer);\n            // --object-streams=disable creates classic xref table\n            execSync(`qpdf --object-streams=disable \"${inPath}\" \"${outPath}\"`, {\n                stdio: \"ignore\"\n            });\n            const out = readFileSync(outPath);\n            try {\n                unlinkSync(inPath);\n                unlinkSync(outPath);\n            } catch (e) {}\n            return out;\n        } catch (e) {\n            // qpdf not available or failed, fall back to pdf-lib re-save\n            const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.load(pdfBuffer);\n            const newDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.create();\n            const pages = await newDoc.copyPages(pdfDoc, pdfDoc.getPageIndices());\n            pages.forEach((p)=>newDoc.addPage(p));\n            return Buffer.from(await newDoc.save());\n        }\n    } catch (e) {\n        // If normalization fails, return original buffer\n        return pdfBuffer;\n    }\n}\n/**\r\n * Sign a PDF using node-signpdf so the signature is valid in Adobe Reader and locked from editing.\r\n * @param pdfBuffer Buffer of the unsigned PDF\r\n * @param p12Buffer Buffer of the PKCS#12 (PFX) file containing private key and certificate\r\n * @param passphrase Passphrase for the P12 file\r\n * @returns Buffer of the signed PDF\r\n */ async function signPdfWithNodeSignpdf(pdfBuffer, p12Buffer, passphrase) {\n    // Try inserting placeholder directly; if it fails (e.g., xref stream PDFs),\n    // normalize PDF first and retry.\n    let pdfWithPlaceholder;\n    try {\n        pdfWithPlaceholder = plainAddPlaceholder({\n            pdfBuffer,\n            reason: \"Document signed digitally\",\n            signatureLength: 8192\n        });\n    } catch (err) {\n        // Normalize PDF (rebuild without object streams) and try again\n        const normalized = await normalizePdfBuffer(pdfBuffer);\n        pdfWithPlaceholder = plainAddPlaceholder({\n            pdfBuffer: normalized,\n            reason: \"Document signed digitally\",\n            signatureLength: 8192\n        });\n    }\n    // Sign the PDF\n    const signedPdf = sign(pdfWithPlaceholder, p12Buffer, {\n        passphrase\n    });\n    return signedPdf;\n}\n/**\r\n * (Optional) Set PDF permissions to prevent editing (using pdf-lib)\r\n * @param pdfBuffer Buffer of the signed PDF\r\n * @returns Buffer of the locked PDF\r\n */ async function lockPdfEditing(pdfBuffer) {\n    const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.load(pdfBuffer);\n    // pdf-lib does not support setting permissions directly, but you can set metadata\n    pdfDoc.setModificationDate(new Date());\n    pdfDoc.setProducer(\"PDF Signature System\");\n    pdfDoc.setCreator(\"PDF Signature System\");\n    // Save and return\n    return Buffer.from(await pdfDoc.save());\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZixPQUFPQyxJQUFJLENBQUMsTUFBTVgsT0FBT1ksSUFBSTtBQUN0QyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbGliL3BkZi1zaWducGRmLnRzP2Y2YzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUERGRG9jdW1lbnQgfSBmcm9tIFwicGRmLWxpYlwiO1xyXG4vLyBVc2UgZHluYW1pYyByZXF1aXJlIGZvciBub2RlLXNpZ25wZGYgaGVscGVycyB0byBhdm9pZCB0eXBlIGRlZmluaXRpb24gbWlzbWF0Y2hlc1xyXG5jb25zdCBub2RlU2lnbnBkZiA9IHJlcXVpcmUoXCJub2RlLXNpZ25wZGZcIik7XHJcbmNvbnN0IHsgcGxhaW5BZGRQbGFjZWhvbGRlciB9ID0gcmVxdWlyZShcIm5vZGUtc2lnbnBkZi9kaXN0L2hlbHBlcnNcIik7XHJcbmNvbnN0IHNpZ24gPSBub2RlU2lnbnBkZi5zaWduO1xyXG5cclxuLyoqXHJcbiAqIE5vcm1hbGl6ZSBhIFBERiBieSByZS1zYXZpbmcgcGFnZXMgd2l0aCBwZGYtbGliIHRvIGF2b2lkIHhyZWYtc3RyZWFtcyAvIG9iamVjdCBzdHJlYW1zXHJcbiAqIHdoaWNoIGBub2RlLXNpZ25wZGZgJ3MgcGxhY2Vob2xkZXIgaGVscGVyIG1heSBub3Qgc3VwcG9ydC5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIG5vcm1hbGl6ZVBkZkJ1ZmZlcihwZGZCdWZmZXI6IEJ1ZmZlcik6IFByb21pc2U8QnVmZmVyPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEZpcnN0IHRyeSBxcGRmIChmYXN0ZXIgYW5kIHByZXNlcnZlcyBjb250ZW50KSB0byBkaXNhYmxlIG9iamVjdCBzdHJlYW1zXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IGV4ZWNTeW5jIH0gPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTtcclxuICAgICAgY29uc3Qgb3MgPSByZXF1aXJlKFwib3NcIik7XHJcbiAgICAgIGNvbnN0IHsgd3JpdGVGaWxlU3luYywgcmVhZEZpbGVTeW5jLCB1bmxpbmtTeW5jIH0gPSByZXF1aXJlKFwiZnNcIik7XHJcbiAgICAgIGNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZShcInBhdGhcIik7XHJcbiAgICAgIGNvbnN0IGluUGF0aCA9IGpvaW4ob3MudG1wZGlyKCksIGBpbl9wZGZfJHtEYXRlLm5vdygpfS5wZGZgKTtcclxuICAgICAgY29uc3Qgb3V0UGF0aCA9IGpvaW4ob3MudG1wZGlyKCksIGBvdXRfcGRmXyR7RGF0ZS5ub3coKX0ucGRmYCk7XHJcbiAgICAgIHdyaXRlRmlsZVN5bmMoaW5QYXRoLCBwZGZCdWZmZXIpO1xyXG4gICAgICAvLyAtLW9iamVjdC1zdHJlYW1zPWRpc2FibGUgY3JlYXRlcyBjbGFzc2ljIHhyZWYgdGFibGVcclxuICAgICAgZXhlY1N5bmMoYHFwZGYgLS1vYmplY3Qtc3RyZWFtcz1kaXNhYmxlIFwiJHtpblBhdGh9XCIgXCIke291dFBhdGh9XCJgLCB7IHN0ZGlvOiBcImlnbm9yZVwiIH0pO1xyXG4gICAgICBjb25zdCBvdXQgPSByZWFkRmlsZVN5bmMob3V0UGF0aCk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgdW5saW5rU3luYyhpblBhdGgpO1xyXG4gICAgICAgIHVubGlua1N5bmMob3V0UGF0aCk7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHt9XHJcbiAgICAgIHJldHVybiBvdXQ7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIC8vIHFwZGYgbm90IGF2YWlsYWJsZSBvciBmYWlsZWQsIGZhbGwgYmFjayB0byBwZGYtbGliIHJlLXNhdmVcclxuICAgICAgY29uc3QgcGRmRG9jID0gYXdhaXQgUERGRG9jdW1lbnQubG9hZChwZGZCdWZmZXIpO1xyXG4gICAgICBjb25zdCBuZXdEb2MgPSBhd2FpdCBQREZEb2N1bWVudC5jcmVhdGUoKTtcclxuICAgICAgY29uc3QgcGFnZXMgPSBhd2FpdCBuZXdEb2MuY29weVBhZ2VzKHBkZkRvYywgcGRmRG9jLmdldFBhZ2VJbmRpY2VzKCkpO1xyXG4gICAgICBwYWdlcy5mb3JFYWNoKChwKSA9PiBuZXdEb2MuYWRkUGFnZShwKSk7XHJcbiAgICAgIHJldHVybiBCdWZmZXIuZnJvbShhd2FpdCBuZXdEb2Muc2F2ZSgpKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICAvLyBJZiBub3JtYWxpemF0aW9uIGZhaWxzLCByZXR1cm4gb3JpZ2luYWwgYnVmZmVyXHJcbiAgICByZXR1cm4gcGRmQnVmZmVyO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFNpZ24gYSBQREYgdXNpbmcgbm9kZS1zaWducGRmIHNvIHRoZSBzaWduYXR1cmUgaXMgdmFsaWQgaW4gQWRvYmUgUmVhZGVyIGFuZCBsb2NrZWQgZnJvbSBlZGl0aW5nLlxyXG4gKiBAcGFyYW0gcGRmQnVmZmVyIEJ1ZmZlciBvZiB0aGUgdW5zaWduZWQgUERGXHJcbiAqIEBwYXJhbSBwMTJCdWZmZXIgQnVmZmVyIG9mIHRoZSBQS0NTIzEyIChQRlgpIGZpbGUgY29udGFpbmluZyBwcml2YXRlIGtleSBhbmQgY2VydGlmaWNhdGVcclxuICogQHBhcmFtIHBhc3NwaHJhc2UgUGFzc3BocmFzZSBmb3IgdGhlIFAxMiBmaWxlXHJcbiAqIEByZXR1cm5zIEJ1ZmZlciBvZiB0aGUgc2lnbmVkIFBERlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25QZGZXaXRoTm9kZVNpZ25wZGYoXHJcbiAgcGRmQnVmZmVyOiBCdWZmZXIsXHJcbiAgcDEyQnVmZmVyOiBCdWZmZXIsXHJcbiAgcGFzc3BocmFzZTogc3RyaW5nXHJcbik6IFByb21pc2U8QnVmZmVyPiB7XHJcbiAgLy8gVHJ5IGluc2VydGluZyBwbGFjZWhvbGRlciBkaXJlY3RseTsgaWYgaXQgZmFpbHMgKGUuZy4sIHhyZWYgc3RyZWFtIFBERnMpLFxyXG4gIC8vIG5vcm1hbGl6ZSBQREYgZmlyc3QgYW5kIHJldHJ5LlxyXG4gIGxldCBwZGZXaXRoUGxhY2Vob2xkZXI6IEJ1ZmZlcjtcclxuICB0cnkge1xyXG4gICAgcGRmV2l0aFBsYWNlaG9sZGVyID0gcGxhaW5BZGRQbGFjZWhvbGRlcih7XHJcbiAgICAgIHBkZkJ1ZmZlcixcclxuICAgICAgcmVhc29uOiBcIkRvY3VtZW50IHNpZ25lZCBkaWdpdGFsbHlcIixcclxuICAgICAgc2lnbmF0dXJlTGVuZ3RoOiA4MTkyLFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAvLyBOb3JtYWxpemUgUERGIChyZWJ1aWxkIHdpdGhvdXQgb2JqZWN0IHN0cmVhbXMpIGFuZCB0cnkgYWdhaW5cclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBhd2FpdCBub3JtYWxpemVQZGZCdWZmZXIocGRmQnVmZmVyKTtcclxuICAgIHBkZldpdGhQbGFjZWhvbGRlciA9IHBsYWluQWRkUGxhY2Vob2xkZXIoe1xyXG4gICAgICBwZGZCdWZmZXI6IG5vcm1hbGl6ZWQsXHJcbiAgICAgIHJlYXNvbjogXCJEb2N1bWVudCBzaWduZWQgZGlnaXRhbGx5XCIsXHJcbiAgICAgIHNpZ25hdHVyZUxlbmd0aDogODE5MixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gU2lnbiB0aGUgUERGXHJcbiAgY29uc3Qgc2lnbmVkUGRmID0gc2lnbihwZGZXaXRoUGxhY2Vob2xkZXIsIHAxMkJ1ZmZlciwgeyBwYXNzcGhyYXNlIH0pO1xyXG4gIHJldHVybiBzaWduZWRQZGY7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiAoT3B0aW9uYWwpIFNldCBQREYgcGVybWlzc2lvbnMgdG8gcHJldmVudCBlZGl0aW5nICh1c2luZyBwZGYtbGliKVxyXG4gKiBAcGFyYW0gcGRmQnVmZmVyIEJ1ZmZlciBvZiB0aGUgc2lnbmVkIFBERlxyXG4gKiBAcmV0dXJucyBCdWZmZXIgb2YgdGhlIGxvY2tlZCBQREZcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2NrUGRmRWRpdGluZyhwZGZCdWZmZXI6IEJ1ZmZlcik6IFByb21pc2U8QnVmZmVyPiB7XHJcbiAgY29uc3QgcGRmRG9jID0gYXdhaXQgUERGRG9jdW1lbnQubG9hZChwZGZCdWZmZXIpO1xyXG4gIC8vIHBkZi1saWIgZG9lcyBub3Qgc3VwcG9ydCBzZXR0aW5nIHBlcm1pc3Npb25zIGRpcmVjdGx5LCBidXQgeW91IGNhbiBzZXQgbWV0YWRhdGFcclxuICBwZGZEb2Muc2V0TW9kaWZpY2F0aW9uRGF0ZShuZXcgRGF0ZSgpKTtcclxuICBwZGZEb2Muc2V0UHJvZHVjZXIoXCJQREYgU2lnbmF0dXJlIFN5c3RlbVwiKTtcclxuICBwZGZEb2Muc2V0Q3JlYXRvcihcIlBERiBTaWduYXR1cmUgU3lzdGVtXCIpO1xyXG4gIC8vIFNhdmUgYW5kIHJldHVyblxyXG4gIHJldHVybiBCdWZmZXIuZnJvbShhd2FpdCBwZGZEb2Muc2F2ZSgpKTtcclxufVxyXG4iXSwibmFtZXMiOlsiUERGRG9jdW1lbnQiLCJub2RlU2lnbnBkZiIsInJlcXVpcmUiLCJwbGFpbkFkZFBsYWNlaG9sZGVyIiwic2lnbiIsIm5vcm1hbGl6ZVBkZkJ1ZmZlciIsInBkZkJ1ZmZlciIsImV4ZWNTeW5jIiwib3MiLCJ3cml0ZUZpbGVTeW5jIiwicmVhZEZpbGVTeW5jIiwidW5saW5rU3luYyIsImpvaW4iLCJpblBhdGgiLCJ0bXBkaXIiLCJEYXRlIiwibm93Iiwib3V0UGF0aCIsInN0ZGlvIiwib3V0IiwiZSIsInBkZkRvYyIsImxvYWQiLCJuZXdEb2MiLCJjcmVhdGUiLCJwYWdlcyIsImNvcHlQYWdlcyIsImdldFBhZ2VJbmRpY2VzIiwiZm9yRWFjaCIsInAiLCJhZGRQYWdlIiwiQnVmZmVyIiwiZnJvbSIsInNhdmUiLCJzaWduUGRmV2l0aE5vZGVTaWducGRmIiwicDEyQnVmZmVyIiwicGFzc3BocmFzZSIsInBkZldpdGhQbGFjZWhvbGRlciIsInJlYXNvbiIsInNpZ25hdHVyZUxlbmd0aCIsImVyciIsIm5vcm1hbGl6ZWQiLCJzaWduZWRQZGYiLCJsb2NrUGRmRWRpdGluZyIsInNldE1vZGlmaWNhdGlvbkRhdGUiLCJzZXRQcm9kdWNlciIsInNldENyZWF0b3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/pdf-signpdf.ts\n");

/***/ }),

/***/ "(rsc)/./models/PDF.ts":
/*!***********************!*\
  !*** ./models/PDF.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst PDFSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    name: {\n        type: String,\n        required: true\n    },\n    userId: {\n        type: String,\n        required: true\n    },\n    content: {\n        type: Buffer,\n        required: true\n    },\n    signed: {\n        type: Boolean,\n        default: false\n    },\n    signedBy: {\n        type: String\n    },\n    signedAt: {\n        type: Date\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).PDF || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"PDF\", PDFSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvUERGLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFzRDtBQVl0RCxNQUFNRSxZQUFZLElBQUlELDRDQUFNQSxDQUFPO0lBQ2pDRSxNQUFNO1FBQUVDLE1BQU1DO1FBQVFDLFVBQVU7SUFBSztJQUNyQ0MsUUFBUTtRQUFFSCxNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDdkNFLFNBQVM7UUFBRUosTUFBTUs7UUFBUUgsVUFBVTtJQUFLO0lBQ3hDSSxRQUFRO1FBQUVOLE1BQU1PO1FBQVNDLFNBQVM7SUFBTTtJQUN4Q0MsVUFBVTtRQUFFVCxNQUFNQztJQUFPO0lBQ3pCUyxVQUFVO1FBQUVWLE1BQU1XO0lBQUs7SUFDdkJDLFdBQVc7UUFBRVosTUFBTVc7UUFBTUgsU0FBU0csS0FBS0UsR0FBRztJQUFDO0FBQzdDO0FBRUEsaUVBQWVqQix3REFBZSxDQUFDbUIsR0FBRyxJQUFJbkIscURBQWMsQ0FBTyxPQUFPRSxVQUFVQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRmLXNpZ25hdHVyZS1zeXN0ZW0vLi9tb2RlbHMvUERGLnRzPzUxNTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IFNjaGVtYSwgRG9jdW1lbnQgfSBmcm9tIFwibW9uZ29vc2VcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVBERiBleHRlbmRzIERvY3VtZW50IHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgY29udGVudDogQnVmZmVyO1xyXG4gIHNpZ25lZDogYm9vbGVhbjtcclxuICBzaWduZWRCeT86IHN0cmluZztcclxuICBzaWduZWRBdD86IERhdGU7XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG59XHJcblxyXG5jb25zdCBQREZTY2hlbWEgPSBuZXcgU2NoZW1hPElQREY+KHtcclxuICBuYW1lOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICB1c2VySWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIGNvbnRlbnQ6IHsgdHlwZTogQnVmZmVyLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHNpZ25lZDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxyXG4gIHNpZ25lZEJ5OiB7IHR5cGU6IFN0cmluZyB9LFxyXG4gIHNpZ25lZEF0OiB7IHR5cGU6IERhdGUgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbHMuUERGIHx8IG1vbmdvb3NlLm1vZGVsPElQREY+KFwiUERGXCIsIFBERlNjaGVtYSk7XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIlNjaGVtYSIsIlBERlNjaGVtYSIsIm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1c2VySWQiLCJjb250ZW50IiwiQnVmZmVyIiwic2lnbmVkIiwiQm9vbGVhbiIsImRlZmF1bHQiLCJzaWduZWRCeSIsInNpZ25lZEF0IiwiRGF0ZSIsImNyZWF0ZWRBdCIsIm5vdyIsIm1vZGVscyIsIlBERiIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/PDF.ts\n");

/***/ }),

/***/ "(rsc)/./models/User.ts":
/*!************************!*\
  !*** ./models/User.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst UserSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    email: {\n        type: String,\n        required: true,\n        unique: true\n    },\n    passwordHash: {\n        type: String,\n        required: true\n    },\n    name: {\n        type: String,\n        required: true\n    },\n    role: {\n        type: String,\n        enum: [\n            \"organization\",\n            \"consultant\"\n        ],\n        required: true\n    },\n    organizationName: {\n        type: String\n    },\n    position: {\n        type: String\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    },\n    hasKeys: {\n        type: Boolean,\n        default: false\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).User || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"User\", UserSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvVXNlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0Q7QUFhdEQsTUFBTUUsYUFBYSxJQUFJRCw0Q0FBTUEsQ0FBUTtJQUNuQ0UsT0FBTztRQUFFQyxNQUFNQztRQUFRQyxVQUFVO1FBQU1DLFFBQVE7SUFBSztJQUNwREMsY0FBYztRQUFFSixNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDN0NHLE1BQU07UUFBRUwsTUFBTUM7UUFBUUMsVUFBVTtJQUFLO0lBQ3JDSSxNQUFNO1FBQUVOLE1BQU1DO1FBQVFNLE1BQU07WUFBQztZQUFnQjtTQUFhO1FBQUVMLFVBQVU7SUFBSztJQUMzRU0sa0JBQWtCO1FBQUVSLE1BQU1DO0lBQU87SUFDakNRLFVBQVU7UUFBRVQsTUFBTUM7SUFBTztJQUN6QlMsV0FBVztRQUFFVixNQUFNVztRQUFNQyxTQUFTRCxLQUFLRSxHQUFHO0lBQUM7SUFDM0NDLFNBQVM7UUFBRWQsTUFBTWU7UUFBU0gsU0FBUztJQUFNO0FBQzNDO0FBRUEsaUVBQWVoQix3REFBZSxDQUFDcUIsSUFBSSxJQUNqQ3JCLHFEQUFjLENBQVEsUUFBUUUsV0FBV0EsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbW9kZWxzL1VzZXIudHM/NmRjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHsgU2NoZW1hLCBEb2N1bWVudCB9IGZyb20gXCJtb25nb29zZVwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJVXNlciBleHRlbmRzIERvY3VtZW50IHtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIHBhc3N3b3JkSGFzaDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICByb2xlOiBcIm9yZ2FuaXphdGlvblwiIHwgXCJjb25zdWx0YW50XCI7XHJcbiAgb3JnYW5pemF0aW9uTmFtZT86IHN0cmluZztcclxuICBwb3NpdGlvbj86IHN0cmluZzsgLy8gamFiYXRhblxyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxuICBoYXNLZXlzOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYTxJVXNlcj4oe1xyXG4gIGVtYWlsOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LFxyXG4gIHBhc3N3b3JkSGFzaDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgbmFtZTogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgcm9sZTogeyB0eXBlOiBTdHJpbmcsIGVudW06IFtcIm9yZ2FuaXphdGlvblwiLCBcImNvbnN1bHRhbnRcIl0sIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgb3JnYW5pemF0aW9uTmFtZTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICBwb3NpdGlvbjogeyB0eXBlOiBTdHJpbmcgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxuICBoYXNLZXlzOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sXHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlVzZXIgfHxcclxuICBtb25nb29zZS5tb2RlbDxJVXNlcj4oXCJVc2VyXCIsIFVzZXJTY2hlbWEpO1xyXG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJTY2hlbWEiLCJVc2VyU2NoZW1hIiwiZW1haWwiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJwYXNzd29yZEhhc2giLCJuYW1lIiwicm9sZSIsImVudW0iLCJvcmdhbml6YXRpb25OYW1lIiwicG9zaXRpb24iLCJjcmVhdGVkQXQiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsImhhc0tleXMiLCJCb29sZWFuIiwibW9kZWxzIiwiVXNlciIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./models/User.ts\n");

/***/ }),

/***/ "(rsc)/./models/UserKeys.ts":
/*!****************************!*\
  !*** ./models/UserKeys.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst UserKeysSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    userId: {\n        type: String,\n        required: true,\n        unique: true\n    },\n    publicKey: {\n        type: String,\n        required: true\n    },\n    privateKeyEncrypted: {\n        type: String,\n        required: true\n    },\n    certificate: {\n        type: String,\n        required: true\n    },\n    createdAt: {\n        type: Date,\n        default: Date.now\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models).UserKeys || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"UserKeys\", UserKeysSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9tb2RlbHMvVXNlcktleXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNEO0FBVXRELE1BQU1FLGlCQUFpQixJQUFJRCw0Q0FBTUEsQ0FBWTtJQUMzQ0UsUUFBUTtRQUFFQyxNQUFNQztRQUFRQyxVQUFVO1FBQU1DLFFBQVE7SUFBSztJQUNyREMsV0FBVztRQUFFSixNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDMUNHLHFCQUFxQjtRQUFFTCxNQUFNQztRQUFRQyxVQUFVO0lBQUs7SUFDcERJLGFBQWE7UUFBRU4sTUFBTUM7UUFBUUMsVUFBVTtJQUFLO0lBQzVDSyxXQUFXO1FBQUVQLE1BQU1RO1FBQU1DLFNBQVNELEtBQUtFLEdBQUc7SUFBQztBQUM3QztBQUVBLGlFQUFlZCx3REFBZSxDQUFDZ0IsUUFBUSxJQUNyQ2hCLHFEQUFjLENBQVksWUFBWUUsZUFBZUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi1zaWduYXR1cmUtc3lzdGVtLy4vbW9kZWxzL1VzZXJLZXlzLnRzPzUyOTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IFNjaGVtYSwgRG9jdW1lbnQgfSBmcm9tIFwibW9uZ29vc2VcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVVzZXJLZXlzIGV4dGVuZHMgRG9jdW1lbnQge1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIHB1YmxpY0tleTogc3RyaW5nO1xyXG4gIHByaXZhdGVLZXlFbmNyeXB0ZWQ6IHN0cmluZztcclxuICBjZXJ0aWZpY2F0ZTogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxufVxyXG5cclxuY29uc3QgVXNlcktleXNTY2hlbWEgPSBuZXcgU2NoZW1hPElVc2VyS2V5cz4oe1xyXG4gIHVzZXJJZDogeyB0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiB0cnVlLCB1bmlxdWU6IHRydWUgfSxcclxuICBwdWJsaWNLZXk6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIHByaXZhdGVLZXlFbmNyeXB0ZWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gIGNlcnRpZmljYXRlOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICBjcmVhdGVkQXQ6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSxcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBtb25nb29zZS5tb2RlbHMuVXNlcktleXMgfHxcclxuICBtb25nb29zZS5tb2RlbDxJVXNlcktleXM+KFwiVXNlcktleXNcIiwgVXNlcktleXNTY2hlbWEpO1xyXG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJTY2hlbWEiLCJVc2VyS2V5c1NjaGVtYSIsInVzZXJJZCIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsInB1YmxpY0tleSIsInByaXZhdGVLZXlFbmNyeXB0ZWQiLCJjZXJ0aWZpY2F0ZSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJkZWZhdWx0Iiwibm93IiwibW9kZWxzIiwiVXNlcktleXMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./models/UserKeys.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/zod","vendor-chunks/bcryptjs","vendor-chunks/pdf-lib","vendor-chunks/node-signpdf","vendor-chunks/@pdf-lib","vendor-chunks/pako","vendor-chunks/bwip-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fpdf%2Fsign%2Froute&page=%2Fapi%2Fpdf%2Fsign%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fpdf%2Fsign%2Froute.ts&appDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CCoolyeah%5Csemester5%5CKeamanan%20Informasi%5CTugas3&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();